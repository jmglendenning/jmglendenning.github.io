[
  {
    "objectID": "hmm_analysis.html",
    "href": "hmm_analysis.html",
    "title": "Hidden Markov Model for Roman Monetary Regimes",
    "section": "",
    "text": "This analysis adapts the spatio-temporal HMM framework from Pasanen et al. (2024) “Hidden Markov modelling of spatio-temporal dynamics of measles in 1750–1850 Finland” to Roman coin hoard data.\n\n\n\n\n\nPasanen et al. (Measles)\nThis Analysis (Coins)\n\n\n\n\nParish (N = 387)\nHex cell (N ~ 100)\n\n\nMonth (T = 1212)\nTPQ period (T = 4)\n\n\nBinary: death observed\nContinuous: Rome proportion\n\n\nStates: epidemic phases\nStates: monetary regimes\n\n\nICAR: spatial correlation\nICAR: spatial correlation\n\n\n\n\n\n\nFollowing Pasanen et al. equation (5), but adapted for continuous proportions:\n\\[y_{i,t} \\sim \\text{Beta}(\\alpha_{x_t}, \\beta_{x_t})\\]\nwhere the mean is:\n\\[\\text{logit}(\\mu_{x_t}) = \\mu_{x_t} + \\lambda_i + \\sigma_\\phi \\phi_{i,x_t}\\]\nComponents:\n\n\\(\\mu_{x_t}\\): State-specific baseline (ordered to avoid label switching)\n\\(\\lambda_i\\): Site-specific constant (non-spatial heterogeneity)\n\\(\\sigma_\\phi \\phi_{i,x_t}\\): State-specific ICAR spatial effects\n\\(x_t\\): Hidden state at time \\(t\\), following first-order Markov chain\n\n\n\n\nGiven computational constraints and limited temporal resolution (T=4 periods), we implement a simplified version first:\n\nAggregate HMM: Fit HMM at the aggregate level (all hexes combined) to identify temporal regimes\nSpatial variation by regime: Examine spatial patterns within each identified regime\nFull spatial HMM: If computational resources permit, fit the full ICAR-HMM"
  },
  {
    "objectID": "hmm_analysis.html#adapting-pasanen-et-al.-2024-to-numismatic-data",
    "href": "hmm_analysis.html#adapting-pasanen-et-al.-2024-to-numismatic-data",
    "title": "Hidden Markov Model for Roman Monetary Regimes",
    "section": "",
    "text": "This analysis adapts the spatio-temporal HMM framework from Pasanen et al. (2024) “Hidden Markov modelling of spatio-temporal dynamics of measles in 1750–1850 Finland” to Roman coin hoard data.\n\n\n\n\n\nPasanen et al. (Measles)\nThis Analysis (Coins)\n\n\n\n\nParish (N = 387)\nHex cell (N ~ 100)\n\n\nMonth (T = 1212)\nTPQ period (T = 4)\n\n\nBinary: death observed\nContinuous: Rome proportion\n\n\nStates: epidemic phases\nStates: monetary regimes\n\n\nICAR: spatial correlation\nICAR: spatial correlation\n\n\n\n\n\n\nFollowing Pasanen et al. equation (5), but adapted for continuous proportions:\n\\[y_{i,t} \\sim \\text{Beta}(\\alpha_{x_t}, \\beta_{x_t})\\]\nwhere the mean is:\n\\[\\text{logit}(\\mu_{x_t}) = \\mu_{x_t} + \\lambda_i + \\sigma_\\phi \\phi_{i,x_t}\\]\nComponents:\n\n\\(\\mu_{x_t}\\): State-specific baseline (ordered to avoid label switching)\n\\(\\lambda_i\\): Site-specific constant (non-spatial heterogeneity)\n\\(\\sigma_\\phi \\phi_{i,x_t}\\): State-specific ICAR spatial effects\n\\(x_t\\): Hidden state at time \\(t\\), following first-order Markov chain\n\n\n\n\nGiven computational constraints and limited temporal resolution (T=4 periods), we implement a simplified version first:\n\nAggregate HMM: Fit HMM at the aggregate level (all hexes combined) to identify temporal regimes\nSpatial variation by regime: Examine spatial patterns within each identified regime\nFull spatial HMM: If computational resources permit, fit the full ICAR-HMM"
  },
  {
    "objectID": "hmm_analysis.html#create-period-stratified-observations",
    "href": "hmm_analysis.html#create-period-stratified-observations",
    "title": "Hidden Markov Model for Roman Monetary Regimes",
    "section": "4.1 Create Period-Stratified Observations",
    "text": "4.1 Create Period-Stratified Observations\n\n\nCode\n# Flag Rome and parse TPQ\nchrr_prep &lt;- chrr_raw %&gt;%\n  mutate(\n    is_rome = mint_id == \"rome\" | str_detect(mint_uri, \"/id/rome$\"),\n    is_rome = replace_na(is_rome, FALSE),\n    tpq_year = readr::parse_number(as.character(hoard_tpq))\n  ) %&gt;%\n  filter(!is.na(tpq_year), !is.na(hoard_lat), !is.na(hoard_long))\n\n# Period bins\nperiod_breaks &lt;- c(-Inf, -150, -100, -50, 14, Inf)\nperiod_labels &lt;- c(\n  \"1: Early Republic\",\n  \"2: Late Republic I\",\n  \"3: Late Republic II\", \n  \"4: Triumviral/Augustan\",\n  \"5: Early Imperial\"\n)\n\nchrr_prep &lt;- chrr_prep %&gt;%\n  mutate(\n    tpq_period = cut(tpq_year, breaks = period_breaks, labels = period_labels, right = TRUE),\n    tpq_period_num = as.integer(tpq_period)\n  ) %&gt;%\n  filter(!is.na(tpq_period))\n\n# Aggregate to hoard level\nhoard_comp &lt;- chrr_prep %&gt;%\n  group_by(hoard_id, hoard_lat, hoard_long, tpq_year, tpq_period, tpq_period_num) %&gt;%\n  summarise(\n    n_types = n(),\n    n_rome = sum(is_rome),\n    p_rome = n_rome / n_types,\n    .groups = \"drop\"\n  )\n\ncat(\"Hoards with TPQ:\", nrow(hoard_comp), \"\\n\")\n\n\nHoards with TPQ: 463 \n\n\nCode\ncat(\"Periods present:\", paste(unique(hoard_comp$tpq_period), collapse = \", \"), \"\\n\")\n\n\nPeriods present: 4: Triumviral/Augustan, 3: Late Republic II, 2: Late Republic I, 1: Early Republic"
  },
  {
    "objectID": "hmm_analysis.html#aggregate-time-series-for-hmm",
    "href": "hmm_analysis.html#aggregate-time-series-for-hmm",
    "title": "Hidden Markov Model for Roman Monetary Regimes",
    "section": "4.2 Aggregate Time Series for HMM",
    "text": "4.2 Aggregate Time Series for HMM\n\n\nCode\n# Create aggregate time series (all hoards combined per period)\nperiod_agg &lt;- hoard_comp %&gt;%\n  group_by(tpq_period, tpq_period_num) %&gt;%\n  summarise(\n    n_hoards = n(),\n    total_types = sum(n_types),\n    rome_types = sum(n_rome),\n    p_rome = rome_types / total_types,\n    mean_p_rome = mean(p_rome),\n    sd_p_rome = sd(p_rome),\n    .groups = \"drop\"\n  ) %&gt;%\n  arrange(tpq_period_num)\n\nkable(period_agg, digits = 3, caption = \"Aggregate Rome proportion by period\")\n\n\n\nAggregate Rome proportion by period\n\n\n\n\n\n\n\n\n\n\n\n\ntpq_period\ntpq_period_num\nn_hoards\ntotal_types\nrome_types\np_rome\nmean_p_rome\nsd_p_rome\n\n\n\n\n1: Early Republic\n1\n11\n185\n106\n0.573\n0.573\nNA\n\n\n2: Late Republic I\n2\n87\n4346\n4105\n0.945\n0.945\nNA\n\n\n3: Late Republic II\n3\n166\n9826\n9279\n0.944\n0.944\nNA\n\n\n4: Triumviral/Augustan\n4\n199\n16075\n13310\n0.828\n0.828\nNA"
  },
  {
    "objectID": "hmm_analysis.html#fit-2-state-and-3-state-hmms",
    "href": "hmm_analysis.html#fit-2-state-and-3-state-hmms",
    "title": "Hidden Markov Model for Roman Monetary Regimes",
    "section": "5.1 Fit 2-State and 3-State HMMs",
    "text": "5.1 Fit 2-State and 3-State HMMs\nSince we have only 4 time points at the aggregate level, a traditional HMM is underpowered. Instead, we’ll use the hoard-level data where each hoard is an observation within a period, allowing the HMM to learn state-specific emission distributions.\n\n\nCode\n# For HMM, we need a \"sequence\" - treat periods as time, hoards as repeated observations\n# Reshape: each row is a hoard with its period and Rome proportion\n\nhmm_data &lt;- hoard_comp %&gt;%\n  dplyr::select(hoard_id, tpq_period_num, p_rome, n_types) %&gt;%\n  arrange(hoard_id, tpq_period_num) %&gt;%\n  # Weight by sample size for more reliable estimates\n  mutate(\n    # Transform proportion to avoid 0/1 boundary issues for beta\n    p_rome_adj = pmax(0.001, pmin(0.999, p_rome))\n  )\n\ncat(\"Observations for HMM:\", nrow(hmm_data), \"\\n\")\n\n\nObservations for HMM: 463"
  },
  {
    "objectID": "hmm_analysis.html#fit-gaussian-mixture-hmm-on-period-means",
    "href": "hmm_analysis.html#fit-gaussian-mixture-hmm-on-period-means",
    "title": "Hidden Markov Model for Roman Monetary Regimes",
    "section": "5.2 Fit Gaussian Mixture HMM on Period Means",
    "text": "5.2 Fit Gaussian Mixture HMM on Period Means\nGiven the structure of our data (4 periods, ~500 hoards), we’ll fit an HMM where:\n\nTime dimension: The 4 TPQ periods\nObservations: The distribution of Rome proportions across hoards within each period\nStates: Latent monetary regimes\n\n\n\nCode\n# Aggregate to period level with distributional summary\nperiod_stats &lt;- hoard_comp %&gt;%\n  group_by(tpq_period_num) %&gt;%\n  summarise(\n    n = n(),\n    mean_p = mean(p_rome),\n    sd_p = sd(p_rome),\n    median_p = median(p_rome),\n    q25 = quantile(p_rome, 0.25),\n    q75 = quantile(p_rome, 0.75),\n    .groups = \"drop\"\n  ) %&gt;%\n  arrange(tpq_period_num)\n\nkable(period_stats, digits = 3, caption = \"Rome proportion distribution by period\")\n\n\n\nRome proportion distribution by period\n\n\ntpq_period_num\nn\nmean_p\nsd_p\nmedian_p\nq25\nq75\n\n\n\n\n1\n11\n0.657\n0.205\n0.583\n0.528\n0.784\n\n\n2\n87\n0.954\n0.064\n0.966\n0.936\n1.000\n\n\n3\n166\n0.949\n0.071\n0.951\n0.930\n1.000\n\n\n4\n199\n0.804\n0.181\n0.859\n0.734\n0.923"
  },
  {
    "objectID": "hmm_analysis.html#visual-regime-detection",
    "href": "hmm_analysis.html#visual-regime-detection",
    "title": "Hidden Markov Model for Roman Monetary Regimes",
    "section": "5.3 Visual Regime Detection",
    "text": "5.3 Visual Regime Detection\nBefore formal HMM, let’s visualize the distributional shifts:\n\n\nCode\n# Density plots by period\np1 &lt;- ggplot(hoard_comp, aes(x = p_rome, fill = tpq_period)) +\n  geom_density(alpha = 0.5) +\n  scale_fill_viridis_d(option = \"plasma\") +\n  labs(\n    title = \"Rome Proportion Distribution by Period\",\n    x = \"Rome proportion\",\n    y = \"Density\",\n    fill = \"Period\"\n  ) +\n  theme(legend.position = \"bottom\")\n\n# Boxplot comparison\np2 &lt;- ggplot(hoard_comp, aes(x = tpq_period, y = p_rome, fill = tpq_period)) +\n  geom_boxplot(alpha = 0.7) +\n  geom_jitter(alpha = 0.2, width = 0.2, size = 0.5) +\n  scale_fill_viridis_d(option = \"plasma\") +\n  labs(\n    title = \"Rome Proportion by Period\",\n    x = NULL,\n    y = \"Rome proportion\"\n  ) +\n  theme(\n    axis.text.x = element_text(angle = 30, hjust = 1),\n    legend.position = \"none\"\n  )\n\np1 + p2"
  },
  {
    "objectID": "hmm_analysis.html#k-means-clustering-on-period-characteristics",
    "href": "hmm_analysis.html#k-means-clustering-on-period-characteristics",
    "title": "Hidden Markov Model for Roman Monetary Regimes",
    "section": "5.4 K-Means Clustering on Period Characteristics",
    "text": "5.4 K-Means Clustering on Period Characteristics\nAs a precursor to HMM, identify natural clusters in the period-level statistics:\n\n\nCode\n# Features for clustering\nperiod_features &lt;- period_stats %&gt;%\n  dplyr::select(tpq_period_num, mean_p, sd_p, median_p) %&gt;%\n  column_to_rownames(\"tpq_period_num\")\n\n# Try 2 and 3 clusters\nset.seed(42)\nkm2 &lt;- kmeans(scale(period_features), centers = 2, nstart = 25)\nkm3 &lt;- kmeans(scale(period_features), centers = 3, nstart = 25)\n\nperiod_stats &lt;- period_stats %&gt;%\n  mutate(\n    regime_2 = km2$cluster,\n    regime_3 = km3$cluster\n  )\n\nkable(period_stats %&gt;% dplyr::select(tpq_period_num, mean_p, sd_p, regime_2, regime_3),\n      digits = 3,\n      caption = \"Period clustering into regimes\")\n\n\n\nPeriod clustering into regimes\n\n\ntpq_period_num\nmean_p\nsd_p\nregime_2\nregime_3\n\n\n\n\n1\n0.657\n0.205\n1\n3\n\n\n2\n0.954\n0.064\n2\n1\n\n\n3\n0.949\n0.071\n2\n1\n\n\n4\n0.804\n0.181\n1\n2"
  },
  {
    "objectID": "hmm_analysis.html#fit-depmixs4-hmm",
    "href": "hmm_analysis.html#fit-depmixs4-hmm",
    "title": "Hidden Markov Model for Roman Monetary Regimes",
    "section": "5.5 Fit depmixS4 HMM",
    "text": "5.5 Fit depmixS4 HMM\n\n\nCode\n# Create a dataset suitable for depmixS4\n# Each \"sequence\" is one period; observations are the individual hoards\n# We need to structure this as panel data\n\n# Simpler approach: treat the aggregate period statistics as a time series\n# and fit HMM on the mean/variance\n\n# For a proper HMM with 4 time points, we need to think carefully\n# Let's use the hoard-level data with period as the time index\n\n# Create individual \"trajectories\" - but we only have 1 observation per hoard\n# This won't work for traditional HMM\n\n# Alternative: Fit mixture model to detect regimes in the pooled data\nlibrary(mclust)\n\n# Fit Gaussian mixture on Rome proportions\ngmm_fit &lt;- Mclust(hoard_comp$p_rome, G = 2:4)\n\ncat(\"Optimal number of components:\", gmm_fit$G, \"\\n\")\n\n\nOptimal number of components: 2 \n\n\nCode\ncat(\"BIC values:\\n\")\n\n\nBIC values:\n\n\nCode\nprint(gmm_fit$BIC)\n\n\nBayesian Information Criterion (BIC): \n         E        V\n2 614.8660 840.0573\n3 602.5896       NA\n4 590.3134       NA\n\nTop 3 models based on the BIC criterion: \n     V,2      E,2      E,3 \n840.0573 614.8660 602.5896 \n\n\n\n\nCode\n# Add cluster assignments\nhoard_comp$gmm_cluster &lt;- gmm_fit$classification\n\n# Summarize by period and cluster\nperiod_cluster &lt;- hoard_comp %&gt;%\n  group_by(tpq_period, tpq_period_num, gmm_cluster) %&gt;%\n  summarise(n = n(), .groups = \"drop\") %&gt;%\n  group_by(tpq_period_num) %&gt;%\n  mutate(prop = n / sum(n)) %&gt;%\n  ungroup()\n\n# Visualize cluster composition by period\nggplot(period_cluster, aes(x = factor(tpq_period_num), y = prop, fill = factor(gmm_cluster))) +\n  geom_col(position = \"stack\") +\n  scale_fill_viridis_d(name = \"Cluster\", option = \"plasma\") +\n  scale_x_discrete(labels = c(\"Early\\nRepublic\", \"Late Rep I\", \"Late Rep II\", \"Triumviral/\\nAugustan\")) +\n  labs(\n    title = \"Hoard Cluster Composition by Period\",\n    subtitle = paste(\"Gaussian Mixture Model with\", gmm_fit$G, \"components\"),\n    x = \"Period\",\n    y = \"Proportion of hoards\"\n  )"
  },
  {
    "objectID": "hmm_analysis.html#define-states-based-on-prior-analysis",
    "href": "hmm_analysis.html#define-states-based-on-prior-analysis",
    "title": "Hidden Markov Model for Roman Monetary Regimes",
    "section": "6.1 Define States Based on Prior Analysis",
    "text": "6.1 Define States Based on Prior Analysis\n\n\nCode\n# Based on TPQ and mint-date analysis:\n# State 1: Pre-transition (periods 1-2): High Rome %, no distance decay\n# State 2: Transition (period 3): Intermediate\n# State 3: Post-transition (period 4): Lower Rome %, distance decay emerges\n\nhoard_comp &lt;- hoard_comp %&gt;%\n  mutate(\n    regime = case_when(\n      tpq_period_num &lt;= 2 ~ \"A: Pre-transition\",\n      tpq_period_num == 3 ~ \"B: Transition\",\n      tpq_period_num &gt;= 4 ~ \"C: Post-transition\"\n    ),\n    regime_num = case_when(\n      tpq_period_num &lt;= 2 ~ 1,\n      tpq_period_num == 3 ~ 2,\n      tpq_period_num &gt;= 4 ~ 3\n    )\n  )\n\nregime_summary &lt;- hoard_comp %&gt;%\n  group_by(regime) %&gt;%\n  summarise(\n    n_hoards = n(),\n    mean_p_rome = mean(p_rome),\n    sd_p_rome = sd(p_rome),\n    .groups = \"drop\"\n  )\n\nkable(regime_summary, digits = 3, caption = \"Summary by assigned regime\")\n\n\n\nSummary by assigned regime\n\n\nregime\nn_hoards\nmean_p_rome\nsd_p_rome\n\n\n\n\nA: Pre-transition\n98\n0.921\n0.130\n\n\nB: Transition\n166\n0.949\n0.071\n\n\nC: Post-transition\n199\n0.804\n0.181"
  },
  {
    "objectID": "hmm_analysis.html#spatial-analysis-by-regime",
    "href": "hmm_analysis.html#spatial-analysis-by-regime",
    "title": "Hidden Markov Model for Roman Monetary Regimes",
    "section": "6.2 Spatial Analysis by Regime",
    "text": "6.2 Spatial Analysis by Regime\n\n\nCode\nlibrary(rnaturalearth)\nlibrary(rnaturalearthdata)\n\n# Convert to sf\nhoard_sf &lt;- st_as_sf(\n  hoard_comp,\n  coords = c(\"hoard_long\", \"hoard_lat\"),\n  crs = 4326,\n  remove = FALSE\n)\n\n# Land and extent\nland &lt;- ne_countries(scale = \"medium\", returnclass = \"sf\") %&gt;% st_union()\n\nhoard_bbox &lt;- st_bbox(hoard_sf)\npad &lt;- 2\n\nstudy_extent &lt;- st_polygon(list(rbind(\n  c(hoard_bbox[\"xmin\"] - pad, hoard_bbox[\"ymin\"] - pad),\n  c(hoard_bbox[\"xmax\"] + pad, hoard_bbox[\"ymin\"] - pad),\n  c(hoard_bbox[\"xmax\"] + pad, hoard_bbox[\"ymax\"] + pad),\n  c(hoard_bbox[\"xmin\"] - pad, hoard_bbox[\"ymax\"] + pad),\n  c(hoard_bbox[\"xmin\"] - pad, hoard_bbox[\"ymin\"] - pad)\n))) %&gt;% st_sfc(crs = 4326)\n\nstudy_land &lt;- st_intersection(land, study_extent)\n\n# Project\ntarget_crs &lt;- 3035\nhoard_sf_proj &lt;- st_transform(hoard_sf, target_crs)\nstudy_land_proj &lt;- st_transform(study_land, target_crs)\n\nrome_mint &lt;- st_as_sf(\n  tibble(lon = 12.4964, lat = 41.9028),\n  coords = c(\"lon\", \"lat\"), crs = 4326\n) %&gt;% st_transform(target_crs)"
  },
  {
    "objectID": "hmm_analysis.html#hex-grid-and-aggregation-by-regime",
    "href": "hmm_analysis.html#hex-grid-and-aggregation-by-regime",
    "title": "Hidden Markov Model for Roman Monetary Regimes",
    "section": "6.3 Hex Grid and Aggregation by Regime",
    "text": "6.3 Hex Grid and Aggregation by Regime\n\n\nCode\nhex_size &lt;- 100000\n\nhex_grid &lt;- st_make_grid(study_land_proj, cellsize = hex_size, square = FALSE) %&gt;%\n  st_sf(hex_id = seq_along(.), geometry = .) %&gt;%\n  st_set_crs(target_crs)\n\nhex_land &lt;- hex_grid %&gt;%\n  filter(lengths(st_intersects(., study_land_proj)) &gt; 0)\n\nhex_centroids &lt;- st_centroid(hex_land)\non_land &lt;- lengths(st_intersects(hex_centroids, study_land_proj)) &gt; 0\nhex_land &lt;- hex_land[on_land, ]\n\n# Spatial join\nhoard_hex &lt;- st_join(hoard_sf_proj, hex_land, join = st_within) %&gt;%\n  filter(!is.na(hex_id))\n\n# Aggregate by hex AND regime\nhex_regime &lt;- hoard_hex %&gt;%\n  st_drop_geometry() %&gt;%\n  group_by(hex_id, regime, regime_num) %&gt;%\n  summarise(\n    n_hoards = n(),\n    total_types = sum(n_types),\n    rome_types = sum(n_rome),\n    p_rome = rome_types / total_types,\n    .groups = \"drop\"\n  )\n\n# Regime-specific globals\nregime_globals &lt;- hex_regime %&gt;%\n  group_by(regime, regime_num) %&gt;%\n  summarise(\n    p_rome_regime = sum(rome_types) / sum(total_types),\n    .groups = \"drop\"\n  )\n\nkable(regime_globals, digits = 3, caption = \"Global Rome proportion by regime\")\n\n\n\nGlobal Rome proportion by regime\n\n\nregime\nregime_num\np_rome_regime\n\n\n\n\nA: Pre-transition\n1\n0.927\n\n\nB: Transition\n2\n0.945\n\n\nC: Post-transition\n3\n0.835\n\n\n\n\n\nCode\n# Compute LRR by regime\nhex_regime_lrr &lt;- hex_regime %&gt;%\n  left_join(regime_globals, by = c(\"regime\", \"regime_num\")) %&gt;%\n  mutate(\n    LRR = log(p_rome + 0.01) - log(p_rome_regime)\n  )"
  },
  {
    "objectID": "hmm_analysis.html#regime-specific-spatial-maps",
    "href": "hmm_analysis.html#regime-specific-spatial-maps",
    "title": "Hidden Markov Model for Roman Monetary Regimes",
    "section": "6.4 Regime-Specific Spatial Maps",
    "text": "6.4 Regime-Specific Spatial Maps\n\n\nCode\nhex_regime_sf &lt;- hex_land %&gt;%\n  inner_join(hex_regime_lrr, by = \"hex_id\") %&gt;%\n  st_transform(4326)\n\nland_wgs &lt;- st_transform(study_land_proj, 4326)\nrome_wgs &lt;- st_transform(rome_mint, 4326)\n\nggplot() +\n  geom_sf(data = land_wgs, fill = \"grey95\", color = \"grey80\") +\n  geom_sf(\n    data = hex_regime_sf,\n    aes(fill = LRR),\n    color = \"grey50\",\n    linewidth = 0.15\n  ) +\n  geom_sf(data = rome_wgs, color = \"black\", shape = 8, size = 3, stroke = 1) +\n  scale_fill_gradient2(\n    low = \"steelblue\", mid = \"white\", high = \"darkred\",\n    midpoint = 0, name = \"LRR\",\n    limits = c(-0.5, 0.5), oob = scales::squish\n  ) +\n  coord_sf(\n    xlim = c(hoard_bbox[\"xmin\"] - 1, hoard_bbox[\"xmax\"] + 1),\n    ylim = c(hoard_bbox[\"ymin\"] - 1, hoard_bbox[\"ymax\"] + 1)\n  ) +\n  facet_wrap(~regime, ncol = 3) +\n  labs(\n    title = \"Compositional LRR by Monetary Regime\",\n    subtitle = \"Red = above regime average | Blue = below | Star = Rome mint\",\n    caption = \"Regimes defined by TPQ period grouping\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text = element_blank(),\n    axis.title = element_blank(),\n    strip.text = element_text(size = 10, face = \"bold\")\n  )"
  },
  {
    "objectID": "hmm_analysis.html#emission-model-definition",
    "href": "hmm_analysis.html#emission-model-definition",
    "title": "Hidden Markov Model for Roman Monetary Regimes",
    "section": "7.1 Emission Model Definition",
    "text": "7.1 Emission Model Definition\nDefine emission probabilities based on observed distributions:\n\n\nCode\n# For each regime, estimate the emission distribution parameters\nemission_params &lt;- hoard_comp %&gt;%\n  group_by(regime_num) %&gt;%\n  summarise(\n    mu = mean(p_rome),\n    sigma = sd(p_rome),\n    n = n(),\n    .groups = \"drop\"\n  )\n\nkable(emission_params, digits = 4, caption = \"Emission distribution parameters by regime\")\n\n\n\nEmission distribution parameters by regime\n\n\nregime_num\nmu\nsigma\nn\n\n\n\n\n1\n0.9207\n0.1298\n98\n\n\n2\n0.9488\n0.0711\n166\n\n\n3\n0.8035\n0.1811\n199\n\n\n\n\n\nCode\n# Define emission probability function (Gaussian)\nemission_prob &lt;- function(p_rome, state, params) {\n  mu &lt;- params$mu[params$regime_num == state]\n  sigma &lt;- params$sigma[params$regime_num == state]\n  dnorm(p_rome, mean = mu, sd = sigma)\n}"
  },
  {
    "objectID": "hmm_analysis.html#transition-matrix-estimation",
    "href": "hmm_analysis.html#transition-matrix-estimation",
    "title": "Hidden Markov Model for Roman Monetary Regimes",
    "section": "7.2 Transition Matrix Estimation",
    "text": "7.2 Transition Matrix Estimation\n\n\nCode\n# Count transitions between periods\n# Since we defined regimes by period, transitions are deterministic:\n# Period 1,2 -&gt; Regime 1\n# Period 3 -&gt; Regime 2\n# Period 4 -&gt; Regime 3\n\n# For a proper HMM, we'd estimate transitions from repeated observations\n# Here we'll define a plausible transition matrix based on the regime structure\n\n# Transition matrix: probability of moving from row state to column state\n# Given our setup: we expect state persistence with gradual transitions\n\ntrans_matrix &lt;- matrix(\n  c(0.7, 0.3, 0.0,   # From state 1\n    0.1, 0.6, 0.3,   # From state 2\n    0.0, 0.2, 0.8),  # From state 3\n  nrow = 3, byrow = TRUE,\n  dimnames = list(c(\"Pre\", \"Trans\", \"Post\"), c(\"Pre\", \"Trans\", \"Post\"))\n)\n\nkable(trans_matrix, digits = 2, caption = \"Assumed transition matrix\")\n\n\n\nAssumed transition matrix\n\n\n\nPre\nTrans\nPost\n\n\n\n\nPre\n0.7\n0.3\n0.0\n\n\nTrans\n0.1\n0.6\n0.3\n\n\nPost\n0.0\n0.2\n0.8"
  },
  {
    "objectID": "hmm_analysis.html#forward-backward-algorithm-conceptual",
    "href": "hmm_analysis.html#forward-backward-algorithm-conceptual",
    "title": "Hidden Markov Model for Roman Monetary Regimes",
    "section": "7.3 Forward-Backward Algorithm (Conceptual)",
    "text": "7.3 Forward-Backward Algorithm (Conceptual)\n\n\nCode\n# For illustration, compute the most likely state sequence\n# given our 4 periods and the observed Rome proportions\n\n# Aggregate observations per period\nperiod_obs &lt;- period_agg %&gt;%\n  dplyr::select(tpq_period_num, p_rome) %&gt;%\n  rename(period = tpq_period_num, obs = p_rome)\n\n# Initial state probabilities\ninit_prob &lt;- c(0.8, 0.15, 0.05)  # Start likely in pre-transition\n\n# Forward algorithm\nforward_probs &lt;- matrix(0, nrow = nrow(period_obs), ncol = 3)\ncolnames(forward_probs) &lt;- c(\"Pre\", \"Trans\", \"Post\")\n\nfor (t in 1:nrow(period_obs)) {\n  obs &lt;- period_obs$obs[t]\n  \n  # Emission probabilities for this observation\n  emit &lt;- sapply(1:3, function(s) emission_prob(obs, s, emission_params))\n  \n  if (t == 1) {\n    forward_probs[t, ] &lt;- init_prob * emit\n  } else {\n    for (s in 1:3) {\n      forward_probs[t, s] &lt;- emit[s] * sum(forward_probs[t-1, ] * trans_matrix[, s])\n    }\n  }\n  # Normalize\n  forward_probs[t, ] &lt;- forward_probs[t, ] / sum(forward_probs[t, ])\n}\n\n# Most likely state per period\nmost_likely &lt;- apply(forward_probs, 1, which.max)\nstate_names &lt;- c(\"Pre-transition\", \"Transition\", \"Post-transition\")\n\nviterbi_result &lt;- tibble(\n  period = period_obs$period,\n  period_label = period_labels[period_obs$period],\n  obs_p_rome = period_obs$obs,\n  prob_pre = forward_probs[, 1],\n  prob_trans = forward_probs[, 2],\n  prob_post = forward_probs[, 3],\n  most_likely_state = state_names[most_likely]\n)\n\nkable(viterbi_result, digits = 3, caption = \"Forward algorithm state probabilities\")\n\n\n\nForward algorithm state probabilities\n\n\n\n\n\n\n\n\n\n\n\nperiod\nperiod_label\nobs_p_rome\nprob_pre\nprob_trans\nprob_post\nmost_likely_state\n\n\n\n\n1\n1: Early Republic\n0.573\n0.581\n0.000\n0.419\nPre-transition\n\n\n2\n2: Late Republic I\n0.945\n0.382\n0.449\n0.169\nTransition\n\n\n3\n3: Late Republic II\n0.944\n0.253\n0.629\n0.118\nTransition\n\n\n4\n4: Triumviral/Augustan\n0.828\n0.314\n0.347\n0.339\nTransition"
  },
  {
    "objectID": "hmm_analysis.html#visualize-state-sequence",
    "href": "hmm_analysis.html#visualize-state-sequence",
    "title": "Hidden Markov Model for Roman Monetary Regimes",
    "section": "7.4 Visualize State Sequence",
    "text": "7.4 Visualize State Sequence\n\n\nCode\n# Reshape for plotting\nviterbi_long &lt;- viterbi_result %&gt;%\n  pivot_longer(\n    cols = starts_with(\"prob_\"),\n    names_to = \"state\",\n    values_to = \"probability\",\n    names_prefix = \"prob_\"\n  ) %&gt;%\n  mutate(\n    state = recode(state,\n      \"pre\" = \"Pre-transition\",\n      \"trans\" = \"Transition\",\n      \"post\" = \"Post-transition\"\n    )\n  )\n\np1 &lt;- ggplot(viterbi_long, aes(x = period, y = probability, fill = state)) +\n  geom_area(alpha = 0.7) +\n  scale_fill_manual(\n    values = c(\"Pre-transition\" = \"steelblue\", \n               \"Transition\" = \"gold\", \n               \"Post-transition\" = \"darkred\")\n  ) +\n  scale_x_continuous(\n    breaks = 1:4,\n    labels = c(\"Early Rep\", \"Late Rep I\", \"Late Rep II\", \"Triumviral\")\n  ) +\n  labs(\n    title = \"State Probabilities Over Time\",\n    subtitle = \"Forward algorithm results\",\n    x = \"Period\",\n    y = \"State probability\",\n    fill = \"State\"\n  )\n\np2 &lt;- ggplot(viterbi_result, aes(x = period, y = obs_p_rome)) +\n  geom_line(linewidth = 1.2, color = \"grey30\") +\n  geom_point(aes(color = most_likely_state), size = 5) +\n  scale_color_manual(\n    values = c(\"Pre-transition\" = \"steelblue\",\n               \"Transition\" = \"gold\",\n               \"Post-transition\" = \"darkred\")\n  ) +\n  scale_x_continuous(\n    breaks = 1:4,\n    labels = c(\"Early Rep\", \"Late Rep I\", \"Late Rep II\", \"Triumviral\")\n  ) +\n  scale_y_continuous(labels = scales::percent_format(), limits = c(0.8, 1)) +\n  labs(\n    title = \"Observed Rome Proportion with State Assignment\",\n    x = \"Period\",\n    y = \"Rome proportion\",\n    color = \"Most likely state\"\n  )\n\np1 / p2"
  },
  {
    "objectID": "hmm_analysis.html#morans-i-test",
    "href": "hmm_analysis.html#morans-i-test",
    "title": "Hidden Markov Model for Roman Monetary Regimes",
    "section": "9.1 Moran’s I Test",
    "text": "9.1 Moran’s I Test\n\n\nCode\nlibrary(spdep)\n\n# For each regime, test spatial autocorrelation in Rome proportion\n\nmorans_results &lt;- list()\n\nfor (r in unique(hex_regime_lrr$regime)) {\n  \n  regime_data &lt;- hex_regime_sf %&gt;%\n    filter(regime == r)\n  \n  if (nrow(regime_data) &lt; 10) {\n    morans_results[[r]] &lt;- list(regime = r, n = nrow(regime_data), \n                                  moran_I = NA, p_value = NA)\n    next\n  }\n  \n  # Create neighbor list\n  coords &lt;- st_coordinates(st_centroid(regime_data))\n  \n  # K-nearest neighbors (k=4)\n  knn &lt;- knearneigh(coords, k = min(4, nrow(regime_data) - 1))\n  nb &lt;- knn2nb(knn)\n  \n  # Weights\n  lw &lt;- nb2listw(nb, style = \"W\", zero.policy = TRUE)\n  \n  # Moran's I\n  moran_test &lt;- tryCatch(\n    moran.test(regime_data$p_rome, lw, zero.policy = TRUE),\n    error = function(e) NULL\n  )\n  \n  if (!is.null(moran_test)) {\n    morans_results[[r]] &lt;- list(\n      regime = r,\n      n = nrow(regime_data),\n      moran_I = moran_test$estimate[\"Moran I statistic\"],\n      p_value = moran_test$p.value\n    )\n  } else {\n    morans_results[[r]] &lt;- list(regime = r, n = nrow(regime_data),\n                                  moran_I = NA, p_value = NA)\n  }\n}\n\nmorans_df &lt;- bind_rows(morans_results)\nkable(morans_df, digits = 4, caption = \"Spatial autocorrelation (Moran's I) by regime\")\n\n\n\nSpatial autocorrelation (Moran’s I) by regime\n\n\nregime\nn\nmoran_I\np_value\n\n\n\n\nA: Pre-transition\n48\n0.1015\n0.0672\n\n\nB: Transition\n74\n-0.0865\n0.8445\n\n\nC: Post-transition\n91\n0.1460\n0.0081"
  },
  {
    "objectID": "circulation_model.html",
    "href": "circulation_model.html",
    "title": "Roman Coin Circulation Model",
    "section": "",
    "text": "Create probability surfaces showing expected hoard composition at any location and time, based on:\n\nProduction: Which mints produced how many coins, when\nDiffusion: How coins spread spatially from their mint of origin\nAccumulation: How hoards aggregate coins from multiple sources over time\n\n\n\n\n\\[E[\\text{prop. from mint } m \\text{ at } (h,t)] = \\frac{\\sum_{\\tau &lt; t} M_{m,\\tau} \\cdot P(h|m,\\tau,t) \\cdot w(t-\\tau)}{\\sum_{m'}\\sum_{\\tau &lt; t} M_{m',\\tau} \\cdot P(h|m',\\tau,t) \\cdot w(t-\\tau)}\\]\nWhere:\n\n\\(M_{m,\\tau}\\) = production from mint \\(m\\) in period \\(\\tau\\)\n\\(P(h|m,\\tau,t)\\) = probability coin reaches hex \\(h\\) from mint \\(m\\)\n\\(w(t-\\tau)\\) = circulation weight (optional decay)\n\n\n\n\n\\[\\text{logit}(p_{mh}) = \\alpha_m - \\beta_m \\cdot d_{mh} + \\gamma_{m,1} \\cdot \\cos(\\theta_{mh}) + \\gamma_{m,2} \\cdot \\sin(\\theta_{mh}) + \\delta_m \\cdot \\text{age}\\]\nWith partial pooling:\n\\[\\beta_m \\sim N(\\mu_\\beta, \\sigma_\\beta^2)\\]"
  },
  {
    "objectID": "circulation_model.html#objective",
    "href": "circulation_model.html#objective",
    "title": "Roman Coin Circulation Model",
    "section": "",
    "text": "Create probability surfaces showing expected hoard composition at any location and time, based on:\n\nProduction: Which mints produced how many coins, when\nDiffusion: How coins spread spatially from their mint of origin\nAccumulation: How hoards aggregate coins from multiple sources over time"
  },
  {
    "objectID": "circulation_model.html#model-structure",
    "href": "circulation_model.html#model-structure",
    "title": "Roman Coin Circulation Model",
    "section": "",
    "text": "\\[E[\\text{prop. from mint } m \\text{ at } (h,t)] = \\frac{\\sum_{\\tau &lt; t} M_{m,\\tau} \\cdot P(h|m,\\tau,t) \\cdot w(t-\\tau)}{\\sum_{m'}\\sum_{\\tau &lt; t} M_{m',\\tau} \\cdot P(h|m',\\tau,t) \\cdot w(t-\\tau)}\\]\nWhere:\n\n\\(M_{m,\\tau}\\) = production from mint \\(m\\) in period \\(\\tau\\)\n\\(P(h|m,\\tau,t)\\) = probability coin reaches hex \\(h\\) from mint \\(m\\)\n\\(w(t-\\tau)\\) = circulation weight (optional decay)"
  },
  {
    "objectID": "circulation_model.html#hierarchical-diffusion-model",
    "href": "circulation_model.html#hierarchical-diffusion-model",
    "title": "Roman Coin Circulation Model",
    "section": "",
    "text": "\\[\\text{logit}(p_{mh}) = \\alpha_m - \\beta_m \\cdot d_{mh} + \\gamma_{m,1} \\cdot \\cos(\\theta_{mh}) + \\gamma_{m,2} \\cdot \\sin(\\theta_{mh}) + \\delta_m \\cdot \\text{age}\\]\nWith partial pooling:\n\\[\\beta_m \\sim N(\\mu_\\beta, \\sigma_\\beta^2)\\]"
  },
  {
    "objectID": "circulation_model.html#load-chrr-data",
    "href": "circulation_model.html#load-chrr-data",
    "title": "Roman Coin Circulation Model",
    "section": "3.1 1.1 Load CHRR Data",
    "text": "3.1 1.1 Load CHRR Data\n\n\nCode\nchrr_file &lt;- \"/Users/john/Library/Mobile Documents/com~apple~CloudDocs/Home/John/GIS/Roman Italy GIS/Coin Project/data/chrr_data.csv\"\n\nif (!file.exists(chrr_file)) {\n  alt_paths &lt;- c(\"/mnt/user-data/uploads/chrr_data.csv\", \"~/chrr_data.csv\")\n  for (alt in alt_paths) {\n    if (file.exists(alt)) {\n      chrr_file &lt;- alt\n      break\n    }\n  }\n}\n\nchrr_raw &lt;- read_csv(chrr_file, show_col_types = FALSE)\ncat(\"✓ Loaded\", nrow(chrr_raw), \"coin-type records\\n\")\n\n\n✓ Loaded 31951 coin-type records\n\n\nCode\ncat(\"  Unique hoards:\", n_distinct(chrr_raw$hoard_id), \"\\n\")\n\n\n  Unique hoards: 493 \n\n\nCode\ncat(\"  Unique mints:\", n_distinct(chrr_raw$mint_id), \"\\n\")\n\n\n  Unique mints: 15"
  },
  {
    "objectID": "circulation_model.html#extract-unique-mint-uris",
    "href": "circulation_model.html#extract-unique-mint-uris",
    "title": "Roman Coin Circulation Model",
    "section": "3.2 1.2 Extract Unique Mint URIs",
    "text": "3.2 1.2 Extract Unique Mint URIs\n\n\nCode\n# Get unique mints with their URIs\nmint_list &lt;- chrr_raw %&gt;%\n  filter(!is.na(mint_uri), mint_uri != \"\") %&gt;%\n  group_by(mint_id, mint_uri) %&gt;%\n  summarise(\n    n_types = n(),\n    n_hoards = n_distinct(hoard_id),\n    .groups = \"drop\"\n  ) %&gt;%\n  arrange(desc(n_types))\n\ncat(\"Unique mints with URIs:\", nrow(mint_list), \"\\n\")\n\n\nUnique mints with URIs: 14 \n\n\nCode\ncat(\"\\nTop 20 mints by coin-type count:\\n\")\n\n\n\nTop 20 mints by coin-type count:\n\n\nCode\nkable(head(mint_list, 20))\n\n\n\n\n\n\n\n\n\n\n\nmint_id\nmint_uri\nn_types\nn_hoards\n\n\n\n\nrome\nhttp://nomisma.org/id/rome\n28177\n490\n\n\nuncertain_value\nhttp://nomisma.org/id/uncertain_value\n2263\n343\n\n\nnarbo\nhttp://nomisma.org/id/narbo\n379\n185\n\n\nitaly_north_rrc\nhttp://nomisma.org/id/italy_north_rrc\n297\n165\n\n\nmassalia\nhttp://nomisma.org/id/massalia\n55\n50\n\n\nitaly_southeast_rrc\nhttp://nomisma.org/id/italy_southeast_rrc\n53\n35\n\n\nsicily2_rrc\nhttp://nomisma.org/id/sicily2_rrc\n45\n34\n\n\napollonia_illyria\nhttp://nomisma.org/id/apollonia_illyria\n32\n27\n\n\nluceria\nhttp://nomisma.org/id/luceria\n25\n13\n\n\nitaly_central_rrc\nhttp://nomisma.org/id/italy_central_rrc\n24\n21\n\n\nsicily1_rrc\nhttp://nomisma.org/id/sicily1_rrc\n12\n11\n\n\nosca\nhttp://nomisma.org/id/osca\n4\n4\n\n\nlugdunum\nhttp://nomisma.org/id/lugdunum\n3\n3\n\n\nsalpesa\nhttp://nomisma.org/id/salpesa\n3\n2"
  },
  {
    "objectID": "circulation_model.html#load-mint-coordinates-from-geojson",
    "href": "circulation_model.html#load-mint-coordinates-from-geojson",
    "title": "Roman Coin Circulation Model",
    "section": "3.3 1.3 Load Mint Coordinates from GeoJSON",
    "text": "3.3 1.3 Load Mint Coordinates from GeoJSON\n\n\nCode\n# NOTE: Cache disabled to ensure manual coordinate updates work correctly\n# If you want to re-enable caching, add: #| cache: true\n\n# Load mint coordinates from your GeoJSON file\n# This is more reliable than fetching from Nomisma API\nmints_geojson_path &lt;- \"/Users/john/Library/Mobile Documents/com~apple~CloudDocs/Home/John/GIS/Roman Italy GIS/Coin Project/data/mints.geojson\"\n\n# Try alternative paths if needed\nif (!file.exists(mints_geojson_path)) {\n  alt_paths &lt;- c(\n    \"/mnt/user-data/uploads/mints.geojson\",\n    \"~/mints.geojson\",\n    \"mints.geojson\"\n  )\n  for (p in alt_paths) {\n    if (file.exists(p)) {\n      mints_geojson_path &lt;- p\n      break\n    }\n  }\n}\n\nif (file.exists(mints_geojson_path)) {\n  # Load GeoJSON\n  mints_sf &lt;- st_read(mints_geojson_path, quiet = TRUE)\n  \n  # Extract coordinates and mint_id from URI\n  mints_from_geojson &lt;- mints_sf %&gt;%\n    st_drop_geometry() %&gt;%\n    mutate(\n      coords = st_coordinates(mints_sf),\n      mint_lon = coords[, 1],\n      mint_lat = coords[, 2],\n      # Extract mint_id from URI (last part after /)\n      mint_id_from_uri = str_extract(uri, \"[^/]+$\")\n    ) %&gt;%\n    dplyr::select(name, mint_id_from_uri, mint_lat, mint_lon, uri) %&gt;%\n    distinct(mint_id_from_uri, .keep_all = TRUE)\n  \n  cat(\"✓ Loaded\", nrow(mints_from_geojson), \"mints from GeoJSON\\n\")\n  print(mints_from_geojson)\n  \n} else {\n  cat(\"⚠ GeoJSON file not found, will use manual coordinates only\\n\")\n  mints_from_geojson &lt;- tibble(\n    name = character(),\n    mint_id_from_uri = character(),\n    mint_lat = numeric(),\n    mint_lon = numeric(),\n    uri = character()\n  )\n}\n\n\n✓ Loaded 465 mints from GeoJSON\n                                   name        mint_id_from_uri mint_lat\n1                           (H)aluntium                aluntium 38.07190\n2                                Abdera           abdera_thrace 40.95000\n3                                Abydus                  abydus 40.19602\n4                              Acanthus                acanthus 40.39975\n5                               Achaeum                 achaeum 39.81311\n6                            Achilleion              achilleion 39.98975\n7                                 Adada                   adada 37.59160\n8                               Adranum                 adranum 37.66285\n9                                 Aegae            aegae_achaea 38.15488\n10                                Aegae            aegae_aeolis 38.82032\n11                                Aegae         aegae_macedonia 40.48111\n12                              Aegeira                 aegeira 38.13103\n13                               Aegina           aegina_aegina 37.75000\n14                               Aegium                  aegium 38.25271\n15                                Aenai                   aenai 35.05842\n16                               Aeneia                  aeneia 40.43948\n17                             Aenianes                aenianes 38.87140\n18                                Aenus                   aenus 40.72514\n19                             Aesernia                aesernia 41.59435\n20                           Agrigentum              agrigentum 37.31667\n21                             Alabanda                alabanda 37.59779\n22                    Alexandreia Troas       alexandreia_troas 39.76128\n23                           Alexandria       alexandreia_egypt 31.20144\n24                              Allifae                 allifae 41.32849\n25                            Alyz(e)ia                  alyzia 38.71337\n26                            Amas(e)ia                  amasia 40.67867\n27                             Amastris                amastris 41.74697\n28                              Amathus                 amathus 34.71235\n29                             Ambracia                ambracia 39.15488\n30                            Ami(naea)                ami_naea 39.82300\n31                               Amisus                  amisus 41.29272\n32                              Amorium                 amorium 39.02645\n33                           Amphaxitis              amphaxitis 40.62640\n34                           Amphipolis              amphipolis 40.82360\n35                           Anactorium              anactorium 38.91667\n36                               Andros                  andros 37.83333\n37                            Antandrus               antandrus 39.57850\n38                           Antigoneia        antigoneia_syria 36.26335\n39              Antiocheia ad Maeandrum antiocheia_ad_maeandrum 37.87340\n40                              Antioch        antiocheia_syria 36.20000\n41                    Apamea in Phrygia         apamea_phrygiae 38.07100\n42                     Apameia in Syria           apameia_syria 35.42074\n43                              Aphytis                 aphytis 40.09937\n44                    Apollonia Pontica       apollonia_pontica 42.41716\n45                            Apollonia       apollonia_illyria 40.71667\n46                               Aptera                  aptera 35.46655\n47                            Aquilonia               aquilonia 40.98786\n48                              Aquinum                 aquinum 41.49221\n49                               Aradus                  aradus 34.85840\n50                              Arcadia           arcadia_crete 35.08033\n51                  Argos Amphilochicum     argos_amphilochicum 38.93591\n52                                Argos           argos_argolis 37.61667\n53                             Ariassus                ariassus 37.15490\n54                             Ariminum                ariminum 44.05000\n55                                 Arpi                    arpi 41.47565\n56                              Ascalon                 ascalon 31.66999\n57                             Aspendus                aspendus 36.93820\n58                                Assus                   assus 39.49162\n59                               Athens                  athens 37.97472\n60                                Atrax                   atrax 39.58982\n61                             Attaleia                attaleia 36.89390\n62                                 Axus                    axus 35.30805\n63                              Babylon                 babylon 32.52291\n64                               Bactra                  bactra 36.76781\n65                                Barce                   barce 32.49450\n66                               Beroea          beroea_macedon 40.51667\n67                              Berytus                 berytus 33.89928\n68                             Bishapur                bishapur 29.73556\n69                           Brundisium              brundisium 40.63619\n70                             Bruttium                 bruttii 39.25000\n71                               Byblus                  byblus 34.11950\n72                               Byllis                  byllis 40.55000\n73                            Byzantium               byzantium 41.01224\n74                              Cabeira                 cabeira 40.60998\n75                               Cabyle                  cabyle 42.52815\n76                            Calchedon               calchedon 40.98339\n77                                Cales                   cales 41.19993\n78                             Callatis                callatis 43.81715\n79                              Calymna                 calymna 36.97830\n80                             Camarina                camarina 36.87229\n81                              Camirus                 camirus 36.33627\n82                    Campano-Tarentine       campano-tarentine 40.54720\n83                               Caphya                  caphya 37.76626\n84                                Capua                   capua 41.08624\n85                               Cardia                  cardia 40.54823\n86                                Carmo                   carmo 37.47100\n87                                Carne                   carne 34.93884\n88                              Carrhae                 carrhae 36.86635\n89                             Carthaea                carthaea 37.56026\n90                             Carthage                carthage 36.84701\n91                             Carystus                carystus 38.01654\n92                              Cassope                 cassope 39.14053\n93                              Castulo                 castulo 38.03791\n94                               Catana                  catana 37.50296\n95                             Caulonia                caulonia 38.44543\n96                               Caunus                  caunus 36.82827\n97                               Cebren                  cebren 39.74180\n98                           Celenderis              celenderis 36.14249\n99                           Centuripae              centuripae 37.62407\n100                                Ceos               ceos_ceos 37.61667\n101                          Cercinitis              cercinitis 45.20367\n102                            Chabacta                chabacta 41.23600\n103                             Chalcis                 chalcis 38.45714\n104                     Charax Spasinou         charax_spasinou 30.89469\n105                         Cherronesus             cherronesus 44.61163\n106                         Chersonesus      chersonesus_cariae 36.77574\n107                         Chersonesus       chersonesus_crete 35.31916\n108                         Chersonesus      chersonesus_thrace 40.33333\n109                               Chios                   chios 38.37477\n110                              Cirrha                  cirrha 38.42894\n111                              Citium                  citium 34.92960\n112                                Cius                    cius 40.43247\n113                          Clazomenae              clazomenae 38.37389\n114                             Cleitor                 cleitor 37.89354\n115                             Cleonae                 cleonae 37.82444\n116                              Cnidus                  cnidus 36.69017\n117                             Cnossus                 cnossus 35.29796\n118                            Colophon                colophon 37.99350\n119                              Comama                  comama 37.32130\n120                              Comana                  comana 40.37731\n121                         Compulteria             compulteria 41.25193\n122                               Copia                   copia 39.75069\n123                             Corcyra         corcyra_corcyra 39.60444\n124                             Corduba                 corduba 37.88468\n125                             Corinth                 corinth 37.93333\n126                            Coroneia                coroneia 38.39120\n127                              Corone                  corone 36.79281\n128                             Coronta                 coronta 38.58809\n129                                Cosa                    cosa 42.41092\n130                             Cossura                 cossura 36.83333\n131                                 Cos                     cos 36.89589\n132                              Cremna                  cremna 37.50014\n133                              Cromna                  cromna 41.84399\n134                              Croton                  croton 39.08076\n135                               Cumae                   cumae 40.84712\n136                             Cydonia                 cydonia 35.51667\n137                                Cyme             cyme_aeolis 38.76185\n138                              Cyrene                  cyrene 32.82304\n139                             Cyzicus                 cyzicus 40.38132\n140                            Damascus                damascus 33.51300\n141                           Damastium               damastium 41.08333\n142                            Dardanus                dardanus 40.07973\n143                               Delos                   delos 37.38948\n144                              Delphi                  delphi 38.48411\n145                           Demetrias         demetrias_syria 33.51161\n146                            Derrones                derrones 41.25000\n147                                 Dia                     dia 41.08750\n148                              Dicaea          dicaea_macedon 40.46049\n149                              Dicaea           dicaea_thrace 40.99287\n150                        Dionysopolis     dionysopolis_thrace 43.42563\n151                          Dioscurias              dioscurias 42.99330\n152                                Dyme                    dyme 38.14462\n153                         Dyrrhachium             dyrrhachium 41.31667\n154                              Ebusus                  ebusus 38.90839\n155                            Ecbatana                ecbatana 34.80650\n156                             Echinus                 echinus 38.90827\n157                                Eion                    eion 40.78841\n158                               Elaea                   elaea 38.94164\n159                                Elea                    elea 39.44425\n160                             Eleusis                 eleusis 38.03333\n161                          Eleutherna              eleutherna 35.32810\n162                                Elis               elis_elis 37.89178\n163                              Elyrus                  elyrus 35.28318\n164                            Emporiae                emporiae 42.13211\n165                                Enna                    enna 37.56765\n166                          Ephesus II          ephesus_ii_pco 37.93972\n167                             Ephesus                 ephesus 37.93972\n168                           Epidaurus               epidaurus 37.63328\n169                              Eresus                  eresus 39.16861\n170                             Eretria                 eretria 38.38333\n171                            Erythrae                erythrae 38.38194\n172                                Eryx                    eryx 38.03652\n173                              Etenna                  etenna 36.99312\n174                        Euhesperides            euhesperides 32.10979\n175                               Eurea                   eurea 39.80000\n176                            Euthenai                euthenai 36.93597\n177                               Gades                   gades 36.53333\n178                            Gambrium                gambrium 39.09108\n179                             Gargara                 gargara 39.53348\n180                                Gaza                    gaza 31.51097\n181                             Gaziura                 gaziura 40.40405\n182                                Gela                    gela 37.06316\n183                              Gergis                  gergis 39.89849\n184                              Gerrha                  gerrha 25.94539\n185                         Geto-Dacian             geto_dacian 43.85000\n186                              Golgoi                   golgi 35.06565\n187                              Gomphi                  gomphi 39.45333\n188                           Gorgippia               gorgippia 44.89221\n189                              Gortyn                 gortyna 35.06333\n190                           Haliartus               haliartus 38.36667\n191                       Halicarnassus           halicarnassus 37.03517\n192                              Hatria                  hatria 42.58020\n193                        Hecatompylos            hecatompylos 35.96168\n194                   Heraclea Lucaniae       heraclea_lucaniae 40.21302\n195                   Heracleia Pontica       heracleia_pontica 41.28472\n196                 Heracleia Trachinia     heracleia_trachinia 38.79204\n197                           Heracleia     heracleia_illyricum 43.16667\n198                 Herakleia ad Latmum      heraclea_ad_latmum 37.50194\n199                            Hermione                hermione 37.38522\n200                  Hierapolis Bambyce      hierapolis_bambyce 36.52612\n201                          Hierapytna              hierapytna 35.01003\n202                              Himera                  himera 37.96667\n203                              Hipana                  hipana 37.72210\n204                           Hipponium               hipponium 38.67558\n205                       Hispano-Punic           hispano-punic 36.82248\n206                            Histiaea                histiaea 38.94660\n207 Hyria Campania (Hyrietes, Hyrianoi)          hyria_campania 40.97300\n208                             Ialysus                 ialysus 36.40028\n209                               Iasos                   iasus 37.27815\n210                              Ichnae                  ichnae 40.76401\n211                             Icosium                 icosium 36.77180\n212                             Idalium                 idalium 35.01997\n213                               Idyma                   idyma 37.05944\n214                              Ilerda                  ilerda 41.61412\n215                               Ilium                   ilium 39.95750\n216                              Imbros                  imbros 40.23306\n217                                 Iol                     iol 36.60683\n218                                 Ios                     ios 36.71667\n219                              Isinda                  isinda 37.06750\n220                                Issa                    issa 43.03333\n221                               Issus                   issus 36.83833\n222                             Istakhr                 istakhr 29.94045\n223                              Istrus                  istrus 44.54750\n224                              Itanus                  itanus 35.26779\n225                           Jerusalem               jerusalem 31.77668\n226                               Joppa                   joppa 32.05244\n227                              Keraia                ceraitae 37.51017\n228                                Kese                    kese 41.08942\n229                          Lacedaemon              lacedaemon 37.07368\n230                               Lamia                   lamia 38.90300\n231                           Lampsacus               lampsacus 40.34669\n232                    Laodicea ad Mare       laodiceia_ad_mare 35.51667\n233                  Laodiceia ad Lycum      laodiceia_ad_lycum 37.85525\n234                            Lapethus                lapethus 35.35059\n235                             Larissa        larissa_thessaly 39.64167\n236                                Laüs                    laus 39.76769\n237                             Lebedus                 lebedus 38.07788\n238                              Lemnos                  lemnos 39.91667\n239                            Leontini                leontini 37.28548\n240                                Lete                    lete 40.74493\n241                              Leucas                  leucas 38.80734\n242                              Lilaea                  lilaea 38.62885\n243                              Lindus                  lindus 36.08333\n244                              Lipara                  lipara 38.46742\n245                              Lissus                  lissus 41.78257\n246                               Lixus                     lix 35.19873\n247                   Locri Epizephyrii       locri_epizephyrii 38.23642\n248                             Luceria                 luceria 41.50923\n249                              Lysias                  lysias 38.25000\n250                          Lysimachia              lysimachia 40.54823\n251                              Lyttus                  lyttus 35.21288\n252             Macedonia, First Region    macedonia_1st_region 40.82360\n253            Macedonia, Second Region    macedonia_2nd_region 40.62640\n254               Magnesia ad Maeandrum   magnesia_ad_maeandrum 37.85309\n255                Magnesia in Thessaly                magnesia 39.75000\n256                              Mallus                  mallus 36.56315\n257                           Mamertini               mamertini 38.18000\n258                           Mantineia               mantineia 37.61662\n259                            Marathus                marathus 34.82650\n260                              Marium                  marium 35.03724\n261                            Maroneia                maroneia 40.90637\n262                            Massalia                massalia 43.29685\n263                         Megalopolis             megalopolis 37.41058\n264                              Megara                  megara 37.98508\n265                               Melos                   melos 36.74386\n266                             Memphis                 memphis 29.84467\n267                            Menaenum                menaenum 37.26640\n268                               Mende                   mende 39.97145\n269                           Mesembria               mesembria 42.66042\n270                               Mesma                   mesma 38.48733\n271                             Messana                 messana 38.19225\n272                             Messene                 messene 37.05000\n273                          Metapontum              metapontum 40.38313\n274                             Methana                 methana 37.58669\n275                            Methymna                methymna 39.36667\n276                          Metropolis    metropolis_acarnania 38.75000\n277                          Metropolis     metropolis_thessaly 39.50000\n278                             Miletus                 miletus 37.53023\n279                                Moda                    moda 35.46000\n280                             Molossi                 molossi 39.75000\n281                          Mopsuestia              mopsuestia 36.95884\n282                          Morgantina              morgantina 37.43108\n283                               Motya                   motya 37.86634\n284                              Mylasa                  mylasa 37.31667\n285                              Myndus                  myndus 37.05636\n286                          Myriandrus              myriandrus 36.56585\n287                              Myrina           myrina_aeolis 38.84010\n288                            Mytilene                mytilene 39.10481\n289                             Nagidus                 nagidus 36.09627\n290                             Natunia                 natunia 36.31100\n291                               Naxos                   naxos 37.10387\n292                               Naxos                   naxus 37.82532\n293                            Neandria                neandria 39.71974\n294                            Neapolis       neapolis_campania 40.84000\n295                            Neapolis        neapolis_macedon 40.93361\n296                               Nesos                   nesos 39.33668\n297                             Nineveh                 nineveh 36.35944\n298                             Nisibis                 nisibis 37.06667\n299                             Nisyros                 nisyros 36.58787\n300                                Nola                    nola 40.92587\n301                             Nuceria                 nuceria 40.74313\n302                           Nymphaeum               nymphaeum 45.23760\n303                                Nysa                    nysa 37.88778\n304                             Odessus                 odessus 43.21207\n305                            Oeniadae                oeniadae 38.40665\n306                               Oenoe                   oenoe 37.58333\n307                                Oeta                    oeta 38.82861\n308                               Olbia                   olbia 46.69190\n309                            Olynthus                olynthus 40.29259\n310                           Ophrynium               ophrynium 40.03585\n311                          Orchomenus      orchomenus_boeotia 38.48333\n312                              Oricus                  oricus 40.32762\n313                               Orion                   orion 35.20070\n314                            Orrescii                orrescii 41.61000\n315                               Orthe                   orthe 39.70851\n316                             Paestum                 paestum 40.42263\n317                            Pandosia       pandosia_bruttium 40.24435\n318                            Panormus                panormus 38.11667\n319                        Panticapaeum            panticapaeum 45.33861\n320                              Paphos                  paphus 34.75993\n321                              Parium                  parium 40.42050\n322                               Paros                   paros 37.08579\n323                              Patrae                  patrae 38.25000\n324                         Pednelissus             pednelissus 37.21375\n325                             Pelinna                 pelinna 39.84650\n326                               Pella           pella_macedon 40.76003\n327                             Pellene                 pellene 38.04321\n328                          Peparethus              peparethus 39.11667\n329                            Pergamum                pergamum 39.11667\n330                               Perge                   perge 36.96223\n331                           Perinthus               perinthus 40.97101\n332                          Peripolium              peripolium 41.32000\n333                          Perrhaebia              perrhaebia 39.75000\n334                             Petelia                 petelia 39.26606\n335                             Phacium                 phacium 39.56700\n336                            Phaestus                phaestus 35.05127\n337                          Phalasarna              phalasarna 35.50094\n338                           Phangoria              phanagoria 45.18900\n339                              Pharae                  pharae 38.36551\n340                              Pharos                  pharos 43.18429\n341                           Pharsalus               pharsalus 39.28500\n342                            Phaselis                phaselis 36.52281\n343                             Pheneus                 pheneus 37.91945\n344                            Philippi                philippi 41.01306\n345             Philisto-Arabian issues        philisto-arabian 31.58322\n346                           Phistelia               phistelia 41.11000\n347                              Phlius                  phlius 37.83166\n348                             Phocaea                 phocaea 38.67035\n349                            Pimolisa                pimolisa 41.01324\n350                             Plataea                 plataea 38.21556\n351                         Polyrhenium             polyrhenium 35.46679\n352                           Populonia               populonia 42.98944\n353                           Poseidium               poseidium 35.50743\n354                          Poseidonia              poseidonia 40.42263\n355                            Potidaea                potidaea 40.19370\n356                             Praesus                 praesus 35.14167\n357                            Priansos                priansus 35.04589\n358                              Priene                  priene 37.65972\n359                           Propontis               propontis 41.04622\n360                       Ptolemais-Ake           ace_ptolemais 32.92178\n361                               Pyxus                   pyxus 40.08385\n362                        Rash Melqart            rash_melqart 38.03825\n363                             Rhaucus                 rhaucus 35.22814\n364                             Rhegium                 rhegium 38.10928\n365                               Rhoda                   rhoda 42.26667\n366                              Rhodes                  rhodes 36.43333\n367                                Rome                    rome 41.90000\n368                            Saetabis                saetabis 38.98885\n369                          Sagalassus              sagalassus 37.68010\n370                            Saguntum                saguntum 39.68003\n371                             Salamis          salamis_attica 37.93333\n372                             Salamis          salamis_cyprus 35.17510\n373                             Salapia                 salapia 41.40338\n374                                Same                    same 38.25460\n375                               Samos                   samos 37.68944\n376                          Samothrace              samothrace 40.50256\n377                              Sardis                  sardes 38.48831\n378                             Scepsis                 scepsis 39.82554\n379                              Scione                  scione 39.93906\n380                              Scodra                  scodra 42.07428\n381                              Scyros                  scyros 38.90298\n382                             Segesta                 segesta 37.94143\n383                    Seleuceia Pieria        seleuceia_pieria 36.12445\n384             Seleuceia ad Calycadnum seleuceia_ad_calycadnum 36.38174\n385                 Seleuceia ad Tigrim     seleuceia_ad_tigrim 33.13722\n386                               Selge                   selge 37.22832\n387                             Selinus          selinus_sicily 37.58284\n388                                Serd                 serdaei 39.89393\n389                            Seriphos                seriphos 37.15570\n390                            Sermylia                 sermyle 40.29822\n391                             Sesamus                 sesamus 41.74697\n392                              Sestos                  sestus 40.22836\n393                        Siculo-Punic            siculo_punic 37.15000\n394                              Sicyon                  sicyon 37.98047\n395                                Side                    side 36.77240\n396                               Sidon                   sidon 33.56041\n397                              Sigeum                  sigeum 39.99370\n398                             Sillyum                 sillyum 36.99072\n399                              Sinope                  sinope 42.02578\n400                             Siphnos                 siphnos 36.98333\n401                               Siris                   siris 40.14904\n402                              Smyrna                  smyrna 38.42389\n403                 Soli (Pompeiopolis)       soli-pompeiopolis 36.74266\n404                                Soli             soli_cyprus 35.14040\n405                            Stageira                stageira 40.59303\n406                        Stratoniceia            stratoniceia 37.31383\n407                             Stratus                 stratus 38.67285\n408                          Stymphalus              stymphalus 37.87847\n409                      Suessa Aurunca          suessa_aurunca 41.24191\n410                                Susa                    susa 32.18922\n411                             Sybaris                 sybaris 39.75069\n412                             Sybrita                 sybrita 35.25874\n413                             Synnada                 synnada 38.53333\n414                            Syracuse                syracuse 37.08333\n415                               Syros                   syros 37.45000\n416                             Tanagra                 tanagra 38.31667\n417                               Tanus                   tanus 35.44754\n418                               Taras                   taras 40.45452\n419                              Tarsus                  tarsus 36.91667\n420                             Taulara                 taulara 40.26210\n421                         Tauromenium             tauromenium 37.85247\n422                              Taxila                  taxila 33.74569\n423                    Teanum Sidicinum        teanum_sidicinum 41.25235\n424                               Teate                   teate 42.35180\n425                               Tegea                   tegea 37.45533\n426                               Telos                   telos 36.46394\n427                              Temesa                  temesa 39.03645\n428                              Temnus                  temnus 38.67191\n429                             Tenedos                 tenedos 39.83390\n430                               Tenos                   tenos 37.53333\n431                                Teos                    teos 38.19910\n432                              Terina                  terina 38.94487\n433                     Termessus Minor         termessus_minor 36.81315\n434                           Termessus         termessus_major 36.98247\n435                              Terone                  terone 39.97628\n436                           Teucheira               teucheira 32.53540\n437                              Thasos                  thasos 40.77763\n438                              Thebae                  thebae 39.27955\n439                              Thebes                  thebes 38.31924\n440                               Thera                   thera 36.36337\n441                  Thermae Himerenses      thermae_himerenses 37.98399\n442                              Therma                  therma 40.58155\n443                            Thespiae                thespiae 38.30356\n444                        Thessalonica            thessalonica 40.63333\n445                   Thraco Macedonian       thraco-macedonian 41.24064\n446                             Thurium                 thurium 39.75069\n447                           Thyateira                thyatira 38.89852\n448                          Thyrrheium              thyrrheium 38.85492\n449                              Tiryns                  tiryns 37.59672\n450                                Tlos                    tlos 36.55389\n451                               Tomis                   tomis 44.17322\n452                             Tralles                 tralles 37.84440\n453                            Trapezus                trapezus 41.00266\n454                              Tricca                  tricca 39.56890\n455                            Tripolis      tripolis_phoenicia 34.42900\n456                             Tylisus                 tylisus 35.29507\n457                               Tyras                   tyras 46.20095\n458                                Tyre                    tyre 33.27371\n459                          Uranopolis              uranopolis 40.36357\n460                            Valentia                valentia 39.48333\n461                               Velia                   velia 40.15944\n462                           Vetulonia               vetulonia 42.85945\n463                          Volaterrae              volaterrae 43.40143\n464                              Zancle                  zancle 38.19225\n465                                 Ziz                     ziz 38.11127\n     mint_lon                                           uri\n1   14.700314                http://nomisma.org/id/aluntium\n2   24.983333           http://nomisma.org/id/abdera_thrace\n3   26.406964                  http://nomisma.org/id/abydus\n4   23.880112                http://nomisma.org/id/acanthus\n5   26.164143                 http://nomisma.org/id/achaeum\n6   26.188666              http://nomisma.org/id/achilleion\n7   30.995100                   http://nomisma.org/id/adada\n8   14.835642                 http://nomisma.org/id/adranum\n9   22.314637            http://nomisma.org/id/aegae_achaea\n10  27.174421            http://nomisma.org/id/aegae_aeolis\n11  22.313611         http://nomisma.org/id/aegae_macedonia\n12  22.377574                 http://nomisma.org/id/aegeira\n13  23.433333           http://nomisma.org/id/aegina_aegina\n14  22.081952                  http://nomisma.org/id/aegium\n15  24.928581                   http://nomisma.org/id/aenai\n16  22.879124                  http://nomisma.org/id/aeneia\n17  22.252090                http://nomisma.org/id/aenianes\n18  26.084782                   http://nomisma.org/id/aenus\n19  14.230823                http://nomisma.org/id/aesernia\n20  13.583333              http://nomisma.org/id/agrigentum\n21  27.958833                http://nomisma.org/id/alabanda\n22  26.152555       http://nomisma.org/id/alexandreia_troas\n23  29.909773       http://nomisma.org/id/alexandreia_egypt\n24  14.330592                 http://nomisma.org/id/allifae\n25  20.951657                  http://nomisma.org/id/alyzia\n26  35.827800                  http://nomisma.org/id/amasia\n27  32.385648                http://nomisma.org/id/amastris\n28  33.130332                 http://nomisma.org/id/amathus\n29  20.990258                http://nomisma.org/id/ambracia\n30  16.390000                http://nomisma.org/id/ami_naea\n31  36.331300                  http://nomisma.org/id/amisus\n32  31.266575                 http://nomisma.org/id/amorium\n33  22.956201              http://nomisma.org/id/amphaxitis\n34  23.846565              http://nomisma.org/id/amphipolis\n35  20.883333              http://nomisma.org/id/anactorium\n36  24.933333                  http://nomisma.org/id/andros\n37  26.791496               http://nomisma.org/id/antandrus\n38  36.230077        http://nomisma.org/id/antigoneia_syria\n39  28.574200 http://nomisma.org/id/antiocheia_ad_maeandrum\n40  36.150000        http://nomisma.org/id/antiocheia_syria\n41  30.166000         http://nomisma.org/id/apamea_phrygiae\n42  36.400237           http://nomisma.org/id/apameia_syria\n43  23.436606                 http://nomisma.org/id/aphytis\n44  27.696460       http://nomisma.org/id/apollonia_pontica\n45  19.466667       http://nomisma.org/id/apollonia_illyria\n46  24.149388                  http://nomisma.org/id/aptera\n47  15.475346               http://nomisma.org/id/aquilonia\n48  13.705626                 http://nomisma.org/id/aquinum\n49  35.859448                  http://nomisma.org/id/aradus\n50  25.282439           http://nomisma.org/id/arcadia_crete\n51  21.180267     http://nomisma.org/id/argos_amphilochicum\n52  22.716667           http://nomisma.org/id/argos_argolis\n53  30.488500                http://nomisma.org/id/ariassus\n54  12.566667                http://nomisma.org/id/ariminum\n55  15.555444                    http://nomisma.org/id/arpi\n56  34.545560                 http://nomisma.org/id/ascalon\n57  31.173200                http://nomisma.org/id/aspendus\n58  26.339656                   http://nomisma.org/id/assus\n59  23.722500                  http://nomisma.org/id/athens\n60  22.234955                   http://nomisma.org/id/atrax\n61  30.700300                http://nomisma.org/id/attaleia\n62  24.842019                    http://nomisma.org/id/axus\n63  44.424150                 http://nomisma.org/id/babylon\n64  66.901470                  http://nomisma.org/id/bactra\n65  20.874500                   http://nomisma.org/id/barce\n66  22.200000          http://nomisma.org/id/beroea_macedon\n67  35.521306                 http://nomisma.org/id/berytus\n68  51.581110                http://nomisma.org/id/bishapur\n69  17.938956              http://nomisma.org/id/brundisium\n70  16.250000                 http://nomisma.org/id/bruttii\n71  35.646846                  http://nomisma.org/id/byblus\n72  19.733353                  http://nomisma.org/id/byllis\n73  28.976018               http://nomisma.org/id/byzantium\n74  36.951027                 http://nomisma.org/id/cabeira\n75  26.478937                  http://nomisma.org/id/cabyle\n76  29.025789               http://nomisma.org/id/calchedon\n77  14.132176                   http://nomisma.org/id/cales\n78  28.582750                http://nomisma.org/id/callatis\n79  27.008107                 http://nomisma.org/id/calymna\n80  14.447788                http://nomisma.org/id/camarina\n81  27.921321                 http://nomisma.org/id/camirus\n82  16.067505       http://nomisma.org/id/campano-tarentine\n83  22.262624                  http://nomisma.org/id/caphya\n84  14.250357                   http://nomisma.org/id/capua\n85  26.750810                  http://nomisma.org/id/cardia\n86  -5.642257                   http://nomisma.org/id/carmo\n87  35.884375                   http://nomisma.org/id/carne\n88  39.028865                 http://nomisma.org/id/carrhae\n89  24.330211                http://nomisma.org/id/carthaea\n90  10.312944                http://nomisma.org/id/carthage\n91  24.420381                http://nomisma.org/id/carystus\n92  20.687268                 http://nomisma.org/id/cassope\n93  -3.624424                 http://nomisma.org/id/castulo\n94  15.088142                  http://nomisma.org/id/catana\n95  16.578485                http://nomisma.org/id/caulonia\n96  28.625838                  http://nomisma.org/id/caunus\n97  26.563032                  http://nomisma.org/id/cebren\n98  33.318106              http://nomisma.org/id/celenderis\n99  14.740017              http://nomisma.org/id/centuripae\n100 24.333333               http://nomisma.org/id/ceos_ceos\n101 33.361389              http://nomisma.org/id/cercinitis\n102 36.768000                http://nomisma.org/id/chabacta\n103 23.621940                 http://nomisma.org/id/chalcis\n104 47.578031         http://nomisma.org/id/charax_spasinou\n105 33.493302             http://nomisma.org/id/cherronesus\n106 27.739792      http://nomisma.org/id/chersonesus_cariae\n107 25.388567       http://nomisma.org/id/chersonesus_crete\n108 26.500000      http://nomisma.org/id/chersonesus_thrace\n109 26.136818                   http://nomisma.org/id/chios\n110 22.450621                  http://nomisma.org/id/cirrha\n111 33.629471                  http://nomisma.org/id/citium\n112 29.156390                    http://nomisma.org/id/cius\n113 26.785278              http://nomisma.org/id/clazomenae\n114 22.123335                 http://nomisma.org/id/cleitor\n115 22.775833                 http://nomisma.org/id/cleonae\n116 27.371637                  http://nomisma.org/id/cnidus\n117 25.163156                 http://nomisma.org/id/cnossus\n118 27.198000                http://nomisma.org/id/colophon\n119 30.337100                  http://nomisma.org/id/comama\n120 36.610679                  http://nomisma.org/id/comana\n121 14.327125             http://nomisma.org/id/compulteria\n122 16.450224                   http://nomisma.org/id/copia\n123 19.924457         http://nomisma.org/id/corcyra_corcyra\n124 -4.779171                 http://nomisma.org/id/corduba\n125 22.933333                 http://nomisma.org/id/corinth\n126 22.957112                http://nomisma.org/id/coroneia\n127 21.962963                  http://nomisma.org/id/corone\n128 21.159936                 http://nomisma.org/id/coronta\n129 11.286503                    http://nomisma.org/id/cosa\n130 11.950000                 http://nomisma.org/id/cossura\n131 27.290468                     http://nomisma.org/id/cos\n132 30.691100                  http://nomisma.org/id/cremna\n133 32.722092                  http://nomisma.org/id/cromna\n134 17.127080                  http://nomisma.org/id/croton\n135 14.056082                   http://nomisma.org/id/cumae\n136 24.016667                 http://nomisma.org/id/cydonia\n137 26.942154             http://nomisma.org/id/cyme_aeolis\n138 21.857270                  http://nomisma.org/id/cyrene\n139 27.892255                 http://nomisma.org/id/cyzicus\n140 36.292000                http://nomisma.org/id/damascus\n141 20.750000               http://nomisma.org/id/damastium\n142 26.374420                http://nomisma.org/id/dardanus\n143 25.269040                   http://nomisma.org/id/delos\n144 22.502106                  http://nomisma.org/id/delphi\n145 36.309102         http://nomisma.org/id/demetrias_syria\n146 21.360000                http://nomisma.org/id/derrones\n147 31.123807                     http://nomisma.org/id/dia\n148 22.947121          http://nomisma.org/id/dicaea_macedon\n149 25.165653           http://nomisma.org/id/dicaea_thrace\n150 28.162771     http://nomisma.org/id/dionysopolis_thrace\n151 41.003076              http://nomisma.org/id/dioscurias\n152 21.551425                    http://nomisma.org/id/dyme\n153 19.450000             http://nomisma.org/id/dyrrhachium\n154  1.432146                  http://nomisma.org/id/ebusus\n155 48.516247                http://nomisma.org/id/ecbatana\n156 20.910115                 http://nomisma.org/id/echinus\n157 23.855317                    http://nomisma.org/id/eion\n158 27.055256                   http://nomisma.org/id/elaea\n159 20.560388                    http://nomisma.org/id/elea\n160 23.533333                 http://nomisma.org/id/eleusis\n161 24.684822              http://nomisma.org/id/eleutherna\n162 21.375091               http://nomisma.org/id/elis_elis\n163 23.794048                  http://nomisma.org/id/elyrus\n164  3.108503                http://nomisma.org/id/emporiae\n165 14.279558                    http://nomisma.org/id/enna\n166 27.340833          http://nomisma.org/id/ephesus_ii_pco\n167 27.340833                 http://nomisma.org/id/ephesus\n168 23.160067               http://nomisma.org/id/epidaurus\n169 25.931389                  http://nomisma.org/id/eresus\n170 23.783333                 http://nomisma.org/id/eretria\n171 26.479047                http://nomisma.org/id/erythrae\n172 12.583607                    http://nomisma.org/id/eryx\n173 31.438444                  http://nomisma.org/id/etenna\n174 20.091198            http://nomisma.org/id/euhesperides\n175 22.260000                   http://nomisma.org/id/eurea\n176 28.259418                http://nomisma.org/id/euthenai\n177 -6.290000                   http://nomisma.org/id/gades\n178 27.320402                http://nomisma.org/id/gambrium\n179 26.538692                 http://nomisma.org/id/gargara\n180 34.458046                    http://nomisma.org/id/gaza\n181 36.059111                 http://nomisma.org/id/gaziura\n182 14.258219                    http://nomisma.org/id/gela\n183 26.609255                  http://nomisma.org/id/gergis\n184 50.077057                  http://nomisma.org/id/gerrha\n185 25.490000             http://nomisma.org/id/geto_dacian\n186 33.546609                   http://nomisma.org/id/golgi\n187 21.691299                  http://nomisma.org/id/gomphi\n188 37.310251               http://nomisma.org/id/gorgippia\n189 24.946944                 http://nomisma.org/id/gortyna\n190 23.100000               http://nomisma.org/id/haliartus\n191 27.417240           http://nomisma.org/id/halicarnassus\n192 13.981081                  http://nomisma.org/id/hatria\n193 54.037505            http://nomisma.org/id/hecatompylos\n194 16.678299       http://nomisma.org/id/heraclea_lucaniae\n195 31.414722       http://nomisma.org/id/heracleia_pontica\n196 22.447577     http://nomisma.org/id/heracleia_trachinia\n197 16.450000     http://nomisma.org/id/heracleia_illyricum\n198 27.524722      http://nomisma.org/id/heraclea_ad_latmum\n199 23.243591                http://nomisma.org/id/hermione\n200 37.954539      http://nomisma.org/id/hierapolis_bambyce\n201 25.740363              http://nomisma.org/id/hierapytna\n202 13.816667                  http://nomisma.org/id/himera\n203 13.432761                  http://nomisma.org/id/hipana\n204 16.097648               http://nomisma.org/id/hipponium\n205 -6.157837           http://nomisma.org/id/hispano-punic\n206 23.090527                http://nomisma.org/id/histiaea\n207 14.518000          http://nomisma.org/id/hyria_campania\n208 28.142222                 http://nomisma.org/id/ialysus\n209 27.585572                   http://nomisma.org/id/iasus\n210 22.591256                  http://nomisma.org/id/ichnae\n211  3.056709                 http://nomisma.org/id/icosium\n212 33.412994                 http://nomisma.org/id/idalium\n213 28.367319                   http://nomisma.org/id/idyma\n214  0.625790                  http://nomisma.org/id/ilerda\n215 26.238889                   http://nomisma.org/id/ilium\n216 25.903047                  http://nomisma.org/id/imbros\n217  2.196871                     http://nomisma.org/id/iol\n218 25.333333                     http://nomisma.org/id/ios\n219 30.161900                  http://nomisma.org/id/isinda\n220 16.150000                    http://nomisma.org/id/issa\n221 36.164444                   http://nomisma.org/id/issus\n222 52.915364                 http://nomisma.org/id/istakhr\n223 28.774722                  http://nomisma.org/id/istrus\n224 26.264787                  http://nomisma.org/id/itanus\n225 35.234156               http://nomisma.org/id/jerusalem\n226 34.747740                   http://nomisma.org/id/joppa\n227 30.599358                http://nomisma.org/id/ceraitae\n228  1.185439                    http://nomisma.org/id/kese\n229 22.430937              http://nomisma.org/id/lacedaemon\n230 22.442593                   http://nomisma.org/id/lamia\n231 26.699162               http://nomisma.org/id/lampsacus\n232 35.783333       http://nomisma.org/id/laodiceia_ad_mare\n233 29.136425      http://nomisma.org/id/laodiceia_ad_lycum\n234 33.202109                http://nomisma.org/id/lapethus\n235 22.416667        http://nomisma.org/id/larissa_thessaly\n236 15.824400                    http://nomisma.org/id/laus\n237 26.964722                 http://nomisma.org/id/lebedus\n238 25.250000                  http://nomisma.org/id/lemnos\n239 14.998115                http://nomisma.org/id/leontini\n240 22.978076                    http://nomisma.org/id/lete\n241 20.713116                  http://nomisma.org/id/leucas\n242 22.517809                  http://nomisma.org/id/lilaea\n243 28.083333                  http://nomisma.org/id/lindus\n244 14.953897                  http://nomisma.org/id/lipara\n245 19.636923                  http://nomisma.org/id/lissus\n246 -6.110370                     http://nomisma.org/id/lix\n247 16.259895       http://nomisma.org/id/locri_epizephyrii\n248 15.335884                 http://nomisma.org/id/luceria\n249 29.750000                  http://nomisma.org/id/lysias\n250 26.750810              http://nomisma.org/id/lysimachia\n251 25.370340                  http://nomisma.org/id/lyttus\n252 23.846565    http://nomisma.org/id/macedonia_1st_region\n253 22.956201    http://nomisma.org/id/macedonia_2nd_region\n254 27.533091   http://nomisma.org/id/magnesia_ad_maeandrum\n255 22.750000                http://nomisma.org/id/magnesia\n256 35.381298                  http://nomisma.org/id/mallus\n257 15.550000               http://nomisma.org/id/mamertini\n258 22.391896               http://nomisma.org/id/mantineia\n259 35.908186                http://nomisma.org/id/marathus\n260 32.436032                  http://nomisma.org/id/marium\n261 25.519130                http://nomisma.org/id/maroneia\n262  5.382499                http://nomisma.org/id/massalia\n263 22.128459             http://nomisma.org/id/megalopolis\n264 23.340163                  http://nomisma.org/id/megara\n265 24.423276                   http://nomisma.org/id/melos\n266 31.250917                 http://nomisma.org/id/memphis\n267 14.690940                http://nomisma.org/id/menaenum\n268 23.398060                   http://nomisma.org/id/mende\n269 27.718100               http://nomisma.org/id/mesembria\n270 15.976368                   http://nomisma.org/id/mesma\n271 15.556634                 http://nomisma.org/id/messana\n272 22.000000                 http://nomisma.org/id/messene\n273 16.822782              http://nomisma.org/id/metapontum\n274 23.349005                 http://nomisma.org/id/methana\n275 26.166667                http://nomisma.org/id/methymna\n276 21.250000    http://nomisma.org/id/metropolis_acarnania\n277 22.500000     http://nomisma.org/id/metropolis_thessaly\n278 27.278369                 http://nomisma.org/id/miletus\n279 23.650000                    http://nomisma.org/id/moda\n280 20.250000                 http://nomisma.org/id/molossi\n281 35.625744              http://nomisma.org/id/mopsuestia\n282 14.479296              http://nomisma.org/id/morgantina\n283 12.469267                   http://nomisma.org/id/motya\n284 27.783333                  http://nomisma.org/id/mylasa\n285 27.229636                  http://nomisma.org/id/myndus\n286 36.110356              http://nomisma.org/id/myriandrus\n287 26.985537           http://nomisma.org/id/myrina_aeolis\n288 26.552371                http://nomisma.org/id/mytilene\n289 32.975829                 http://nomisma.org/id/nagidus\n290 43.605000                 http://nomisma.org/id/natunia\n291 25.377595                   http://nomisma.org/id/naxos\n292 15.266688                   http://nomisma.org/id/naxus\n293 26.270341                http://nomisma.org/id/neandria\n294 14.252870       http://nomisma.org/id/neapolis_campania\n295 24.413063        http://nomisma.org/id/neapolis_macedon\n296 26.654808                   http://nomisma.org/id/nesos\n297 43.152778                 http://nomisma.org/id/nineveh\n298 41.216667                 http://nomisma.org/id/nisibis\n299 27.172056                 http://nomisma.org/id/nisyros\n300 14.528564                    http://nomisma.org/id/nola\n301 14.673929                 http://nomisma.org/id/nuceria\n302 36.417269               http://nomisma.org/id/nymphaeum\n303 28.151194                    http://nomisma.org/id/nysa\n304 27.908595                 http://nomisma.org/id/odessus\n305 21.195384                http://nomisma.org/id/oeniadae\n306 26.166667                   http://nomisma.org/id/oenoe\n307 22.288611                    http://nomisma.org/id/oeta\n308 31.901597                   http://nomisma.org/id/olbia\n309 23.342665                http://nomisma.org/id/olynthus\n310 26.343963               http://nomisma.org/id/ophrynium\n311 22.983333      http://nomisma.org/id/orchomenus_boeotia\n312 19.475022                  http://nomisma.org/id/oricus\n313 24.914000                   http://nomisma.org/id/orion\n314 23.568000                http://nomisma.org/id/orrescii\n315 22.193106                   http://nomisma.org/id/orthe\n316 15.005569                 http://nomisma.org/id/paestum\n317 16.557488       http://nomisma.org/id/pandosia_bruttium\n318 13.366667                http://nomisma.org/id/panormus\n319 36.468056            http://nomisma.org/id/panticapaeum\n320 32.407565                  http://nomisma.org/id/paphus\n321 27.069096                  http://nomisma.org/id/parium\n322 25.150728                   http://nomisma.org/id/paros\n323 21.733333                  http://nomisma.org/id/patrae\n324 30.934483             http://nomisma.org/id/pednelissus\n325 21.502991                 http://nomisma.org/id/pelinna\n326 22.525642           http://nomisma.org/id/pella_macedon\n327 22.548344                 http://nomisma.org/id/pellene\n328 23.716667              http://nomisma.org/id/peparethus\n329 27.183333                http://nomisma.org/id/pergamum\n330 30.855068                   http://nomisma.org/id/perge\n331 27.952973               http://nomisma.org/id/perinthus\n332 14.430000              http://nomisma.org/id/peripolium\n333 21.750000              http://nomisma.org/id/perrhaebia\n334 17.051080                 http://nomisma.org/id/petelia\n335 22.217000                 http://nomisma.org/id/phacium\n336 24.810922                http://nomisma.org/id/phaestus\n337 23.580383              http://nomisma.org/id/phalasarna\n338 36.825000              http://nomisma.org/id/phanagoria\n339 23.622995                  http://nomisma.org/id/pharae\n340 16.601041                  http://nomisma.org/id/pharos\n341 22.385000               http://nomisma.org/id/pharsalus\n342 30.549049                http://nomisma.org/id/phaselis\n343 22.295238                 http://nomisma.org/id/pheneus\n344 24.286389                http://nomisma.org/id/philippi\n345 34.624786        http://nomisma.org/id/philisto-arabian\n346 14.570000               http://nomisma.org/id/phistelia\n347 22.641069                  http://nomisma.org/id/phlius\n348 26.753208                 http://nomisma.org/id/phocaea\n349 34.709815                http://nomisma.org/id/pimolisa\n350 23.266944                 http://nomisma.org/id/plataea\n351 23.657098             http://nomisma.org/id/polyrhenium\n352 10.491389               http://nomisma.org/id/populonia\n353 27.214165               http://nomisma.org/id/poseidium\n354 15.005569              http://nomisma.org/id/poseidonia\n355 23.327812                http://nomisma.org/id/potidaea\n356 26.089695                 http://nomisma.org/id/praesus\n357 25.258393                http://nomisma.org/id/priansus\n358 27.297778                  http://nomisma.org/id/priene\n359 27.509766               http://nomisma.org/id/propontis\n360 35.077005           http://nomisma.org/id/ace_ptolemais\n361 15.511849                   http://nomisma.org/id/pyxus\n362 14.026402            http://nomisma.org/id/rash_melqart\n363 25.024828                 http://nomisma.org/id/rhaucus\n364 15.643930                 http://nomisma.org/id/rhegium\n365  3.166667                   http://nomisma.org/id/rhoda\n366 28.216667                  http://nomisma.org/id/rhodes\n367 12.500000                    http://nomisma.org/id/rome\n368 -0.515639                http://nomisma.org/id/saetabis\n369 30.525300              http://nomisma.org/id/sagalassus\n370 -0.278608                http://nomisma.org/id/saguntum\n371 23.500000          http://nomisma.org/id/salamis_attica\n372 33.903589          http://nomisma.org/id/salamis_cyprus\n373 15.993300                 http://nomisma.org/id/salapia\n374 20.658925                    http://nomisma.org/id/same\n375 26.943056                   http://nomisma.org/id/samos\n376 25.526069              http://nomisma.org/id/samothrace\n377 28.040286                  http://nomisma.org/id/sardes\n378 26.688003                 http://nomisma.org/id/scepsis\n379 23.574785                  http://nomisma.org/id/scione\n380 19.527653                  http://nomisma.org/id/scodra\n381 24.565356                  http://nomisma.org/id/scyros\n382 12.832490                 http://nomisma.org/id/segesta\n383 35.921192        http://nomisma.org/id/seleuceia_pieria\n384 33.927572 http://nomisma.org/id/seleuceia_ad_calycadnum\n385 44.517222     http://nomisma.org/id/seleuceia_ad_tigrim\n386 31.127926                   http://nomisma.org/id/selge\n387 12.825120          http://nomisma.org/id/selinus_sicily\n388 15.851898                 http://nomisma.org/id/serdaei\n389 24.506206                http://nomisma.org/id/seriphos\n390 23.539631                 http://nomisma.org/id/sermyle\n391 32.385648                 http://nomisma.org/id/sesamus\n392 26.417225                  http://nomisma.org/id/sestus\n393 14.150000            http://nomisma.org/id/siculo_punic\n394 22.722718                  http://nomisma.org/id/sicyon\n395 31.393400                    http://nomisma.org/id/side\n396 35.375272                   http://nomisma.org/id/sidon\n397 26.184284                  http://nomisma.org/id/sigeum\n398 30.986380                 http://nomisma.org/id/sillyum\n399 35.143037                  http://nomisma.org/id/sinope\n400 24.666667                 http://nomisma.org/id/siphnos\n401 16.541370                   http://nomisma.org/id/siris\n402 27.142778                  http://nomisma.org/id/smyrna\n403 34.537894       http://nomisma.org/id/soli-pompeiopolis\n404 32.812600             http://nomisma.org/id/soli_cyprus\n405 23.792040                http://nomisma.org/id/stageira\n406 28.059198            http://nomisma.org/id/stratoniceia\n407 21.316272                 http://nomisma.org/id/stratus\n408 22.464499              http://nomisma.org/id/stymphalus\n409 13.933756          http://nomisma.org/id/suessa_aurunca\n410 48.257785                    http://nomisma.org/id/susa\n411 16.450224                 http://nomisma.org/id/sybaris\n412 24.639291                 http://nomisma.org/id/sybrita\n413 30.550000                 http://nomisma.org/id/synnada\n414 15.283333                http://nomisma.org/id/syracuse\n415 24.900000                   http://nomisma.org/id/syros\n416 23.533333                 http://nomisma.org/id/tanagra\n417 24.200549                   http://nomisma.org/id/tanus\n418 17.270164                   http://nomisma.org/id/taras\n419 34.900000                  http://nomisma.org/id/tarsus\n420 36.552000                 http://nomisma.org/id/taulara\n421 15.292135             http://nomisma.org/id/tauromenium\n422 72.815207                  http://nomisma.org/id/taxila\n423 14.067524        http://nomisma.org/id/teanum_sidicinum\n424 14.167152                   http://nomisma.org/id/teate\n425 22.420500                   http://nomisma.org/id/tegea\n426 27.338729                   http://nomisma.org/id/telos\n427 16.159633                  http://nomisma.org/id/temesa\n428 27.196998                  http://nomisma.org/id/temnus\n429 26.069085                 http://nomisma.org/id/tenedos\n430 25.166667                   http://nomisma.org/id/tenos\n431 26.837477                    http://nomisma.org/id/teos\n432 16.238922                  http://nomisma.org/id/terina\n433 29.560692         http://nomisma.org/id/termessus_minor\n434 30.464189         http://nomisma.org/id/termessus_major\n435 23.908089                  http://nomisma.org/id/terone\n436 20.560300               http://nomisma.org/id/teucheira\n437 24.703702                  http://nomisma.org/id/thasos\n438 22.818269                  http://nomisma.org/id/thebae\n439 23.317355                  http://nomisma.org/id/thebes\n440 25.477816                   http://nomisma.org/id/thera\n441 13.696138      http://nomisma.org/id/thermae_himerenses\n442 22.944020                  http://nomisma.org/id/therma\n443 23.158322                http://nomisma.org/id/thespiae\n444 22.950000            http://nomisma.org/id/thessalonica\n445 23.252564       http://nomisma.org/id/thraco-macedonian\n446 16.450224                 http://nomisma.org/id/thurium\n447 27.849235                http://nomisma.org/id/thyatira\n448 20.980902              http://nomisma.org/id/thyrrheium\n449 22.799814                  http://nomisma.org/id/tiryns\n450 29.420789                    http://nomisma.org/id/tlos\n451 28.638299                   http://nomisma.org/id/tomis\n452 27.845800                 http://nomisma.org/id/tralles\n453 39.718172                http://nomisma.org/id/trapezus\n454 21.782998                  http://nomisma.org/id/tricca\n455 35.838776      http://nomisma.org/id/tripolis_phoenicia\n456 25.015797                 http://nomisma.org/id/tylisus\n457 30.350539                   http://nomisma.org/id/tyras\n458 35.194938                    http://nomisma.org/id/tyre\n459 23.934807              http://nomisma.org/id/uranopolis\n460 -0.366667                http://nomisma.org/id/valentia\n461 15.154444                   http://nomisma.org/id/velia\n462 10.971171               http://nomisma.org/id/vetulonia\n463 10.861106              http://nomisma.org/id/volaterrae\n464 15.556634                  http://nomisma.org/id/zancle\n465 13.353442                     http://nomisma.org/id/ziz\n\n\nCode\n# Join GeoJSON coordinates to mint_list by matching URI or mint_id\nmint_coords &lt;- mint_list %&gt;%\n  mutate(\n    mint_id_clean = str_extract(mint_uri, \"[^/]+$\")\n  ) %&gt;%\n  left_join(\n    mints_from_geojson %&gt;% dplyr::select(mint_id_from_uri, mint_lat, mint_lon),\n    by = c(\"mint_id_clean\" = \"mint_id_from_uri\")\n  )\n\n# Summary\nn_with_coords &lt;- sum(!is.na(mint_coords$mint_lat))\ncat(\"\\n✓ Mints with coordinates from GeoJSON:\", n_with_coords, \"of\", nrow(mint_coords), \n    \"(\", round(100*n_with_coords/nrow(mint_coords), 1), \"%)\\n\")\n\n\n\n✓ Mints with coordinates from GeoJSON: 4 of 14 ( 28.6 %)\n\n\nCode\n# Show mints without coordinates\nmissing_coords &lt;- mint_coords %&gt;%\n  filter(is.na(mint_lat)) %&gt;%\n  arrange(desc(n_types))\n\nif (nrow(missing_coords) &gt; 0) {\n  cat(\"\\nMints missing coordinates (top 20 by volume):\\n\")\n  print(head(missing_coords %&gt;% dplyr::select(mint_id, mint_uri, n_types), 20))\n}\n\n\n\nMints missing coordinates (top 20 by volume):\n# A tibble: 10 × 3\n   mint_id             mint_uri                                  n_types\n   &lt;chr&gt;               &lt;chr&gt;                                       &lt;int&gt;\n 1 uncertain_value     http://nomisma.org/id/uncertain_value        2263\n 2 narbo               http://nomisma.org/id/narbo                   379\n 3 italy_north_rrc     http://nomisma.org/id/italy_north_rrc         297\n 4 italy_southeast_rrc http://nomisma.org/id/italy_southeast_rrc      53\n 5 sicily2_rrc         http://nomisma.org/id/sicily2_rrc              45\n 6 italy_central_rrc   http://nomisma.org/id/italy_central_rrc        24\n 7 sicily1_rrc         http://nomisma.org/id/sicily1_rrc              12\n 8 osca                http://nomisma.org/id/osca                      4\n 9 lugdunum            http://nomisma.org/id/lugdunum                  3\n10 salpesa             http://nomisma.org/id/salpesa                   3"
  },
  {
    "objectID": "circulation_model.html#manual-coordinate-additions",
    "href": "circulation_model.html#manual-coordinate-additions",
    "title": "Roman Coin Circulation Model",
    "section": "3.4 1.4 Manual Coordinate Additions",
    "text": "3.4 1.4 Manual Coordinate Additions\n\n\nCode\n# Comprehensive manual coordinates for Roman Republican mints\n# Since Nomisma API may not return coordinates, we provide known locations\nmanual_coords &lt;- tribble(\n  ~mint_id, ~mint_lat, ~mint_lon,\n  # Rome and Italy\n  \"rome\", 41.9028, 12.4964,\n  \"roma\", 41.9028, 12.4964,\n  \"luceria\", 41.5089, 15.3350,\n  \"capua\", 41.1067, 14.2133,\n  \"croton\", 39.0811, 17.1275,\n  \"crotona\", 39.0811, 17.1275,\n  \"brundisium\", 40.6333, 17.9333,\n  \"tarentum\", 40.4667, 17.2333,\n  \"venusia\", 40.9667, 15.8167,\n  \"canusium\", 41.2167, 16.0667,\n  \"hatria\", 42.8333, 13.9833,\n  \"cales\", 41.2000, 14.2167,\n  \"suessa\", 41.2333, 13.9333,\n  \"teanum\", 41.2500, 14.0667,\n  \"aquileia\", 45.7667, 13.3667,\n  \"arretium\", 43.4633, 11.8783,\n  \"ariminum\", 44.0594, 12.5683,\n  \n  # Regional Italian\n  \"italy_north_rrc\", 45.0000, 11.0000,  # Centroid\n  \"italy_central_rrc\", 42.5000, 12.5000,\n  \"italy_southeast_rrc\", 40.5000, 17.0000,\n  \"italy_south_rrc\", 40.0000, 16.0000,\n  \n  # Sicily and Sardinia  \n  \"sicily2_rrc\", 37.5000, 14.0000,\n  \"sicily_rrc\", 37.5000, 14.0000,\n  \"syracusae\", 37.0755, 15.2866,\n  \"syracuse\", 37.0755, 15.2866,\n  \"panormus\", 38.1157, 13.3615,\n  \"lilybaeum\", 37.8000, 12.4333,\n  \"sardinia_rrc\", 40.0000, 9.0000,\n  \n  # Gaul\n  \"massalia\", 43.2965, 5.3698,\n  \"narbo\", 43.1833, 3.0000,\n  \"lugdunum\", 45.7640, 4.8357,\n  \"vienna\", 45.5167, 4.8833,\n  \"nemausus\", 43.8367, 4.3600,\n  \"gallia_rrc\", 45.0000, 3.0000,\n  \n  # Hispania\n  \"tarraco\", 41.1189, 1.2445,\n  \"carthago_nova\", 37.6000, -0.9833,\n  \"emporiae\", 42.1333, 3.1167,\n  \"emporia\", 42.1333, 3.1167,\n  \"osca\", 42.1400, -0.4083,\n  \"saguntum\", 39.6833, -0.2667,\n  \"corduba\", 37.8833, -4.7667,\n  \"hispania_rrc\", 40.0000, -3.0000,\n  \n  # Greece and Macedonia\n  \"apollonia_illyria\", 40.7167, 19.4833,\n  \"apollonia\", 40.7167, 19.4833,\n  \"dyrrhachium\", 41.3167, 19.4500,\n  \"thessalonica\", 40.6403, 22.9439,\n  \"thessaloniki\", 40.6403, 22.9439,\n  \"corinthus\", 37.9060, 22.8800,\n  \"corinth\", 37.9060, 22.8800,\n  \"athenae\", 37.9838, 23.7275,\n  \"athens\", 37.9838, 23.7275,\n  \"macedonia_rrc\", 41.0000, 22.0000,\n  \"achaea_rrc\", 38.0000, 22.0000,\n  \"greece_rrc\", 39.0000, 22.0000,\n  \n  # Asia Minor\n  \"ephesus\", 37.9394, 27.3417,\n  \"ephesos\", 37.9394, 27.3417,\n  \"pergamum\", 39.1167, 27.1833,\n  \"pergamon\", 39.1167, 27.1833,\n  \"smyrna\", 38.4192, 27.1287,\n  \"sardis\", 38.4833, 28.0333,\n  \"antioch\", 36.2000, 36.1500,\n  \"antiochia\", 36.2000, 36.1500,\n  \"asia_rrc\", 38.5000, 28.0000,\n  \n  # Africa\n  \"carthago\", 36.8528, 10.3233,\n  \"carthage\", 36.8528, 10.3233,\n  \"utica\", 37.0553, 10.0617,\n  \"cirta\", 36.3650, 6.6147,\n  \"africa_rrc\", 36.0000, 9.0000,\n  \n  # Pontus / Black Sea\n  \"amisus\", 41.7167, 36.3333,\n  \"sinope\", 42.0231, 35.1531,\n  \"pontus_rrc\", 41.0000, 36.0000,\n  \n  # Military / Moving mints\n  \"military_mint_rrc\", NA_real_, NA_real_,\n  \"moving_mint\", NA_real_, NA_real_,\n  \n  # Uncertain\n  \"uncertain\", NA_real_, NA_real_,\n  \"uncertain_value\", NA_real_, NA_real_,\n  \"unknown\", NA_real_, NA_real_\n)\n\n# Debug: show what mint_ids we have in mint_coords\ncat(\"\\nMint IDs in mint_coords:\\n\")\n\n\n\nMint IDs in mint_coords:\n\n\nCode\nprint(mint_coords$mint_id)\n\n\n [1] \"rome\"                \"uncertain_value\"     \"narbo\"              \n [4] \"italy_north_rrc\"     \"massalia\"            \"italy_southeast_rrc\"\n [7] \"sicily2_rrc\"         \"apollonia_illyria\"   \"luceria\"            \n[10] \"italy_central_rrc\"   \"sicily1_rrc\"         \"osca\"               \n[13] \"lugdunum\"            \"salpesa\"            \n\n\nCode\ncat(\"\\nSample of manual_coords:\\n\")\n\n\n\nSample of manual_coords:\n\n\nCode\nprint(head(manual_coords, 10))\n\n\n# A tibble: 10 × 3\n   mint_id    mint_lat mint_lon\n   &lt;chr&gt;         &lt;dbl&gt;    &lt;dbl&gt;\n 1 rome           41.9     12.5\n 2 roma           41.9     12.5\n 3 luceria        41.5     15.3\n 4 capua          41.1     14.2\n 5 croton         39.1     17.1\n 6 crotona        39.1     17.1\n 7 brundisium     40.6     17.9\n 8 tarentum       40.5     17.2\n 9 venusia        41.0     15.8\n10 canusium       41.2     16.1\n\n\nCode\n# Update mint_coords with manual additions where GeoJSON didn't have coordinates\n# Try matching on mint_id first, then mint_id_clean\nn_updated &lt;- 0\nfor (i in seq_len(nrow(manual_coords))) {\n  mid &lt;- manual_coords$mint_id[i]\n  mlat &lt;- manual_coords$mint_lat[i]\n  mlon &lt;- manual_coords$mint_lon[i]\n  \n  if (is.na(mlat) || is.na(mlon)) next  # Skip if manual coords are NA\n  \n  # Check if this mint exists in mint_coords\n  idx &lt;- which(mint_coords$mint_id == mid)\n  if (length(idx) == 0) {\n    # Try mint_id_clean\n    idx &lt;- which(mint_coords$mint_id_clean == mid)\n  }\n  \n  if (length(idx) &gt; 0) {\n    # Update if coords are missing\n    if (is.na(mint_coords$mint_lat[idx[1]])) {\n      mint_coords$mint_lat[idx] &lt;- mlat\n      mint_coords$mint_lon[idx] &lt;- mlon\n      n_updated &lt;- n_updated + 1\n      cat(\"  Updated:\", mid, \"-&gt;\", mlat, \",\", mlon, \"\\n\")\n    }\n  }\n}\n\n\n  Updated: italy_north_rrc -&gt; 45 , 11 \n  Updated: italy_central_rrc -&gt; 42.5 , 12.5 \n  Updated: italy_southeast_rrc -&gt; 40.5 , 17 \n  Updated: sicily2_rrc -&gt; 37.5 , 14 \n  Updated: narbo -&gt; 43.1833 , 3 \n  Updated: lugdunum -&gt; 45.764 , 4.8357 \n  Updated: osca -&gt; 42.14 , -0.4083 \n\n\nCode\ncat(\"\\nUpdated\", n_updated, \"mints from manual coordinates\\n\")\n\n\n\nUpdated 7 mints from manual coordinates\n\n\nCode\n# Add any mints from manual_coords that aren't in mint_coords at all\nexisting_ids &lt;- c(mint_coords$mint_id, mint_coords$mint_id_clean)\nexisting_ids &lt;- existing_ids[!is.na(existing_ids)]\nmissing_mints &lt;- manual_coords %&gt;%\n  filter(!mint_id %in% existing_ids, !is.na(mint_lat))\n\nif (nrow(missing_mints) &gt; 0) {\n  cat(\"\\nAdding\", nrow(missing_mints), \"new mints from manual coordinates\\n\")\n  missing_mints &lt;- missing_mints %&gt;%\n    mutate(\n      mint_uri = paste0(\"http://nomisma.org/id/\", mint_id),\n      mint_id_clean = mint_id,\n      n_types = 0,\n      n_hoards = 0\n    )\n  mint_coords &lt;- bind_rows(mint_coords, missing_mints)\n}\n\n\n\nAdding 60 new mints from manual coordinates\n\n\nCode\n# Report\nn_with_manual &lt;- sum(!is.na(mint_coords$mint_lat))\ncat(\"✓ Mints with coordinates (after manual additions):\", n_with_manual, \"of\", nrow(mint_coords), \"\\n\")\n\n\n✓ Mints with coordinates (after manual additions): 71 of 74 \n\n\nCode\n# Show which mints now have coordinates\ncat(\"\\nMints with coordinates:\\n\")\n\n\n\nMints with coordinates:\n\n\nCode\nmint_coords %&gt;%\n  filter(!is.na(mint_lat)) %&gt;%\n  dplyr::select(mint_id, mint_lat, mint_lon, n_types) %&gt;%\n  arrange(desc(n_types)) %&gt;%\n  head(20) %&gt;%\n  print()\n\n\n# A tibble: 20 × 4\n   mint_id             mint_lat mint_lon n_types\n   &lt;chr&gt;                  &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;\n 1 rome                    41.9   12.5     28177\n 2 narbo                   43.2    3         379\n 3 italy_north_rrc         45     11         297\n 4 massalia                43.3    5.38       55\n 5 italy_southeast_rrc     40.5   17          53\n 6 sicily2_rrc             37.5   14          45\n 7 apollonia_illyria       40.7   19.5        32\n 8 luceria                 41.5   15.3        25\n 9 italy_central_rrc       42.5   12.5        24\n10 osca                    42.1   -0.408       4\n11 lugdunum                45.8    4.84        3\n12 roma                    41.9   12.5         0\n13 capua                   41.1   14.2         0\n14 croton                  39.1   17.1         0\n15 crotona                 39.1   17.1         0\n16 brundisium              40.6   17.9         0\n17 tarentum                40.5   17.2         0\n18 venusia                 41.0   15.8         0\n19 canusium                41.2   16.1         0\n20 hatria                  42.8   14.0         0\n\n\nCode\n# Verify Rome\nrome_check &lt;- mint_coords %&gt;% filter(mint_id == \"rome\")\nif (nrow(rome_check) &gt; 0 && !is.na(rome_check$mint_lat[1])) {\n  cat(\"\\n✓ Rome coordinates verified:\", rome_check$mint_lat[1], \",\", rome_check$mint_lon[1], \"\\n\")\n}\n\n\n\n✓ Rome coordinates verified: 41.9 , 12.5"
  },
  {
    "objectID": "circulation_model.html#classify-mints-into-regions",
    "href": "circulation_model.html#classify-mints-into-regions",
    "title": "Roman Coin Circulation Model",
    "section": "3.5 1.5 Classify Mints into Regions",
    "text": "3.5 1.5 Classify Mints into Regions\n\n\nCode\n# Debug: check mint_coords state before classification\ncat(\"=== DEBUG: State before classification ===\\n\")\n\n\n=== DEBUG: State before classification ===\n\n\nCode\ncat(\"Mints with non-NA mint_lat:\\n\")\n\n\nMints with non-NA mint_lat:\n\n\nCode\nmint_coords %&gt;% \n  filter(!is.na(mint_lat)) %&gt;%\n  dplyr::select(mint_id, mint_lat, mint_lon, n_types) %&gt;%\n  print()\n\n\n# A tibble: 71 × 4\n   mint_id             mint_lat mint_lon n_types\n   &lt;chr&gt;                  &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;\n 1 rome                    41.9   12.5     28177\n 2 narbo                   43.2    3         379\n 3 italy_north_rrc         45     11         297\n 4 massalia                43.3    5.38       55\n 5 italy_southeast_rrc     40.5   17          53\n 6 sicily2_rrc             37.5   14          45\n 7 apollonia_illyria       40.7   19.5        32\n 8 luceria                 41.5   15.3        25\n 9 italy_central_rrc       42.5   12.5        24\n10 osca                    42.1   -0.408       4\n# ℹ 61 more rows\n\n\nCode\n# Define mint regions based on coordinates and known geography\nclassify_mint_region &lt;- function(mint_id, lat, lon) {\n  \n  # Handle missing coordinates\n if (is.na(lat) || is.na(lon)) {\n    # Try to classify by mint_id patterns\n    id_lower &lt;- tolower(mint_id)\n    \n    if (grepl(\"rome|roma\", id_lower)) return(\"ROME\")\n    if (grepl(\"hispa|spain|iberi|tarraco|carthago_nova|emporiae|osca|sagunt\", id_lower)) return(\"HISP\")\n    if (grepl(\"gaul|gall|massalia|lugdunum|narbo|vienna\", id_lower)) return(\"GALL\")\n    if (grepl(\"africa|carthag|utica|cirta|numidia\", id_lower)) return(\"AFRI\")\n    if (grepl(\"sicil|syracus|panormus|lilyb\", id_lower)) return(\"SICI\")\n    if (grepl(\"sardinia|sard\", id_lower)) return(\"SICI\")  # Group with Sicily\n    if (grepl(\"macedon|thessal|apollon|dyrr|greece|achae|corinth|athens\", id_lower)) return(\"GREC\")\n    if (grepl(\"asia|ephes|pergam|antioch|smyrna|sardis\", id_lower)) return(\"ASIA\")\n    if (grepl(\"pontus|amis|sinop|black\", id_lower)) return(\"PONT\")\n    if (grepl(\"military|moving|legionary|camp\", id_lower)) return(\"MILI\")\n    if (grepl(\"uncertain|unknown\", id_lower)) return(\"UNKN\")\n    \n    # Italian mints\n    if (grepl(\"capua|luceria|croton|venusia|brund|tarent|canusium|hatria\", id_lower)) return(\"ITAL\")\n    \n    return(\"UNKN\")\n  }\n  \n  # Classify by coordinates\n  # Rome\n  if (abs(lat - 41.9028) &lt; 0.5 && abs(lon - 12.4964) &lt; 0.5) {\n    if (grepl(\"rome|roma\", tolower(mint_id))) return(\"ROME\")\n    return(\"ITAL\")  # Other mints near Rome\n  }\n  \n  # Geographic regions\n  if (lon &lt; -2) return(\"HISP\")  # Iberia\n  if (lon &gt;= -2 && lon &lt; 5 && lat &gt; 42) return(\"GALL\")  # Gaul\n  if (lat &lt; 38 && lon &gt;= 5 && lon &lt; 15) return(\"AFRI\")  # North Africa\n  if (lon &gt;= 12 && lon &lt; 16 && lat &gt;= 36 && lat &lt; 39) return(\"SICI\")  # Sicily\n  if (lon &gt;= 6 && lon &lt; 12 && lat &gt;= 38 && lat &lt; 41) return(\"SICI\")  # Sardinia/Corsica\n  if (lon &gt;= 19 && lon &lt; 28 && lat &gt;= 35 && lat &lt; 43) return(\"GREC\")  # Greece\n  if (lon &gt;= 28 && lat &gt;= 35) return(\"ASIA\")  # Asia Minor\n  if (lon &gt;= 30 && lat &gt;= 40) return(\"PONT\")  # Pontus/Black Sea\n  if (lon &gt;= 10 && lon &lt; 19 && lat &gt;= 39 && lat &lt; 47) return(\"ITAL\")  # Italy\n  \n  return(\"UNKN\")\n}\n\n# Apply classification\nmint_coords &lt;- mint_coords %&gt;%\n  mutate(\n    mint_region = pmap_chr(list(mint_id, mint_lat, mint_lon), classify_mint_region)\n  )\n\n# Summary by region\nregion_summary &lt;- mint_coords %&gt;%\n  group_by(mint_region) %&gt;%\n  summarise(\n    n_mints = n(),\n    n_types = sum(n_types),\n    n_hoards = sum(n_hoards),\n    has_coords = sum(!is.na(mint_lat)),\n    .groups = \"drop\"\n  ) %&gt;%\n  arrange(desc(n_types))\n\ncat(\"\\nMint classification summary:\\n\")\n\n\n\nMint classification summary:\n\n\nCode\nkable(region_summary)\n\n\n\n\n\nmint_region\nn_mints\nn_types\nn_hoards\nhas_coords\n\n\n\n\nROME\n2\n28177\n490\n2\n\n\nUNKN\n6\n2321\n395\n4\n\n\nITAL\n19\n399\n234\n19\n\n\nGALL\n8\n386\n192\n8\n\n\nAFRI\n8\n45\n34\n8\n\n\nGREC\n17\n32\n27\n17\n\n\nSICI\n5\n12\n11\n4\n\n\nASIA\n7\n0\n0\n7\n\n\nHISP\n2\n0\n0\n2"
  },
  {
    "objectID": "circulation_model.html#define-production-periods-25-year-bins",
    "href": "circulation_model.html#define-production-periods-25-year-bins",
    "title": "Roman Coin Circulation Model",
    "section": "3.6 1.6 Define Production Periods (25-year bins)",
    "text": "3.6 1.6 Define Production Periods (25-year bins)\n\n\nCode\n# 25-year production periods\n# 12 breaks create 11 intervals, so we need 11 labels\nperiod_breaks &lt;- c(-Inf, -200, -175, -150, -125, -100, -75, -50, -25, 1, 14, Inf)\nperiod_labels &lt;- c(\n \"P01: pre-200\",\n  \"P02: 200-175\",\n  \"P03: 175-150\", \n  \"P04: 150-125\",\n  \"P05: 125-100\",\n  \"P06: 100-75\",\n  \"P07: 75-50\",\n  \"P08: 50-25\",\n  \"P09: 25-1 BCE\",\n  \"P10: 1-14 CE\",\n  \"P11: post-14 CE\"\n)\n\nperiod_midpoints &lt;- c(-225, -187, -162, -137, -112, -87, -62, -37, -12, 7, 25)\nnames(period_midpoints) &lt;- period_labels\n\n# Deposition periods (for TPQ)\ndeposition_breaks &lt;- c(-Inf, -150, -100, -50, 14, Inf)\ndeposition_labels &lt;- c(\"Early Republic\", \"Late Republic I\", \n                        \"Late Republic II\", \"Triumviral/Augustan\", \"Early Imperial\")"
  },
  {
    "objectID": "circulation_model.html#build-analysis-dataset",
    "href": "circulation_model.html#build-analysis-dataset",
    "title": "Roman Coin Circulation Model",
    "section": "3.7 1.7 Build Analysis Dataset",
    "text": "3.7 1.7 Build Analysis Dataset\n\n\nCode\n# First, ensure mint_coords has mint_id properly set for joining\n# The coordinates may have come from mint_id_clean (from URI), so unify them\nif (\"mint_id_clean\" %in% names(mint_coords)) {\n  # Use mint_id if available, otherwise mint_id_clean\n  mint_coords &lt;- mint_coords %&gt;%\n    mutate(mint_id = coalesce(mint_id, mint_id_clean))\n}\n\n# Debug: show what we're joining\ncat(\"Mints available for joining:\\n\")\n\n\nMints available for joining:\n\n\nCode\ncat(\"  Total mints:\", nrow(mint_coords), \"\\n\")\n\n\n  Total mints: 74 \n\n\nCode\ncat(\"  With coordinates:\", sum(!is.na(mint_coords$mint_lat)), \"\\n\")\n\n\n  With coordinates: 71 \n\n\nCode\ncat(\"  With region:\", sum(!is.na(mint_coords$mint_region)), \"\\n\")\n\n\n  With region: 74 \n\n\nCode\n# Show sample of mint_coords\ncat(\"\\nSample of mint_coords:\\n\")\n\n\n\nSample of mint_coords:\n\n\nCode\nprint(mint_coords %&gt;% \n        filter(!is.na(mint_lat)) %&gt;%\n        dplyr::select(mint_id, mint_lat, mint_lon, mint_region, n_types) %&gt;%\n        head(10))\n\n\n# A tibble: 10 × 5\n   mint_id             mint_lat mint_lon mint_region n_types\n   &lt;chr&gt;                  &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;\n 1 rome                    41.9   12.5   ROME          28177\n 2 narbo                   43.2    3     GALL            379\n 3 italy_north_rrc         45     11     ITAL            297\n 4 massalia                43.3    5.38  UNKN             55\n 5 italy_southeast_rrc     40.5   17     ITAL             53\n 6 sicily2_rrc             37.5   14     AFRI             45\n 7 apollonia_illyria       40.7   19.5   GREC             32\n 8 luceria                 41.5   15.3   ITAL             25\n 9 italy_central_rrc       42.5   12.5   ITAL             24\n10 osca                    42.1   -0.408 GALL              4\n\n\nCode\n# Parse dates and join mint info\nchrr_analysis &lt;- chrr_raw %&gt;%\n  # Parse mint dates\n  mutate(\n    mint_start = as.numeric(start_year),\n    mint_end = as.numeric(end_year),\n    mint_mid = (mint_start + mint_end) / 2,\n    tpq_year = readr::parse_number(as.character(hoard_tpq))\n  ) %&gt;%\n  filter(\n    !is.na(mint_mid),\n    !is.na(tpq_year),\n    !is.na(hoard_lat),\n    !is.na(hoard_long)\n  ) %&gt;%\n  # Assign production period\n  mutate(\n    prod_period = cut(mint_mid, breaks = period_breaks, labels = period_labels, right = TRUE),\n    depo_period = cut(tpq_year, breaks = deposition_breaks, labels = deposition_labels, right = TRUE)\n  ) %&gt;%\n  # Join mint coordinates and region\n left_join(\n    mint_coords %&gt;% dplyr::select(mint_id, mint_lat, mint_lon, mint_region),\n    by = \"mint_id\"\n  )\n\n# Debug: check join success\ncat(\"\\nJoin results:\\n\")\n\n\n\nJoin results:\n\n\nCode\ncat(\"  Records with mint_lat:\", sum(!is.na(chrr_analysis$mint_lat)), \"of\", nrow(chrr_analysis), \"\\n\")\n\n\n  Records with mint_lat: 27673 of 29871 \n\n\nCode\ncat(\"  Records with mint_region:\", sum(!is.na(chrr_analysis$mint_region)), \"\\n\")\n\n\n  Records with mint_region: 29871 \n\n\nCode\n# Show which mints didn't join\nmissing_join &lt;- chrr_analysis %&gt;%\n  filter(is.na(mint_lat)) %&gt;%\n  count(mint_id, sort = TRUE) %&gt;%\n  head(10)\nif (nrow(missing_join) &gt; 0) {\n  cat(\"\\nTop mints that didn't get coordinates:\\n\")\n  print(missing_join)\n}\n\n\n\nTop mints that didn't get coordinates:\n# A tibble: 3 × 2\n  mint_id             n\n  &lt;chr&gt;           &lt;int&gt;\n1 uncertain_value  2183\n2 sicily1_rrc        12\n3 salpesa             3\n\n\nCode\n# Now calculate distances\nchrr_analysis &lt;- chrr_analysis %&gt;%\n  mutate(\n    # Distance from mint to hoard (km)\n    delta_lon_mint = hoard_long - mint_lon,\n    delta_lat_mint = hoard_lat - mint_lat,\n    dist_from_mint_km = sqrt(\n      (delta_lon_mint * 111 * cos(mint_lat * pi/180))^2 + \n      (delta_lat_mint * 111)^2\n    ),\n    \n    # Bearing from mint to hoard\n    bearing_from_mint_rad = atan2(\n      delta_lon_mint * cos(mint_lat * pi/180), \n      delta_lat_mint\n    ),\n    bearing_from_mint_deg = (bearing_from_mint_rad * 180 / pi + 360) %% 360,\n    cos_bearing_mint = cos(bearing_from_mint_rad),\n    sin_bearing_mint = sin(bearing_from_mint_rad),\n    \n    # Distance from Rome to hoard (for comparison)\n    delta_lon_rome = hoard_long - rome_lon,\n    delta_lat_rome = hoard_lat - rome_lat,\n    dist_from_rome_km = sqrt(\n      (delta_lon_rome * 111 * cos(rome_lat * pi/180))^2 + \n      (delta_lat_rome * 111)^2\n    ),\n    \n    # Circulation age\n    circ_age = tpq_year - mint_mid\n  ) %&gt;%\n  filter(\n    !is.na(mint_region),\n    !is.na(dist_from_mint_km),\n    circ_age &gt;= 0  # Valid circulation time\n  )\n\ncat(\"✓ Analysis dataset:\", nrow(chrr_analysis), \"coin-type records\\n\")\n\n\n✓ Analysis dataset: 27641 coin-type records\n\n\nCode\ncat(\"  With mint coordinates:\", sum(!is.na(chrr_analysis$mint_lat)), \"\\n\")\n\n\n  With mint coordinates: 27641 \n\n\nCode\ncat(\"  Unique hoards:\", n_distinct(chrr_analysis$hoard_id), \"\\n\")\n\n\n  Unique hoards: 461 \n\n\nCode\ncat(\"  Unique mints:\", n_distinct(chrr_analysis$mint_id), \"\\n\")\n\n\n  Unique mints: 11"
  },
  {
    "objectID": "circulation_model.html#aggregate-to-hoard-mint-level",
    "href": "circulation_model.html#aggregate-to-hoard-mint-level",
    "title": "Roman Coin Circulation Model",
    "section": "3.8 1.8 Aggregate to Hoard-Mint Level",
    "text": "3.8 1.8 Aggregate to Hoard-Mint Level\n\n\nCode\n# Aggregate: count of each mint-region in each hoard\nhoard_mint &lt;- chrr_analysis %&gt;%\n  group_by(\n    hoard_id, hoard_lat, hoard_long, tpq_year, depo_period,\n    mint_region, mint_lat, mint_lon\n  ) %&gt;%\n  summarise(\n    n_types = n(),\n    mean_circ_age = mean(circ_age, na.rm = TRUE),\n    .groups = \"drop\"\n  ) %&gt;%\n  # Recalculate distances at aggregated level\n  mutate(\n    dist_from_mint_km = sqrt(\n      ((hoard_long - mint_lon) * 111 * cos(mint_lat * pi/180))^2 + \n      ((hoard_lat - mint_lat) * 111)^2\n    ),\n    bearing_rad = atan2(\n      (hoard_long - mint_lon) * cos(mint_lat * pi/180),\n      hoard_lat - mint_lat\n    ),\n    cos_bearing = cos(bearing_rad),\n    sin_bearing = sin(bearing_rad)\n  )\n\n# Get hoard totals\nhoard_totals &lt;- hoard_mint %&gt;%\n  group_by(hoard_id) %&gt;%\n  summarise(n_total = sum(n_types), .groups = \"drop\")\n\nhoard_mint &lt;- hoard_mint %&gt;%\n  left_join(hoard_totals, by = \"hoard_id\") %&gt;%\n  mutate(prop_mint = n_types / n_total)\n\ncat(\"✓ Hoard-mint aggregation:\", nrow(hoard_mint), \"records\\n\")\n\n\n✓ Hoard-mint aggregation: 970 records"
  },
  {
    "objectID": "circulation_model.html#map-mint-locations-by-region",
    "href": "circulation_model.html#map-mint-locations-by-region",
    "title": "Roman Coin Circulation Model",
    "section": "4.1 2.1 Map Mint Locations by Region",
    "text": "4.1 2.1 Map Mint Locations by Region\n\n\nCode\nlibrary(rnaturalearth)\nlibrary(rnaturalearthdata)\n\n# Debug: check mint_coords state at map time\ncat(\"=== DEBUG: mint_coords at map time ===\\n\")\n\n\n=== DEBUG: mint_coords at map time ===\n\n\nCode\ncat(\"Total mints:\", nrow(mint_coords), \"\\n\")\n\n\nTotal mints: 74 \n\n\nCode\ncat(\"With coordinates:\", sum(!is.na(mint_coords$mint_lat)), \"\\n\")\n\n\nWith coordinates: 71 \n\n\nCode\ncat(\"Unique regions:\", unique(mint_coords$mint_region), \"\\n\")\n\n\nUnique regions: ROME UNKN GALL ITAL AFRI GREC SICI HISP ASIA \n\n\nCode\n# Get basemap\nland &lt;- ne_countries(scale = \"medium\", returnclass = \"sf\") %&gt;% \n  st_union()\n\n# Mint locations\nmint_sf &lt;- mint_coords %&gt;%\n  filter(!is.na(mint_lat), !is.na(mint_lon)) %&gt;%\n  st_as_sf(coords = c(\"mint_lon\", \"mint_lat\"), crs = 4326, remove = FALSE)\n\ncat(\"mint_sf has\", nrow(mint_sf), \"rows\\n\")\n\n\nmint_sf has 71 rows\n\n\nCode\n# Color palette for regions\nregion_colors &lt;- c(\n  \"ROME\" = \"#E41A1C\",\n  \"ITAL\" = \"#FF7F00\",\n  \"HISP\" = \"#377EB8\",\n  \"GALL\" = \"#4DAF4A\",\n  \"AFRI\" = \"#984EA3\",\n  \"SICI\" = \"#FFFF33\",\n  \"GREC\" = \"#A65628\",\n  \"ASIA\" = \"#F781BF\",\n  \"PONT\" = \"#999999\",\n  \"MILI\" = \"#000000\",\n  \"UNKN\" = \"#CCCCCC\"\n)\n\nggplot() +\n  geom_sf(data = land, fill = \"grey95\", color = \"grey70\") +\n  geom_sf(data = mint_sf, aes(color = mint_region, size = n_types), alpha = 0.7) +\n  scale_color_manual(values = region_colors, name = \"Mint Region\") +\n  scale_size_continuous(name = \"N Types\", range = c(1, 10), trans = \"sqrt\") +\n  coord_sf(xlim = c(-10, 45), ylim = c(30, 55)) +\n  labs(\n    title = \"Mint Locations by Region\",\n    subtitle = paste(sum(!is.na(mint_coords$mint_lat)), \"mints with coordinates\")\n  ) +\n  theme_minimal() +\n  theme(axis.text = element_blank(), axis.title = element_blank())"
  },
  {
    "objectID": "circulation_model.html#production-volume-by-region-and-period",
    "href": "circulation_model.html#production-volume-by-region-and-period",
    "title": "Roman Coin Circulation Model",
    "section": "4.2 2.2 Production Volume by Region and Period",
    "text": "4.2 2.2 Production Volume by Region and Period\n\n\nCode\n# Count types by mint region and production period\nproduction &lt;- chrr_analysis %&gt;%\n  filter(mint_region != \"UNKN\") %&gt;%\n  group_by(mint_region, prod_period) %&gt;%\n  summarise(n_types = n(), .groups = \"drop\") %&gt;%\n  complete(mint_region, prod_period, fill = list(n_types = 0))\n\n# Heatmap\nggplot(production, aes(x = prod_period, y = mint_region, fill = n_types)) +\n  geom_tile(color = \"white\") +\n  geom_text(aes(label = ifelse(n_types &gt; 0, n_types, \"\")), size = 3) +\n  scale_fill_viridis_c(option = \"plasma\", name = \"N Types\", trans = \"sqrt\") +\n  labs(\n    title = \"Coin Production by Mint Region and Period\",\n    x = \"Production Period\",\n    y = \"Mint Region\"\n  ) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\n\n\n\n\n\n\nCode\n# Time series of production\nggplot(production, aes(x = prod_period, y = n_types, fill = mint_region)) +\n  geom_col(position = \"stack\") +\n  scale_fill_manual(values = region_colors, name = \"Mint Region\") +\n  labs(\n    title = \"Coin Production Over Time\",\n    x = \"Production Period\",\n    y = \"Number of Coin Types\"\n  ) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))"
  },
  {
    "objectID": "circulation_model.html#distance-distributions-by-mint-region",
    "href": "circulation_model.html#distance-distributions-by-mint-region",
    "title": "Roman Coin Circulation Model",
    "section": "4.3 2.3 Distance Distributions by Mint Region",
    "text": "4.3 2.3 Distance Distributions by Mint Region\n\n\nCode\n# Filter to regions with enough data\nmajor_regions &lt;- hoard_mint %&gt;%\n  filter(mint_region %in% c(\"ROME\", \"HISP\", \"GALL\", \"GREC\", \"ASIA\", \"ITAL\", \"SICI\")) %&gt;%\n  filter(!is.na(dist_from_mint_km))\n\nggplot(major_regions, aes(x = dist_from_mint_km, fill = mint_region)) +\n  geom_histogram(bins = 30, alpha = 0.7, color = \"white\") +\n  facet_wrap(~mint_region, scales = \"free_y\", ncol = 3) +\n  scale_fill_manual(values = region_colors) +\n  labs(\n    title = \"How Far Did Coins Travel from Their Mint?\",\n    x = \"Distance from mint (km)\",\n    y = \"Count\"\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"none\")"
  },
  {
    "objectID": "circulation_model.html#distance-vs-proportion-by-mint-region",
    "href": "circulation_model.html#distance-vs-proportion-by-mint-region",
    "title": "Roman Coin Circulation Model",
    "section": "4.4 2.4 Distance vs Proportion by Mint Region",
    "text": "4.4 2.4 Distance vs Proportion by Mint Region\n\n\nCode\nggplot(major_regions, aes(x = dist_from_mint_km, y = prop_mint)) +\n  geom_point(alpha = 0.3, size = 1) +\n  geom_smooth(method = \"glm\", method.args = list(family = \"quasibinomial\"),\n              color = \"darkred\", se = TRUE) +\n  facet_wrap(~mint_region, scales = \"free\", ncol = 3) +\n  scale_y_continuous(labels = scales::percent_format()) +\n  labs(\n    title = \"Mint Proportion vs Distance from Mint\",\n    subtitle = \"How does a mint's share decline with distance from its source?\",\n    x = \"Distance from mint (km)\",\n    y = \"Proportion of hoard from this mint\"\n  ) +\n  theme_minimal()"
  },
  {
    "objectID": "circulation_model.html#prepare-modeling-data",
    "href": "circulation_model.html#prepare-modeling-data",
    "title": "Roman Coin Circulation Model",
    "section": "5.1 3.1 Prepare Modeling Data",
    "text": "5.1 3.1 Prepare Modeling Data\n\n\nCode\n# Debug: check hoard_mint before filtering\ncat(\"=== DEBUG: hoard_mint before model filtering ===\\n\")\n\n\n=== DEBUG: hoard_mint before model filtering ===\n\n\nCode\ncat(\"Total rows:\", nrow(hoard_mint), \"\\n\")\n\n\nTotal rows: 970 \n\n\nCode\ncat(\"Unique regions:\", unique(hoard_mint$mint_region), \"\\n\")\n\n\nUnique regions: ITAL ROME GALL GREC UNKN AFRI \n\n\nCode\ncat(\"Rows by region:\\n\")\n\n\nRows by region:\n\n\nCode\nprint(table(hoard_mint$mint_region))\n\n\n\nAFRI GALL GREC ITAL ROME UNKN \n  34  181   24  225  461   45 \n\n\nCode\ncat(\"\\nRows with valid dist_from_mint_km:\", sum(!is.na(hoard_mint$dist_from_mint_km)), \"\\n\")\n\n\n\nRows with valid dist_from_mint_km: 970 \n\n\nCode\ncat(\"Rows with valid cos_bearing:\", sum(!is.na(hoard_mint$cos_bearing)), \"\\n\")\n\n\nRows with valid cos_bearing: 970 \n\n\nCode\n# Create modeling dataset with required columns\nmodel_data &lt;- hoard_mint %&gt;%\n  filter(\n    mint_region %in% c(\"ROME\", \"HISP\", \"GALL\", \"GREC\", \"ASIA\", \"ITAL\", \"SICI\", \"AFRI\"),\n    !is.na(dist_from_mint_km),\n    !is.na(cos_bearing),\n    n_total &gt;= 5  # Minimum hoard size\n  ) %&gt;%\n  mutate(\n    # Scale distance for numerical stability\n    dist_scaled = dist_from_mint_km / 1000,  # Units of 1000 km\n    \n    # Log transform for age (add 1 to avoid log(0))\n    log_circ_age = log(mean_circ_age + 1),\n    \n    # Ensure factors\n    mint_region = factor(mint_region),\n    hoard_id = factor(hoard_id)\n  )\n\ncat(\"\\n=== After filtering ===\\n\")\n\n\n\n=== After filtering ===\n\n\nCode\ncat(\"Model data:\", nrow(model_data), \"observations\\n\")\n\n\nModel data: 885 observations\n\n\nCode\ncat(\"Mint regions:\", levels(model_data$mint_region), \"\\n\")\n\n\nMint regions: AFRI GALL GREC ITAL ROME \n\n\nCode\ncat(\"Rows by region:\\n\")\n\n\nRows by region:\n\n\nCode\nprint(table(model_data$mint_region))\n\n\n\nAFRI GALL GREC ITAL ROME \n  34  180   24  224  423"
  },
  {
    "objectID": "circulation_model.html#independent-models-by-mint-region",
    "href": "circulation_model.html#independent-models-by-mint-region",
    "title": "Roman Coin Circulation Model",
    "section": "5.2 3.2 Independent Models by Mint Region",
    "text": "5.2 3.2 Independent Models by Mint Region\n\n\nCode\n# Fit separate logistic models for each mint region\nfit_region_model &lt;- function(data, region) {\n  \n  region_data &lt;- data %&gt;% filter(mint_region == region)\n  \n  if (nrow(region_data) &lt; 30) {\n    return(NULL)\n  }\n  \n  tryCatch({\n    # Fit GLM with binomial-like weights\n    model &lt;- glm(\n      prop_mint ~ dist_scaled + cos_bearing + sin_bearing,\n      data = region_data,\n      family = quasibinomial(link = \"logit\"),\n      weights = n_total\n    )\n    \n    return(model)\n  }, error = function(e) {\n    return(NULL)\n  })\n}\n\n# Fit models\nregions &lt;- unique(model_data$mint_region)\nregion_models &lt;- setNames(\n  lapply(regions, function(r) fit_region_model(model_data, r)),\n  regions\n)\n\n# Extract coefficients\nregion_coefs &lt;- map_dfr(names(region_models), function(r) {\n  model &lt;- region_models[[r]]\n  if (is.null(model)) return(NULL)\n  \n  tidy(model) %&gt;%\n    mutate(mint_region = r)\n}) %&gt;%\n  filter(!is.na(estimate))\n\n# Display distance decay coefficients\ndistance_effects &lt;- region_coefs %&gt;%\n  filter(term == \"dist_scaled\") %&gt;%\n  arrange(estimate)\n\ncat(\"\\nDistance decay coefficients by region:\\n\")\n\n\n\nDistance decay coefficients by region:\n\n\nCode\ncat(\"(More negative = stronger decay with distance)\\n\\n\")\n\n\n(More negative = stronger decay with distance)\n\n\nCode\nkable(distance_effects %&gt;% \n        dplyr::select(mint_region, estimate, std.error, p.value) %&gt;%\n        mutate(\n          or_per_1000km = exp(estimate),\n          sig = ifelse(p.value &lt; 0.05, \"*\", \"\")\n        ),\n      digits = c(0, 3, 3, 4, 3, 0),\n      col.names = c(\"Region\", \"Coefficient\", \"SE\", \"p-value\", \"OR/1000km\", \"\"))\n\n\n\n\n\nRegion\nCoefficient\nSE\np-value\nOR/1000km\n\n\n\n\n\nROME\n0.068\n0.106\n0.5186\n1.071\n\n\n\nITAL\n0.140\n0.131\n0.2848\n1.150\n\n\n\nGALL\n0.155\n0.134\n0.2476\n1.168\n\n\n\nAFRI\n0.409\n0.979\n0.6790\n1.505"
  },
  {
    "objectID": "circulation_model.html#visualize-independent-model-fits",
    "href": "circulation_model.html#visualize-independent-model-fits",
    "title": "Roman Coin Circulation Model",
    "section": "5.3 3.3 Visualize Independent Model Fits",
    "text": "5.3 3.3 Visualize Independent Model Fits\n\n\nCode\n# Create predictions for each region\npred_data &lt;- expand_grid(\n  dist_scaled = seq(0, 3, 0.1),\n  cos_bearing = 0,\n  sin_bearing = 0\n)\n\npredictions &lt;- map_dfr(names(region_models), function(r) {\n  model &lt;- region_models[[r]]\n  if (is.null(model)) return(NULL)\n  \n  preds &lt;- predict(model, newdata = pred_data, type = \"response\", se.fit = TRUE)\n  \n  pred_data %&gt;%\n    mutate(\n      mint_region = r,\n      pred = preds$fit,\n      se = preds$se.fit,\n      lower = pred - 1.96 * se,\n      upper = pred + 1.96 * se,\n      dist_km = dist_scaled * 1000\n    )\n})\n\nggplot(predictions, aes(x = dist_km, y = pred, color = mint_region, fill = mint_region)) +\n  geom_ribbon(aes(ymin = lower, ymax = upper), alpha = 0.2, color = NA) +\n  geom_line(linewidth = 1) +\n  scale_color_manual(values = region_colors) +\n  scale_fill_manual(values = region_colors) +\n  scale_y_continuous(labels = scales::percent_format(), limits = c(0, 1)) +\n  labs(\n    title = \"Distance Decay Curves by Mint Region\",\n    subtitle = \"Predicted proportion vs distance from mint of origin\",\n    x = \"Distance from mint (km)\",\n    y = \"Predicted proportion\",\n    color = \"Mint Region\",\n    fill = \"Mint Region\"\n  ) +\n  theme_minimal()"
  },
  {
    "objectID": "circulation_model.html#hierarchical-model-partial-pooling",
    "href": "circulation_model.html#hierarchical-model-partial-pooling",
    "title": "Roman Coin Circulation Model",
    "section": "5.4 3.4 Hierarchical Model (Partial Pooling)",
    "text": "5.4 3.4 Hierarchical Model (Partial Pooling)\n\n\nCode\n# Check we have enough regions for hierarchical model\nn_regions &lt;- n_distinct(model_data$mint_region)\ncat(\"Number of mint regions in model data:\", n_regions, \"\\n\")\n\n\nNumber of mint regions in model data: 5 \n\n\nCode\ncat(\"Observations per region:\\n\")\n\n\nObservations per region:\n\n\nCode\nprint(table(model_data$mint_region))\n\n\n\nAFRI GALL GREC ITAL ROME \n  34  180   24  224  423 \n\n\nCode\nif (n_regions &lt; 2) {\n  cat(\"\\n⚠ Only one mint region with data - cannot fit hierarchical model\\n\")\n  cat(\"Falling back to simple linear model\\n\")\n  \n  # Fallback: simple model without random effects\n  hierarchical_model &lt;- lm(\n    qlogis(pmax(pmin(prop_mint, 0.999), 0.001)) ~ \n      dist_scaled + cos_bearing + sin_bearing,\n    data = model_data,\n    weights = sqrt(n_total)\n  )\n  \n  use_hierarchical &lt;- FALSE\n} else {\n  # Fit mixed effects model with random slopes by mint region\n  hierarchical_model &lt;- lmer(\n    qlogis(pmax(pmin(prop_mint, 0.999), 0.001)) ~ \n      dist_scaled + cos_bearing + sin_bearing +\n      (1 + dist_scaled | mint_region),\n    data = model_data,\n    weights = sqrt(n_total),\n    control = lmerControl(optimizer = \"bobyqa\", optCtrl = list(maxfun = 100000))\n  )\n  \n  use_hierarchical &lt;- TRUE\n}\n\nsummary(hierarchical_model)\n\n\nLinear mixed model fit by REML ['lmerMod']\nFormula: \nqlogis(pmax(pmin(prop_mint, 0.999), 0.001)) ~ dist_scaled + cos_bearing +  \n    sin_bearing + (1 + dist_scaled | mint_region)\n   Data: model_data\nWeights: sqrt(n_total)\nControl: lmerControl(optimizer = \"bobyqa\", optCtrl = list(maxfun = 1e+05))\n\nREML criterion at convergence: 2896.1\n\nScaled residuals: \n     Min       1Q   Median       3Q      Max \n-2.65796 -0.63284 -0.00942  0.80317  2.97420 \n\nRandom effects:\n Groups      Name        Variance  Std.Dev. Corr\n mint_region (Intercept) 1.469e+01 3.83340      \n             dist_scaled 1.343e-04 0.01159  1.00\n Residual                1.134e+01 3.36738      \nNumber of obs: 885, groups:  mint_region, 5\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept) -2.78546    1.71681  -1.622\ndist_scaled  0.15486    0.07952   1.947\ncos_bearing -0.11323    0.07605  -1.489\nsin_bearing  0.01621    0.05164   0.314\n\nCorrelation of Fixed Effects:\n            (Intr) dst_sc cs_brn\ndist_scaled  0.026              \ncos_bearing -0.012  0.076       \nsin_bearing -0.002  0.065  0.013\noptimizer (bobyqa) convergence code: 0 (OK)\nboundary (singular) fit: see help('isSingular')"
  },
  {
    "objectID": "circulation_model.html#extract-hierarchical-coefficients",
    "href": "circulation_model.html#extract-hierarchical-coefficients",
    "title": "Roman Coin Circulation Model",
    "section": "5.5 3.5 Extract Hierarchical Coefficients",
    "text": "5.5 3.5 Extract Hierarchical Coefficients\n\n\nCode\nif (use_hierarchical) {\n  # Fixed effects (population average)\n  fixed_eff &lt;- fixef(hierarchical_model)\n  cat(\"\\nFixed effects (population average):\\n\")\n  print(fixed_eff)\n  \n  # Random effects (mint-specific deviations)\n  random_eff &lt;- ranef(hierarchical_model)$mint_region\n  cat(\"\\nRandom effects (deviations from population average):\\n\")\n  print(random_eff)\n  \n  # Combine to get mint-specific coefficients\n  hier_coefs &lt;- random_eff %&gt;%\n    rownames_to_column(\"mint_region\") %&gt;%\n    rename(\n      intercept_dev = `(Intercept)`,\n      slope_dev = dist_scaled\n    ) %&gt;%\n    mutate(\n      intercept_total = fixed_eff[\"(Intercept)\"] + intercept_dev,\n      slope_total = fixed_eff[\"dist_scaled\"] + slope_dev,\n      or_per_1000km = exp(slope_total)\n    )\n  \n  cat(\"\\nMint-specific coefficients (with partial pooling):\\n\")\n  kable(hier_coefs, digits = 3)\n  \n} else {\n  # Fallback: use coefficients from simple model\n  fixed_eff &lt;- coef(hierarchical_model)\n  cat(\"\\nFixed effects (simple model - no pooling):\\n\")\n  print(fixed_eff)\n  \n  # Create single-row hier_coefs for compatibility\n  hier_coefs &lt;- tibble(\n    mint_region = unique(model_data$mint_region)[1],\n    intercept_dev = 0,\n    slope_dev = 0,\n    intercept_total = fixed_eff[\"(Intercept)\"],\n    slope_total = fixed_eff[\"dist_scaled\"],\n    or_per_1000km = exp(fixed_eff[\"dist_scaled\"])\n  )\n  \n  cat(\"\\nNote: Only one region available, using pooled estimates\\n\")\n}\n\n\n\nFixed effects (population average):\n(Intercept) dist_scaled cos_bearing sin_bearing \n -2.7854641   0.1548551  -0.1132298   0.0162056 \n\nRandom effects (deviations from population average):\n     (Intercept)  dist_scaled\nAFRI   -1.732748 -0.005237600\nGALL   -1.481108 -0.004476966\nGREC   -2.162990 -0.006538101\nITAL   -1.457126 -0.004404474\nROME    6.833972  0.020657141\n\nMint-specific coefficients (with partial pooling):\n\n\n\n\n\n\n\n\n\n\n\n\n\nmint_region\nintercept_dev\nslope_dev\nintercept_total\nslope_total\nor_per_1000km\n\n\n\n\nAFRI\n-1.733\n-0.005\n-4.518\n0.150\n1.161\n\n\nGALL\n-1.481\n-0.004\n-4.267\n0.150\n1.162\n\n\nGREC\n-2.163\n-0.007\n-4.948\n0.148\n1.160\n\n\nITAL\n-1.457\n-0.004\n-4.243\n0.150\n1.162\n\n\nROME\n6.834\n0.021\n4.049\n0.176\n1.192"
  },
  {
    "objectID": "circulation_model.html#compare-independent-vs-hierarchical-estimates",
    "href": "circulation_model.html#compare-independent-vs-hierarchical-estimates",
    "title": "Roman Coin Circulation Model",
    "section": "5.6 3.6 Compare Independent vs Hierarchical Estimates",
    "text": "5.6 3.6 Compare Independent vs Hierarchical Estimates\n\n\nCode\nif (use_hierarchical && nrow(hier_coefs) &gt; 1) {\n  # Combine estimates\n  comparison &lt;- distance_effects %&gt;%\n    dplyr::select(mint_region, ind_estimate = estimate, ind_se = std.error) %&gt;%\n    left_join(\n      hier_coefs %&gt;% dplyr::select(mint_region, hier_estimate = slope_total),\n      by = \"mint_region\"\n    ) %&gt;%\n    filter(!is.na(hier_estimate))\n  \n  if (nrow(comparison) &gt; 1) {\n    ggplot(comparison, aes(x = ind_estimate, y = hier_estimate)) +\n      geom_abline(slope = 1, intercept = 0, linetype = \"dashed\", color = \"grey50\") +\n      geom_errorbarh(aes(xmin = ind_estimate - 1.96*ind_se, \n                         xmax = ind_estimate + 1.96*ind_se),\n                     height = 0, alpha = 0.5) +\n      geom_point(aes(color = mint_region), size = 4) +\n      geom_text(aes(label = mint_region), vjust = -1, size = 3) +\n      scale_color_manual(values = region_colors) +\n      labs(\n        title = \"Shrinkage: Independent vs Hierarchical Estimates\",\n        subtitle = \"Points closer to diagonal = less shrinkage; away = more pooling\",\n        x = \"Independent estimate (no pooling)\",\n        y = \"Hierarchical estimate (partial pooling)\"\n      ) +\n      theme_minimal() +\n      theme(legend.position = \"none\")\n  } else {\n    cat(\"Not enough regions to compare estimates\\n\")\n  }\n} else {\n  cat(\"Hierarchical model not fitted or only one region - skipping comparison plot\\n\")\n}"
  },
  {
    "objectID": "circulation_model.html#add-circulation-age-effect",
    "href": "circulation_model.html#add-circulation-age-effect",
    "title": "Roman Coin Circulation Model",
    "section": "5.7 3.7 Add Circulation Age Effect",
    "text": "5.7 3.7 Add Circulation Age Effect\n\n\nCode\nif (use_hierarchical) {\n  # Model with circulation age\n  age_model &lt;- lmer(\n    qlogis(pmax(pmin(prop_mint, 0.999), 0.001)) ~ \n      dist_scaled + cos_bearing + sin_bearing + log_circ_age +\n      (1 + dist_scaled | mint_region),\n    data = model_data %&gt;% filter(!is.na(log_circ_age)),\n    weights = sqrt(n_total),\n    control = lmerControl(optimizer = \"bobyqa\", optCtrl = list(maxfun = 100000))\n  )\n  \n  cat(\"\\nModel with circulation age:\\n\")\n  summary(age_model)\n  \n  # Compare AIC\n  cat(\"\\n\\nModel comparison:\\n\")\n  cat(\"Without age:\", AIC(hierarchical_model), \"\\n\")\n  cat(\"With age:\", AIC(age_model), \"\\n\")\n} else {\n  # Fallback: simple model with age\n  age_model &lt;- lm(\n    qlogis(pmax(pmin(prop_mint, 0.999), 0.001)) ~ \n      dist_scaled + cos_bearing + sin_bearing + log_circ_age,\n    data = model_data %&gt;% filter(!is.na(log_circ_age)),\n    weights = sqrt(n_total)\n  )\n  \n  cat(\"\\nModel with circulation age (simple, no random effects):\\n\")\n  summary(age_model)\n}\n\n\n\nModel with circulation age:\n\n\nModel comparison:\nWithout age: 2912.069 \nWith age: 2884.028"
  },
  {
    "objectID": "circulation_model.html#create-prediction-grid",
    "href": "circulation_model.html#create-prediction-grid",
    "title": "Roman Coin Circulation Model",
    "section": "6.1 4.1 Create Prediction Grid",
    "text": "6.1 4.1 Create Prediction Grid\n\n\nCode\n# Create hexagonal grid covering study area\nstudy_bbox &lt;- st_bbox(c(xmin = -10, ymin = 30, xmax = 45, ymax = 55), crs = 4326)\n\n# Project for hexagon creation\nstudy_poly &lt;- st_as_sfc(study_bbox) %&gt;% st_transform(3035)\n\nhex_grid &lt;- st_make_grid(study_poly, cellsize = 100000, square = FALSE) %&gt;%\n  st_sf(hex_id = seq_along(.), geometry = .) %&gt;%\n  st_transform(4326)\n\n# Get centroids\nhex_centroids &lt;- st_centroid(hex_grid)\ncent_coords &lt;- st_coordinates(hex_centroids)\n\nhex_grid &lt;- hex_grid %&gt;%\n  mutate(\n    cent_lon = cent_coords[, 1],\n    cent_lat = cent_coords[, 2]\n  )\n\n# Filter to land (approximate)\nland_simple &lt;- ne_countries(scale = \"medium\", returnclass = \"sf\") %&gt;%\n  filter(continent %in% c(\"Europe\", \"Africa\", \"Asia\")) %&gt;%\n  st_union() %&gt;%\n  st_simplify(dTolerance = 10000)\n\nhex_land &lt;- hex_grid %&gt;%\n  filter(lengths(st_intersects(., land_simple)) &gt; 0)\n\ncat(\"Prediction grid:\", nrow(hex_land), \"hexes\\n\")\n\n\nPrediction grid: 1461 hexes"
  },
  {
    "objectID": "circulation_model.html#compute-distances-from-each-mint-region",
    "href": "circulation_model.html#compute-distances-from-each-mint-region",
    "title": "Roman Coin Circulation Model",
    "section": "6.2 4.2 Compute Distances from Each Mint Region",
    "text": "6.2 4.2 Compute Distances from Each Mint Region\n\n\nCode\n# Get representative coordinates for each mint region\nmint_region_coords &lt;- mint_coords %&gt;%\n  filter(!is.na(mint_lat), mint_region %in% levels(model_data$mint_region)) %&gt;%\n  group_by(mint_region) %&gt;%\n  summarise(\n    region_lat = weighted.mean(mint_lat, n_types, na.rm = TRUE),\n    region_lon = weighted.mean(mint_lon, n_types, na.rm = TRUE),\n    n_mints = n(),\n    n_types = sum(n_types),\n    .groups = \"drop\"\n  )\n\ncat(\"Mint region centroids:\\n\")\n\n\nMint region centroids:\n\n\nCode\nkable(mint_region_coords, digits = 2)\n\n\n\n\n\nmint_region\nregion_lat\nregion_lon\nn_mints\nn_types\n\n\n\n\nAFRI\n37.50\n14.00\n8\n45\n\n\nGALL\n43.19\n2.98\n8\n386\n\n\nGREC\n40.72\n19.47\n17\n32\n\n\nITAL\n44.03\n12.16\n19\n399\n\n\nROME\n41.90\n12.50\n2\n28177\n\n\n\n\n\nCode\n# Compute distance from each hex to each mint region\nhex_to_mint &lt;- expand_grid(\n  hex_id = hex_land$hex_id,\n  mint_region = mint_region_coords$mint_region\n) %&gt;%\n  left_join(hex_land %&gt;% st_drop_geometry() %&gt;% dplyr::select(hex_id, cent_lon, cent_lat), \n            by = \"hex_id\") %&gt;%\n  left_join(mint_region_coords, by = \"mint_region\") %&gt;%\n  mutate(\n    delta_lon = cent_lon - region_lon,\n    delta_lat = cent_lat - region_lat,\n    dist_km = sqrt(\n      (delta_lon * 111 * cos(region_lat * pi/180))^2 +\n      (delta_lat * 111)^2\n    ),\n    dist_scaled = dist_km / 1000,\n    bearing_rad = atan2(\n      delta_lon * cos(region_lat * pi/180),\n      delta_lat\n    ),\n    cos_bearing = cos(bearing_rad),\n    sin_bearing = sin(bearing_rad)\n  )\n\ncat(\"✓ Computed distances:\", nrow(hex_to_mint), \"hex-mint pairs\\n\")\n\n\n✓ Computed distances: 7305 hex-mint pairs"
  },
  {
    "objectID": "circulation_model.html#generate-probability-surface-for-each-mint-region",
    "href": "circulation_model.html#generate-probability-surface-for-each-mint-region",
    "title": "Roman Coin Circulation Model",
    "section": "6.3 4.3 Generate Probability Surface for Each Mint Region",
    "text": "6.3 4.3 Generate Probability Surface for Each Mint Region\n\n\nCode\n# Predict using the fitted model\n# Create prediction data\nif (use_hierarchical) {\n  pred_surface &lt;- hex_to_mint %&gt;%\n    mutate(\n      # Predict linear predictor with random effects\n      eta = predict(hierarchical_model, \n                    newdata = data.frame(\n                      dist_scaled = dist_scaled,\n                      cos_bearing = cos_bearing,\n                      sin_bearing = sin_bearing,\n                      mint_region = factor(mint_region, levels = levels(model_data$mint_region))\n                    ),\n                    allow.new.levels = FALSE,\n                    re.form = NULL),  # Include random effects\n      \n      # Convert to probability\n      prob_raw = plogis(eta)\n    )\n} else {\n  # Simple model prediction (no random effects)\n  pred_surface &lt;- hex_to_mint %&gt;%\n    mutate(\n      eta = predict(hierarchical_model, \n                    newdata = data.frame(\n                      dist_scaled = dist_scaled,\n                      cos_bearing = cos_bearing,\n                      sin_bearing = sin_bearing\n                    )),\n      prob_raw = plogis(eta)\n    )\n}\n\n# Handle regions not in model\npred_surface &lt;- pred_surface %&gt;%\n  mutate(\n    prob_raw = ifelse(is.na(prob_raw), 0.01, prob_raw)  # Small baseline for missing\n  )\n\n# Get production weights (total types per region)\nproduction_weights &lt;- chrr_analysis %&gt;%\n  filter(mint_region %in% mint_region_coords$mint_region) %&gt;%\n  group_by(mint_region) %&gt;%\n  summarise(production = n(), .groups = \"drop\") %&gt;%\n  mutate(prod_weight = production / sum(production))\n\n# Add production weights\npred_surface &lt;- pred_surface %&gt;%\n  left_join(production_weights, by = \"mint_region\") %&gt;%\n  mutate(\n    weighted_prob = prob_raw * prod_weight\n  )\n\n# Normalize within each hex\npred_normalized &lt;- pred_surface %&gt;%\n  group_by(hex_id) %&gt;%\n  mutate(\n    total_prob = sum(weighted_prob),\n    expected_prop = weighted_prob / total_prob\n  ) %&gt;%\n  ungroup()\n\ncat(\"✓ Probability surface generated\\n\")\n\n\n✓ Probability surface generated"
  },
  {
    "objectID": "circulation_model.html#create-multi-layer-spatial-object",
    "href": "circulation_model.html#create-multi-layer-spatial-object",
    "title": "Roman Coin Circulation Model",
    "section": "6.4 4.4 Create Multi-Layer Spatial Object",
    "text": "6.4 4.4 Create Multi-Layer Spatial Object\n\n\nCode\n# Pivot to wide format\nprob_wide &lt;- pred_normalized %&gt;%\n  dplyr::select(hex_id, mint_region, expected_prop, dist_km) %&gt;%\n  pivot_wider(\n    id_cols = hex_id,\n    names_from = mint_region,\n    values_from = c(expected_prop, dist_km),\n    names_sep = \"_\"\n  )\n\n# Calculate summary metrics\nprob_summary &lt;- pred_normalized %&gt;%\n  group_by(hex_id) %&gt;%\n  summarise(\n    dominant_mint = mint_region[which.max(expected_prop)],\n    max_prop = max(expected_prop),\n    entropy = -sum(expected_prop * log(expected_prop + 1e-10)),\n    rome_prop = sum(expected_prop[mint_region == \"ROME\"]),\n    .groups = \"drop\"\n  )\n\n# Join to hex grid\nhex_probs &lt;- hex_land %&gt;%\n  left_join(prob_wide, by = \"hex_id\") %&gt;%\n  left_join(prob_summary, by = \"hex_id\")\n\ncat(\"✓ Multi-layer spatial object created\\n\")\n\n\n✓ Multi-layer spatial object created\n\n\nCode\ncat(\"  Columns:\", ncol(hex_probs), \"\\n\")\n\n\n  Columns: 18"
  },
  {
    "objectID": "circulation_model.html#rome-proportion-surface",
    "href": "circulation_model.html#rome-proportion-surface",
    "title": "Roman Coin Circulation Model",
    "section": "7.1 5.1 Rome Proportion Surface",
    "text": "7.1 5.1 Rome Proportion Surface\n\n\nCode\n# Rome proportion map\nggplot() +\n  geom_sf(data = land_simple, fill = \"grey95\", color = \"grey70\") +\n  geom_sf(data = hex_probs, aes(fill = expected_prop_ROME), color = NA) +\n  geom_point(data = mint_region_coords %&gt;% filter(mint_region == \"ROME\"),\n             aes(x = region_lon, y = region_lat), \n             shape = 8, size = 5, color = \"black\", stroke = 2) +\n  scale_fill_viridis_c(\n    name = \"Expected\\nRome %\",\n    option = \"plasma\",\n    labels = scales::percent_format(),\n    limits = c(0, 1)\n  ) +\n  coord_sf(xlim = c(-10, 42), ylim = c(30, 55)) +\n  labs(\n    title = \"Expected Proportion of Rome-Minted Coins\",\n    subtitle = \"Based on hierarchical diffusion model | Star = Rome\"\n  ) +\n  theme_minimal() +\n  theme(axis.text = element_blank(), axis.title = element_blank())"
  },
  {
    "objectID": "circulation_model.html#dominant-mint-map",
    "href": "circulation_model.html#dominant-mint-map",
    "title": "Roman Coin Circulation Model",
    "section": "7.2 5.2 Dominant Mint Map",
    "text": "7.2 5.2 Dominant Mint Map\n\n\nCode\nggplot() +\n  geom_sf(data = land_simple, fill = \"grey95\", color = \"grey70\") +\n  geom_sf(data = hex_probs, aes(fill = dominant_mint), color = \"white\", linewidth = 0.1) +\n  geom_point(data = mint_region_coords,\n             aes(x = region_lon, y = region_lat, color = mint_region),\n             shape = 17, size = 4) +\n  scale_fill_manual(values = region_colors, name = \"Dominant\\nMint\") +\n  scale_color_manual(values = region_colors, guide = \"none\") +\n  coord_sf(xlim = c(-10, 42), ylim = c(30, 55)) +\n  labs(\n    title = \"Dominant Mint Region by Location\",\n    subtitle = \"Which mint is expected to contribute most coins?\"\n  ) +\n  theme_minimal() +\n  theme(axis.text = element_blank(), axis.title = element_blank())"
  },
  {
    "objectID": "circulation_model.html#compositional-entropy-map",
    "href": "circulation_model.html#compositional-entropy-map",
    "title": "Roman Coin Circulation Model",
    "section": "7.3 5.3 Compositional Entropy Map",
    "text": "7.3 5.3 Compositional Entropy Map\n\n\nCode\nggplot() +\n  geom_sf(data = land_simple, fill = \"grey95\", color = \"grey70\") +\n  geom_sf(data = hex_probs, aes(fill = entropy), color = NA) +\n  geom_point(data = mint_region_coords,\n             aes(x = region_lon, y = region_lat),\n             shape = 17, size = 3, color = \"black\") +\n  scale_fill_viridis_c(\n    name = \"Entropy\",\n    option = \"viridis\"\n  ) +\n  coord_sf(xlim = c(-10, 42), ylim = c(30, 55)) +\n  labs(\n    title = \"Compositional Diversity (Entropy)\",\n    subtitle = \"Higher entropy = more mixed sources | Triangles = mint region centroids\"\n  ) +\n  theme_minimal() +\n  theme(axis.text = element_blank(), axis.title = element_blank())"
  },
  {
    "objectID": "circulation_model.html#individual-mint-surfaces",
    "href": "circulation_model.html#individual-mint-surfaces",
    "title": "Roman Coin Circulation Model",
    "section": "7.4 5.4 Individual Mint Surfaces",
    "text": "7.4 5.4 Individual Mint Surfaces\n\n\nCode\n# Create individual panels for each mint region\nmint_panels &lt;- pred_normalized %&gt;%\n  filter(mint_region %in% c(\"ROME\", \"HISP\", \"GALL\", \"GREC\", \"ASIA\", \"ITAL\")) %&gt;%\n  left_join(hex_land %&gt;% st_drop_geometry() %&gt;% dplyr::select(hex_id, cent_lon, cent_lat),\n            by = \"hex_id\")\n\n# Get hex geometries\nhex_for_plot &lt;- hex_land %&gt;%\n  inner_join(\n    pred_normalized %&gt;% \n      filter(mint_region %in% c(\"ROME\", \"HISP\", \"GALL\", \"GREC\", \"ASIA\", \"ITAL\")) %&gt;%\n      dplyr::select(hex_id, mint_region, expected_prop),\n    by = \"hex_id\"\n  )\n\nggplot() +\n  geom_sf(data = land_simple, fill = \"grey95\", color = \"grey70\") +\n  geom_sf(data = hex_for_plot, aes(fill = expected_prop), color = NA) +\n  geom_point(data = mint_region_coords %&gt;% \n               filter(mint_region %in% c(\"ROME\", \"HISP\", \"GALL\", \"GREC\", \"ASIA\", \"ITAL\")),\n             aes(x = region_lon, y = region_lat),\n             shape = 8, size = 3, color = \"black\", stroke = 1.5) +\n  facet_wrap(~mint_region, ncol = 3) +\n  scale_fill_viridis_c(\n    name = \"Expected\\nProportion\",\n    option = \"plasma\",\n    labels = scales::percent_format()\n  ) +\n  coord_sf(xlim = c(-10, 42), ylim = c(30, 55)) +\n  labs(\n    title = \"Expected Coin Proportion by Mint Region\",\n    subtitle = \"Stars = mint centroid locations\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text = element_blank(), \n    axis.title = element_blank(),\n    strip.text = element_text(size = 12, face = \"bold\")\n  )"
  },
  {
    "objectID": "circulation_model.html#mint-catchment-areas",
    "href": "circulation_model.html#mint-catchment-areas",
    "title": "Roman Coin Circulation Model",
    "section": "7.5 5.5 Mint Catchment Areas",
    "text": "7.5 5.5 Mint Catchment Areas\n\n\nCode\n# Define catchment as area where mint is dominant or &gt;20% share\ncatchment_data &lt;- pred_normalized %&gt;%\n  filter(expected_prop &gt; 0.15) %&gt;%\n  left_join(hex_land %&gt;% dplyr::select(hex_id), by = \"hex_id\")\n\ncatchment_sf &lt;- hex_land %&gt;%\n  inner_join(\n    catchment_data %&gt;% dplyr::select(hex_id, mint_region, expected_prop),\n    by = \"hex_id\"\n  )\n\nggplot() +\n  geom_sf(data = land_simple, fill = \"grey95\", color = \"grey70\") +\n  geom_sf(data = catchment_sf, aes(fill = mint_region), alpha = 0.6, color = \"white\", linewidth = 0.1) +\n  geom_point(data = mint_region_coords,\n             aes(x = region_lon, y = region_lat, color = mint_region),\n             shape = 17, size = 5) +\n  scale_fill_manual(values = region_colors, name = \"Mint Region\") +\n  scale_color_manual(values = region_colors, guide = \"none\") +\n  coord_sf(xlim = c(-10, 42), ylim = c(30, 55)) +\n  labs(\n    title = \"Mint Catchment Areas (&gt;15% expected share)\",\n    subtitle = \"Overlapping areas show competing mint influences\"\n  ) +\n  theme_minimal() +\n  theme(axis.text = element_blank(), axis.title = element_blank())"
  },
  {
    "objectID": "circulation_model.html#cross-validation",
    "href": "circulation_model.html#cross-validation",
    "title": "Roman Coin Circulation Model",
    "section": "8.1 6.1 Cross-Validation",
    "text": "8.1 6.1 Cross-Validation\n\n\nCode\n# Simple validation: compare predicted vs observed for hoards\n# Aggregate observed data to hoard level by mint region\nobserved_props &lt;- hoard_mint %&gt;%\n  filter(mint_region %in% mint_region_coords$mint_region) %&gt;%\n  group_by(hoard_id, hoard_lat, hoard_long, mint_region) %&gt;%\n  summarise(\n    observed_prop = sum(n_types) / first(n_total),\n    n_total = first(n_total),\n    .groups = \"drop\"\n  )\n\n# Find nearest hex for each hoard\nhoard_sf &lt;- observed_props %&gt;%\n  distinct(hoard_id, hoard_lat, hoard_long) %&gt;%\n  st_as_sf(coords = c(\"hoard_long\", \"hoard_lat\"), crs = 4326)\n\nhex_centroids_sf &lt;- hex_land %&gt;% st_centroid()\n\nnearest_hex &lt;- st_nearest_feature(hoard_sf, hex_centroids_sf)\nhoard_hex_map &lt;- tibble(\n  hoard_id = hoard_sf$hoard_id,\n  hex_id = hex_land$hex_id[nearest_hex]\n)\n\n# Join predictions to observations\nvalidation &lt;- observed_props %&gt;%\n  left_join(hoard_hex_map, by = \"hoard_id\") %&gt;%\n  left_join(\n    pred_normalized %&gt;% dplyr::select(hex_id, mint_region, expected_prop),\n    by = c(\"hex_id\", \"mint_region\")\n  ) %&gt;%\n  filter(!is.na(expected_prop))\n\n# Calculate metrics\nvalidation_metrics &lt;- validation %&gt;%\n  group_by(mint_region) %&gt;%\n  summarise(\n    n_obs = n(),\n    rmse = sqrt(mean((observed_prop - expected_prop)^2)),\n    mae = mean(abs(observed_prop - expected_prop)),\n    cor = cor(observed_prop, expected_prop, use = \"complete.obs\"),\n    .groups = \"drop\"\n  )\n\ncat(\"\\nValidation metrics by mint region:\\n\")\n\n\n\nValidation metrics by mint region:\n\n\nCode\nkable(validation_metrics, digits = 3)\n\n\n\n\n\nmint_region\nn_obs\nrmse\nmae\ncor\n\n\n\n\nAFRI\n34\n0.056\n0.035\n-0.095\n\n\nGALL\n175\n0.050\n0.028\n0.147\n\n\nGREC\n24\n0.019\n0.014\n-0.233\n\n\nITAL\n195\n0.061\n0.036\n0.045\n\n\nROME\n461\n0.063\n0.030\n-0.019"
  },
  {
    "objectID": "circulation_model.html#observed-vs-predicted-plot",
    "href": "circulation_model.html#observed-vs-predicted-plot",
    "title": "Roman Coin Circulation Model",
    "section": "8.2 6.2 Observed vs Predicted Plot",
    "text": "8.2 6.2 Observed vs Predicted Plot\n\n\nCode\nggplot(validation %&gt;% filter(mint_region %in% c(\"ROME\", \"HISP\", \"GREC\", \"GALL\")), \n       aes(x = expected_prop, y = observed_prop)) +\n  geom_abline(slope = 1, intercept = 0, linetype = \"dashed\", color = \"grey50\") +\n  geom_point(alpha = 0.3, size = 1) +\n  geom_smooth(method = \"lm\", color = \"darkred\", se = TRUE) +\n  facet_wrap(~mint_region, scales = \"free\") +\n  scale_x_continuous(labels = scales::percent_format()) +\n  scale_y_continuous(labels = scales::percent_format()) +\n  labs(\n    title = \"Observed vs Predicted Mint Proportions\",\n    subtitle = \"Dashed line = perfect prediction; red line = actual fit\",\n    x = \"Predicted proportion (from model)\",\n    y = \"Observed proportion (in hoards)\"\n  ) +\n  theme_minimal()"
  },
  {
    "objectID": "circulation_model.html#residual-mapping",
    "href": "circulation_model.html#residual-mapping",
    "title": "Roman Coin Circulation Model",
    "section": "8.3 6.3 Residual Mapping",
    "text": "8.3 6.3 Residual Mapping\n\n\nCode\n# Calculate residuals for Rome - get coordinates from hoard_mint\nrome_residuals &lt;- validation %&gt;%\n  filter(mint_region == \"ROME\") %&gt;%\n  mutate(residual = observed_prop - expected_prop)\n\n# Check if we have hoard_lat in validation, if not join it\nif (!\"hoard_lat\" %in% names(rome_residuals)) {\n  rome_residuals &lt;- rome_residuals %&gt;%\n    left_join(\n      hoard_mint %&gt;% \n        distinct(hoard_id, hoard_lat, hoard_long),\n      by = \"hoard_id\"\n    )\n}\n\nrome_resid_sf &lt;- rome_residuals %&gt;%\n  filter(!is.na(hoard_lat), !is.na(hoard_long)) %&gt;%\n  st_as_sf(coords = c(\"hoard_long\", \"hoard_lat\"), crs = 4326)\n\nif (nrow(rome_resid_sf) &gt; 0) {\n  ggplot() +\n    geom_sf(data = land_simple, fill = \"grey95\", color = \"grey70\") +\n    geom_sf(data = rome_resid_sf, aes(color = residual), size = 2, alpha = 0.7) +\n    scale_color_gradient2(\n      name = \"Residual\\n(Obs - Pred)\",\n      low = \"blue\", mid = \"white\", high = \"red\",\n      midpoint = 0,\n      limits = c(-0.5, 0.5),\n      oob = scales::squish\n    ) +\n    coord_sf(xlim = c(-10, 42), ylim = c(30, 55)) +\n    labs(\n      title = \"Rome Proportion Residuals\",\n      subtitle = \"Red = more Rome coins than expected | Blue = fewer than expected\"\n    ) +\n    theme_minimal() +\n    theme(axis.text = element_blank(), axis.title = element_blank())\n} else {\n  cat(\"No Rome residuals to map\\n\")\n}"
  },
  {
    "objectID": "circulation_model.html#identify-anomalous-hoards",
    "href": "circulation_model.html#identify-anomalous-hoards",
    "title": "Roman Coin Circulation Model",
    "section": "8.4 6.4 Identify Anomalous Hoards",
    "text": "8.4 6.4 Identify Anomalous Hoards\n\n\nCode\n# Find hoards with large residuals\nanomalies &lt;- validation %&gt;%\n  filter(mint_region == \"ROME\") %&gt;%\n  mutate(residual = observed_prop - expected_prop) %&gt;%\n  filter(abs(residual) &gt; 0.3) %&gt;%\n  arrange(desc(abs(residual)))\n\ncat(\"\\nAnomalous hoards (Rome residual &gt; 0.3):\\n\")\n\n\n\nAnomalous hoards (Rome residual &gt; 0.3):\n\n\nCode\ncat(\"These may represent military pay, emergency hoards, or unusual circulation patterns\\n\\n\")\n\n\nThese may represent military pay, emergency hoards, or unusual circulation patterns\n\n\nCode\nif (nrow(anomalies) &gt; 0) {\n  kable(head(anomalies %&gt;% \n               dplyr::select(hoard_id, observed_prop, expected_prop, residual, n_total), 20),\n        digits = 3,\n        col.names = c(\"Hoard ID\", \"Observed Rome %\", \"Expected Rome %\", \"Residual\", \"N Types\"))\n} else {\n  cat(\"No hoards with residuals &gt; 0.3\\n\")\n}\n\n\n\n\n\nHoard ID\nObserved Rome %\nExpected Rome %\nResidual\nN Types\n\n\n\n\nPTS\n0.500\n0.999\n-0.499\n2\n\n\nCUP\n0.556\n0.999\n-0.444\n27\n\n\nFAN\n0.611\n1.000\n-0.388\n18\n\n\nNUM\n0.667\n1.000\n-0.333\n15\n\n\nFRC\n0.667\n1.000\n-0.333\n12\n\n\nCSN\n0.667\n1.000\n-0.333\n12\n\n\nSCM\n0.667\n0.999\n-0.333\n21"
  },
  {
    "objectID": "circulation_model.html#comparison-with-hmm-regimes",
    "href": "circulation_model.html#comparison-with-hmm-regimes",
    "title": "Roman Coin Circulation Model",
    "section": "8.5 6.5 Comparison with HMM Regimes",
    "text": "8.5 6.5 Comparison with HMM Regimes\n\n\nCode\n# Compare predictions across regimes (using deposition period as proxy)\nregime_validation &lt;- hoard_mint %&gt;%\n  filter(mint_region == \"ROME\", !is.na(depo_period)) %&gt;%\n  left_join(hoard_hex_map, by = \"hoard_id\") %&gt;%\n  left_join(\n    pred_normalized %&gt;% \n      filter(mint_region == \"ROME\") %&gt;% \n      dplyr::select(hex_id, expected_prop),\n    by = \"hex_id\"\n  ) %&gt;%\n  filter(!is.na(expected_prop))\n\nregime_summary &lt;- regime_validation %&gt;%\n  group_by(depo_period) %&gt;%\n  summarise(\n    n_hoards = n_distinct(hoard_id),\n    mean_observed = mean(prop_mint),\n    mean_predicted = mean(expected_prop),\n    rmse = sqrt(mean((prop_mint - expected_prop)^2)),\n    .groups = \"drop\"\n  )\n\ncat(\"\\nModel performance by deposition period:\\n\")\n\n\n\nModel performance by deposition period:\n\n\nCode\nkable(regime_summary, digits = 3,\n      col.names = c(\"Period\", \"N Hoards\", \"Mean Observed\", \"Mean Predicted\", \"RMSE\"))\n\n\n\n\n\nPeriod\nN Hoards\nMean Observed\nMean Predicted\nRMSE\n\n\n\n\nEarly Republic\n11\n0.787\n1.000\n0.272\n\n\nLate Republic I\n87\n0.973\n0.999\n0.053\n\n\nLate Republic II\n166\n0.970\n1.000\n0.054\n\n\nTriumviral/Augustan\n197\n0.978\n1.000\n0.037"
  },
  {
    "objectID": "circulation_model.html#key-findings",
    "href": "circulation_model.html#key-findings",
    "title": "Roman Coin Circulation Model",
    "section": "9.1 Key Findings",
    "text": "9.1 Key Findings\n\n\nCode\ncat(\"\n================================================================\nROMAN COIN CIRCULATION MODEL: SUMMARY\n================================================================\n\n1. MINT REGIONS CLASSIFIED\n\")\n\n\n\n================================================================\nROMAN COIN CIRCULATION MODEL: SUMMARY\n================================================================\n\n1. MINT REGIONS CLASSIFIED\n\n\nCode\ncat(\"   Total mints:\", nrow(mint_coords), \"\\n\")\n\n\n   Total mints: 74 \n\n\nCode\ncat(\"   With coordinates:\", sum(!is.na(mint_coords$mint_lat)), \"\\n\")\n\n\n   With coordinates: 71 \n\n\nCode\ncat(\"   Regions:\", paste(unique(mint_coords$mint_region), collapse = \", \"), \"\\n\")\n\n\n   Regions: ROME, UNKN, GALL, ITAL, AFRI, GREC, SICI, HISP, ASIA \n\n\nCode\ncat(\"\n2. DIFFUSION PARAMETERS\n\")\n\n\n\n2. DIFFUSION PARAMETERS\n\n\nCode\nif (use_hierarchical) {\n  cat(\"   Model type: Hierarchical (partial pooling)\\n\")\n  cat(\"   Population-level distance decay:\", round(fixef(hierarchical_model)[\"dist_scaled\"], 3), \"\\n\")\n} else {\n  cat(\"   Model type: Simple (no pooling - single region only)\\n\")\n  cat(\"   Distance decay:\", round(coef(hierarchical_model)[\"dist_scaled\"], 3), \"\\n\")\n}\n\n\n   Model type: Hierarchical (partial pooling)\n   Population-level distance decay: 0.155 \n\n\nCode\ncat(\"   (More negative = faster decay with distance)\\n\")\n\n\n   (More negative = faster decay with distance)\n\n\nCode\ncat(\"\n3. MINT-SPECIFIC DECAY RATES\n\")\n\n\n\n3. MINT-SPECIFIC DECAY RATES\n\n\nCode\nif (use_hierarchical && exists(\"random_eff\") && nrow(random_eff) &gt; 0) {\n  for (r in rownames(random_eff)) {\n    total_slope &lt;- fixed_eff[\"dist_scaled\"] + random_eff[r, \"dist_scaled\"]\n    cat(\"   \", r, \":\", round(total_slope, 3), \"\\n\")\n  }\n} else {\n  cat(\"   Single pooled estimate used for all regions\\n\")\n}\n\n\n    AFRI : 0.15 \n    GALL : 0.15 \n    GREC : 0.148 \n    ITAL : 0.15 \n    ROME : 0.176 \n\n\nCode\ncat(\"\n4. VALIDATION\n\")\n\n\n\n4. VALIDATION\n\n\nCode\nrome_validation &lt;- validation %&gt;% filter(mint_region == \"ROME\")\nif (nrow(rome_validation) &gt; 0) {\n  cat(\"   Overall correlation (Rome):\", \n      round(cor(rome_validation$observed_prop,\n                rome_validation$expected_prop, \n                use = \"complete.obs\"), 3), \"\\n\")\n} else {\n  cat(\"   No Rome validation data available\\n\")\n}\n\n\n   Overall correlation (Rome): -0.019 \n\n\nCode\ncat(\"\n5. OUTPUTS GENERATED\n   - Probability surfaces for each mint region\n   - Dominant mint map\n   - Compositional entropy map\n   - Catchment area visualization\n   - Residual analysis identifying anomalous hoards\n\n================================================================\n\")\n\n\n\n5. OUTPUTS GENERATED\n   - Probability surfaces for each mint region\n   - Dominant mint map\n   - Compositional entropy map\n   - Catchment area visualization\n   - Residual analysis identifying anomalous hoards\n\n================================================================"
  },
  {
    "objectID": "circulation_model.html#a.1-adding-circulation-decay",
    "href": "circulation_model.html#a.1-adding-circulation-decay",
    "title": "Roman Coin Circulation Model",
    "section": "12.1 A.1 Adding Circulation Decay",
    "text": "12.1 A.1 Adding Circulation Decay\nTo model withdrawal from circulation, add a decay term:\n\\[w(t - \\tau) = e^{-\\lambda(t - \\tau)}\\]\nWhere \\(\\lambda\\) is the withdrawal rate. This can be estimated by adding an age term to the model:\n# With decay\ndecay_model &lt;- lmer(\n  qlogis(prop_mint) ~ \n    dist_scaled + cos_bearing + sin_bearing + \n    I(-log_circ_age * lambda) +  # Decay term\n    (1 + dist_scaled | mint_region),\n  data = model_data\n)"
  },
  {
    "objectID": "circulation_model.html#a.2-time-varying-probability-surfaces",
    "href": "circulation_model.html#a.2-time-varying-probability-surfaces",
    "title": "Roman Coin Circulation Model",
    "section": "12.2 A.2 Time-Varying Probability Surfaces",
    "text": "12.2 A.2 Time-Varying Probability Surfaces\nTo generate surfaces for specific time periods, filter the production data:\n# Surface for hoards deposited 50-25 BCE\nsurface_P08 &lt;- generate_surface(\n  production_data %&gt;% filter(prod_period &lt;= \"P08\"),\n  deposition_time = -37  # Midpoint of period\n)"
  },
  {
    "objectID": "circulation_model.html#a.3-bayesian-implementation-with-brms",
    "href": "circulation_model.html#a.3-bayesian-implementation-with-brms",
    "title": "Roman Coin Circulation Model",
    "section": "12.3 A.3 Bayesian Implementation with brms",
    "text": "12.3 A.3 Bayesian Implementation with brms\nFor full uncertainty quantification:\nbrm(\n  n_mint | trials(n_total) ~ \n    dist_scaled + cos_bearing + sin_bearing +\n    (1 + dist_scaled | mint_region),\n  family = binomial(),\n  data = model_data,\n  prior = c(\n    prior(normal(0, 2), class = \"b\"),\n    prior(exponential(1), class = \"sd\")\n  ),\n  chains = 4, cores = 4, iter = 2000\n)\nThis would provide posterior predictive intervals on all probability surfaces."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "master_proposal.html",
    "href": "master_proposal.html",
    "title": "Proposal",
    "section": "",
    "text": "1 Introduction\nEvidence for the circulation in Roman coinage is inherently incomplete and spatially inconsistent, but it has long been used in the discussions of economic connectivity. Unfortunately, direct observations of coin movement do not survive, and any evidence that does survive is shaped by depositional and recovery biases.\n\nCan probabilistic spatial models identify latent circulation regimes in ancient monetary systems from incomplete archaeological evidence?"
  },
  {
    "objectID": "lrr_compositional.html",
    "href": "lrr_compositional.html",
    "title": "Compositional Log-Relative Risk Analysis",
    "section": "",
    "text": "The initial diagnostic analysis revealed:\n\n\n\nMetric\nValue\n\n\n\n\nHoards containing Rome coins\n99.4%\n\n\nHoards without ANY Rome coins\n3\n\n\n\nWith only 3 hoards lacking Rome coins, the binary contrast (Rome-containing vs. all hoards) collapsed—numerator ≈ denominator everywhere, producing LRR ≈ 0.\n\n\n\nHowever, the diagnostics also revealed exploitable variation:\n\nRome share within hoards varies from 0% to 100% (mean 88%, SD ~15%)\nDistance-decay signal: Rome proportion declines beyond 2000 km\n80% of hoards contain non-Rome coins: compositional diversity exists\n\nThe compositional approach asks: Where is the proportion of Rome-minted coins higher or lower than the global average?\n\\[\\text{LRR}_{\\text{comp}}(s) = \\log \\left( \\frac{p_{\\text{Rome}}(s)}{p_{\\text{Rome}}^{\\text{global}}} \\right)\\]\nwhere \\(p_{\\text{Rome}}(s)\\) is the proportion of Rome coins in spatial unit \\(s\\)."
  },
  {
    "objectID": "lrr_compositional.html#why-binary-lrr-failed",
    "href": "lrr_compositional.html#why-binary-lrr-failed",
    "title": "Compositional Log-Relative Risk Analysis",
    "section": "",
    "text": "The initial diagnostic analysis revealed:\n\n\n\nMetric\nValue\n\n\n\n\nHoards containing Rome coins\n99.4%\n\n\nHoards without ANY Rome coins\n3\n\n\n\nWith only 3 hoards lacking Rome coins, the binary contrast (Rome-containing vs. all hoards) collapsed—numerator ≈ denominator everywhere, producing LRR ≈ 0."
  },
  {
    "objectID": "lrr_compositional.html#what-compositional-lrr-captures",
    "href": "lrr_compositional.html#what-compositional-lrr-captures",
    "title": "Compositional Log-Relative Risk Analysis",
    "section": "",
    "text": "However, the diagnostics also revealed exploitable variation:\n\nRome share within hoards varies from 0% to 100% (mean 88%, SD ~15%)\nDistance-decay signal: Rome proportion declines beyond 2000 km\n80% of hoards contain non-Rome coins: compositional diversity exists\n\nThe compositional approach asks: Where is the proportion of Rome-minted coins higher or lower than the global average?\n\\[\\text{LRR}_{\\text{comp}}(s) = \\log \\left( \\frac{p_{\\text{Rome}}(s)}{p_{\\text{Rome}}^{\\text{global}}} \\right)\\]\nwhere \\(p_{\\text{Rome}}(s)\\) is the proportion of Rome coins in spatial unit \\(s\\)."
  },
  {
    "objectID": "lrr_compositional.html#flag-rome-vs.-non-rome-at-row-level",
    "href": "lrr_compositional.html#flag-rome-vs.-non-rome-at-row-level",
    "title": "Compositional Log-Relative Risk Analysis",
    "section": "4.1 Flag Rome vs. Non-Rome at Row Level",
    "text": "4.1 Flag Rome vs. Non-Rome at Row Level\n\n\nCode\nchrr_flagged &lt;- chrr_raw %&gt;%\n  mutate(\n    is_rome = mint_id == \"rome\" | str_detect(mint_uri, \"/id/rome$\"),\n    is_rome = replace_na(is_rome, FALSE)\n  )\n\n# Global composition\nglobal_comp &lt;- chrr_flagged %&gt;%\n  summarise(\n    total_rows = n(),\n    rome_rows = sum(is_rome),\n    non_rome_rows = sum(!is_rome),\n    p_rome_global = rome_rows / total_rows\n  )\n\nkable(global_comp, \n      digits = c(0, 0, 0, 4),\n      caption = \"Global composition (row-level)\")\n\n\n\nGlobal composition (row-level)\n\n\ntotal_rows\nrome_rows\nnon_rome_rows\np_rome_global\n\n\n\n\n31951\n28177\n3774\n0.8819\n\n\n\n\n\nCode\np_global &lt;- global_comp$p_rome_global\ncat(\"\\nGlobal Rome proportion:\", round(p_global * 100, 2), \"%\\n\")\n\n\n\nGlobal Rome proportion: 88.19 %"
  },
  {
    "objectID": "lrr_compositional.html#aggregate-to-hoard-level",
    "href": "lrr_compositional.html#aggregate-to-hoard-level",
    "title": "Compositional Log-Relative Risk Analysis",
    "section": "4.2 Aggregate to Hoard Level",
    "text": "4.2 Aggregate to Hoard Level\n\n\nCode\nhoard_comp &lt;- chrr_flagged %&gt;%\n  group_by(hoard_id, hoard_lat, hoard_long) %&gt;%\n  summarise(\n    n_types = n(),\n    n_rome = sum(is_rome),\n    n_non_rome = sum(!is_rome),\n    p_rome = n_rome / n_types,\n    .groups = \"drop\"\n  ) %&gt;%\n  filter(!is.na(hoard_lat), !is.na(hoard_long))\n\ncat(\"Hoards with valid coordinates:\", nrow(hoard_comp), \"\\n\")\n\n\nHoards with valid coordinates: 466 \n\n\nCode\n# Summary of hoard-level Rome proportions\nhoard_summary &lt;- hoard_comp %&gt;%\n  summarise(\n    n_hoards = n(),\n    mean_p_rome = mean(p_rome),\n    sd_p_rome = sd(p_rome),\n    min_p_rome = min(p_rome),\n    q25_p_rome = quantile(p_rome, 0.25),\n    median_p_rome = median(p_rome),\n    q75_p_rome = quantile(p_rome, 0.75),\n    max_p_rome = max(p_rome)\n  )\n\nkable(hoard_summary, \n      digits = 3,\n      caption = \"Rome proportion within hoards: summary statistics\")\n\n\n\nRome proportion within hoards: summary statistics\n\n\n\n\n\n\n\n\n\n\n\n\nn_hoards\nmean_p_rome\nsd_p_rome\nmin_p_rome\nq25_p_rome\nmedian_p_rome\nq75_p_rome\nmax_p_rome\n\n\n\n\n466\n0.881\n0.154\n0\n0.857\n0.932\n0.97\n1"
  },
  {
    "objectID": "lrr_compositional.html#convert-to-spatial-object",
    "href": "lrr_compositional.html#convert-to-spatial-object",
    "title": "Compositional Log-Relative Risk Analysis",
    "section": "4.3 Convert to Spatial Object",
    "text": "4.3 Convert to Spatial Object\n\n\nCode\nhoard_sf &lt;- st_as_sf(\n\n  hoard_comp,\n  coords = c(\"hoard_long\", \"hoard_lat\"),\n  crs = 4326,\n  remove = FALSE\n)\n\ncat(\"Spatial object created with\", nrow(hoard_sf), \"hoards\\n\")\n\n\nSpatial object created with 466 hoards"
  },
  {
    "objectID": "lrr_compositional.html#define-study-window",
    "href": "lrr_compositional.html#define-study-window",
    "title": "Compositional Log-Relative Risk Analysis",
    "section": "5.1 Define Study Window",
    "text": "5.1 Define Study Window\n\n\nCode\nlibrary(rnaturalearth)\nlibrary(rnaturalearthdata)\n\n# Get land polygons\nland &lt;- ne_countries(scale = \"medium\", returnclass = \"sf\") %&gt;%\n  st_union()\n\n# Filter valid geometries\nhoard_sf_valid &lt;- hoard_sf %&gt;%\n  filter(!st_is_empty(geometry))\n\n# Bounding box\nhoard_bbox &lt;- st_bbox(hoard_sf_valid)\n\nif (any(is.na(hoard_bbox))) {\n  hoard_bbox &lt;- c(xmin = -10, ymin = 30, xmax = 45, ymax = 55)\n  names(hoard_bbox) &lt;- c(\"xmin\", \"ymin\", \"xmax\", \"ymax\")\n}\n\npad &lt;- 2\n\n# Create study extent\nstudy_extent &lt;- st_polygon(list(rbind(\n  c(hoard_bbox[\"xmin\"] - pad, hoard_bbox[\"ymin\"] - pad),\n  c(hoard_bbox[\"xmax\"] + pad, hoard_bbox[\"ymin\"] - pad),\n  c(hoard_bbox[\"xmax\"] + pad, hoard_bbox[\"ymax\"] + pad),\n  c(hoard_bbox[\"xmin\"] - pad, hoard_bbox[\"ymax\"] + pad),\n  c(hoard_bbox[\"xmin\"] - pad, hoard_bbox[\"ymin\"] - pad)\n))) %&gt;%\n  st_sfc(crs = 4326)\n\nstudy_land &lt;- st_intersection(land, study_extent)\n\ncat(\"Study window: [\", \n    round(hoard_bbox[\"xmin\"] - pad, 1), \",\", \n    round(hoard_bbox[\"xmax\"] + pad, 1), \"] x [\",\n    round(hoard_bbox[\"ymin\"] - pad, 1), \",\",\n    round(hoard_bbox[\"ymax\"] + pad, 1), \"]\\n\")\n\n\nStudy window: [ -11.1 , 49.1 ] x [ 33.3 , 54.9 ]\n\n\nCode\nhoard_sf &lt;- hoard_sf_valid"
  },
  {
    "objectID": "lrr_compositional.html#project-to-equal-area-crs",
    "href": "lrr_compositional.html#project-to-equal-area-crs",
    "title": "Compositional Log-Relative Risk Analysis",
    "section": "5.2 Project to Equal-Area CRS",
    "text": "5.2 Project to Equal-Area CRS\n\n\nCode\ntarget_crs &lt;- 3035  # ETRS89-extended / LAEA Europe\n\nhoard_sf_proj &lt;- st_transform(hoard_sf, target_crs)\nstudy_land_proj &lt;- st_transform(study_land, target_crs)\n\nrome_mint &lt;- st_as_sf(\n  tibble(name = \"Rome\", lon = 12.4964, lat = 41.9028),\n  coords = c(\"lon\", \"lat\"),\n  crs = 4326\n) %&gt;%\n  st_transform(target_crs)\n\ncat(\"Projected to EPSG:\", target_crs, \"\\n\")\n\n\nProjected to EPSG: 3035"
  },
  {
    "objectID": "lrr_compositional.html#construct-hexagonal-grid-100-km",
    "href": "lrr_compositional.html#construct-hexagonal-grid-100-km",
    "title": "Compositional Log-Relative Risk Analysis",
    "section": "5.3 Construct Hexagonal Grid (100 km)",
    "text": "5.3 Construct Hexagonal Grid (100 km)\n\n\nCode\nhex_size &lt;- 100000  # 100 km in meters\n\nhex_grid &lt;- st_make_grid(\n  study_land_proj,\n  cellsize = hex_size,\n  square = FALSE\n) %&gt;%\n  st_sf(hex_id = seq_along(.), geometry = .) %&gt;%\n  st_set_crs(target_crs)\n\n# Filter to land hexes\nhex_land &lt;- hex_grid %&gt;%\n  filter(lengths(st_intersects(., study_land_proj)) &gt; 0)\n\n# Centroid on land filter\nhex_centroids &lt;- st_centroid(hex_land)\non_land &lt;- lengths(st_intersects(hex_centroids, study_land_proj)) &gt; 0\nhex_land &lt;- hex_land[on_land, ]\n\ncat(\"Hex grid: \", nrow(hex_land), \"hexes on land (\", hex_size/1000, \"km)\\n\")\n\n\nHex grid:  859 hexes on land ( 100 km)"
  },
  {
    "objectID": "lrr_compositional.html#assign-hoards-to-hexes-and-aggregate",
    "href": "lrr_compositional.html#assign-hoards-to-hexes-and-aggregate",
    "title": "Compositional Log-Relative Risk Analysis",
    "section": "6.1 Assign Hoards to Hexes and Aggregate",
    "text": "6.1 Assign Hoards to Hexes and Aggregate\n\n\nCode\n# Spatial join\nhoard_hex &lt;- st_join(hoard_sf_proj, hex_land, join = st_within) %&gt;%\n  filter(!is.na(hex_id))\n\n# Aggregate composition per hex\nhex_comp &lt;- hoard_hex %&gt;%\n  st_drop_geometry() %&gt;%\n  group_by(hex_id) %&gt;%\n  summarise(\n    n_hoards = n(),\n    total_types = sum(n_types),      # Total coin-type occurrences\n    rome_types = sum(n_rome),        # Rome coin-type occurrences\n    non_rome_types = sum(n_non_rome),\n    \n    # Weighted mean Rome proportion (by hoard size)\n    p_rome_weighted = rome_types / total_types,\n    \n    # Unweighted mean (each hoard counts equally)\n    p_rome_unweighted = mean(p_rome),\n    \n    .groups = \"drop\"\n  )\n\n# Join back to hex geometry\nhex_lrr &lt;- hex_land %&gt;%\n  left_join(hex_comp, by = \"hex_id\") %&gt;%\n  mutate(\n    across(c(n_hoards, total_types, rome_types, non_rome_types), \n           ~replace_na(.x, 0)),\n    has_data = n_hoards &gt; 0\n  )\n\ncat(\"Hoards assigned to hexes:\", sum(hex_lrr$n_hoards), \"\\n\")\n\n\nHoards assigned to hexes: 404 \n\n\nCode\ncat(\"Hexes with data:\", sum(hex_lrr$has_data), \"\\n\")\n\n\nHexes with data: 141"
  },
  {
    "objectID": "lrr_compositional.html#compute-compositional-lrr",
    "href": "lrr_compositional.html#compute-compositional-lrr",
    "title": "Compositional Log-Relative Risk Analysis",
    "section": "6.2 Compute Compositional LRR",
    "text": "6.2 Compute Compositional LRR\nThree formulations, each with different assumptions:\n\n\nCode\n# Global Rome proportion for reference\np_global &lt;- sum(hex_lrr$rome_types) / sum(hex_lrr$total_types)\ncat(\"Global Rome proportion (from hex data):\", round(p_global * 100, 2), \"%\\n\\n\")\n\n\nGlobal Rome proportion (from hex data): 88.29 %\n\n\nCode\n# Smoothing constant for sparse hexes\nepsilon &lt;- 0.5\n\nhex_lrr &lt;- hex_lrr %&gt;%\n  mutate(\n    # ============================================================\n    # Method 1: Compositional LRR (row-level aggregation)\n    # Compares hex Rome proportion to global Rome proportion\n    # ============================================================\n    LRR_comp = ifelse(\n      has_data,\n      log((rome_types + epsilon) / (total_types + epsilon)) - log(p_global),\n      NA_real_\n    ),\n    \n    # ============================================================\n    # Method 2: Rome vs Non-Rome LRR (direct contrast)\n    # Positive = Rome dominates, Negative = other mints dominate\n    # ============================================================\n    LRR_contrast = ifelse(\n      has_data & non_rome_types &gt; 0,\n      log((rome_types + epsilon) / (non_rome_types + epsilon)),\n      NA_real_\n    ),\n    \n    # ============================================================\n    # Method 3: Deviation from expected (binomial framework)\n    # How many more/fewer Rome coins than expected at global rate?\n    # ============================================================\n    expected_rome = total_types * p_global,\n    rome_excess = rome_types - expected_rome,\n    rome_excess_pct = ifelse(has_data, 100 * rome_excess / expected_rome, NA_real_)\n  )"
  },
  {
    "objectID": "lrr_compositional.html#lrr-summary-statistics",
    "href": "lrr_compositional.html#lrr-summary-statistics",
    "title": "Compositional Log-Relative Risk Analysis",
    "section": "6.3 LRR Summary Statistics",
    "text": "6.3 LRR Summary Statistics\n\n\nCode\nlrr_stats &lt;- hex_lrr %&gt;%\n  filter(has_data) %&gt;%\n  st_drop_geometry() %&gt;%\n  summarise(\n    n_hexes = n(),\n    \n    # Compositional LRR\n    lrr_comp_mean = mean(LRR_comp, na.rm = TRUE),\n    lrr_comp_sd = sd(LRR_comp, na.rm = TRUE),\n    lrr_comp_min = min(LRR_comp, na.rm = TRUE),\n    lrr_comp_max = max(LRR_comp, na.rm = TRUE),\n    \n    # Rome vs Non-Rome\n    lrr_contrast_mean = mean(LRR_contrast, na.rm = TRUE),\n    lrr_contrast_sd = sd(LRR_contrast, na.rm = TRUE),\n    \n    # Rome proportion\n    p_rome_mean = mean(p_rome_weighted, na.rm = TRUE),\n    p_rome_sd = sd(p_rome_weighted, na.rm = TRUE)\n  )\n\nkable(lrr_stats, digits = 3, caption = \"LRR Summary Statistics\")\n\n\n\nLRR Summary Statistics\n\n\n\n\n\n\n\n\n\n\n\n\n\nn_hexes\nlrr_comp_mean\nlrr_comp_sd\nlrr_comp_min\nlrr_comp_max\nlrr_contrast_mean\nlrr_contrast_sd\np_rome_mean\np_rome_sd\n\n\n\n\n141\n-0.023\n0.185\n-1.311\n0.125\n1.998\n0.896\n0.871\n0.13\n\n\n\n\n\n\n\nCode\nhex_data &lt;- hex_lrr %&gt;%\n  filter(has_data) %&gt;%\n  st_drop_geometry()\n\np1 &lt;- ggplot(hex_data, aes(x = LRR_comp)) +\n  geom_histogram(bins = 25, fill = \"steelblue\", color = \"white\", alpha = 0.8) +\n  geom_vline(xintercept = 0, color = \"darkred\", linetype = \"dashed\") +\n  labs(\n    title = \"Compositional LRR Distribution\",\n    subtitle = \"LRR = 0 means hex matches global Rome proportion\",\n    x = \"LRR (compositional)\",\n    y = \"Count\"\n  )\n\np2 &lt;- ggplot(hex_data, aes(x = p_rome_weighted)) +\n  geom_histogram(bins = 25, fill = \"forestgreen\", color = \"white\", alpha = 0.8) +\n  geom_vline(xintercept = p_global, color = \"darkred\", linetype = \"dashed\") +\n  scale_x_continuous(labels = scales::percent_format()) +\n  labs(\n    title = \"Rome Proportion per Hex\",\n    subtitle = paste(\"Global =\", round(p_global * 100, 1), \"%\"),\n    x = \"Rome proportion\",\n    y = \"Count\"\n  )\n\nlibrary(patchwork)\np1 + p2"
  },
  {
    "objectID": "lrr_compositional.html#map-1-compositional-lrr",
    "href": "lrr_compositional.html#map-1-compositional-lrr",
    "title": "Compositional Log-Relative Risk Analysis",
    "section": "7.1 Map 1: Compositional LRR",
    "text": "7.1 Map 1: Compositional LRR\n\n\nCode\nhex_map &lt;- hex_lrr %&gt;%\n  filter(has_data) %&gt;%\n  st_transform(4326)\n\nland_wgs &lt;- st_transform(study_land_proj, 4326)\nrome_wgs &lt;- st_transform(rome_mint, 4326)\n\nggplot() +\n  geom_sf(data = land_wgs, fill = \"grey95\", color = \"grey80\") +\n  geom_sf(\n    data = hex_map,\n    aes(fill = LRR_comp),\n    color = \"grey50\",\n    linewidth = 0.2\n  ) +\n  geom_sf(data = rome_wgs, color = \"black\", shape = 8, size = 5, stroke = 1.5) +\n  scale_fill_gradient2(\n    low = \"steelblue\",\n    mid = \"white\",\n    high = \"darkred\",\n    midpoint = 0,\n    name = \"LRR\",\n    limits = c(-0.5, 0.5),\n    oob = scales::squish\n  ) +\n  coord_sf(\n    xlim = c(hoard_bbox[\"xmin\"] - 1, hoard_bbox[\"xmax\"] + 1),\n    ylim = c(hoard_bbox[\"ymin\"] - 1, hoard_bbox[\"ymax\"] + 1)\n  ) +\n  labs(\n    title = \"Compositional Log-Relative Risk\",\n    subtitle = \"Rome proportion relative to global average (88%) | Red = above average, Blue = below\",\n    caption = \"Star = Rome mint | 100 km hexagonal grid\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text = element_blank(),\n    axis.title = element_blank(),\n    legend.position = \"right\"\n  )"
  },
  {
    "objectID": "lrr_compositional.html#map-2-rome-vs.-non-rome-contrast",
    "href": "lrr_compositional.html#map-2-rome-vs.-non-rome-contrast",
    "title": "Compositional Log-Relative Risk Analysis",
    "section": "7.2 Map 2: Rome vs. Non-Rome Contrast",
    "text": "7.2 Map 2: Rome vs. Non-Rome Contrast\n\n\nCode\nggplot() +\n  geom_sf(data = land_wgs, fill = \"grey95\", color = \"grey80\") +\n  geom_sf(\n    data = hex_map %&gt;% filter(!is.na(LRR_contrast)),\n    aes(fill = LRR_contrast),\n    color = \"grey50\",\n    linewidth = 0.2\n  ) +\n  geom_sf(data = rome_wgs, color = \"black\", shape = 8, size = 5, stroke = 1.5) +\n  scale_fill_gradient2(\n    low = \"purple4\",\n    mid = \"white\",\n    high = \"darkorange\",\n    midpoint = log(1),  # Equal Rome and non-Rome\n    name = \"log(Rome/\\nNon-Rome)\",\n    limits = c(0, 4),\n    oob = scales::squish\n  ) +\n  coord_sf(\n    xlim = c(hoard_bbox[\"xmin\"] - 1, hoard_bbox[\"xmax\"] + 1),\n    ylim = c(hoard_bbox[\"ymin\"] - 1, hoard_bbox[\"ymax\"] + 1)\n  ) +\n  labs(\n    title = \"Rome vs. Non-Rome Mint Contrast\",\n    subtitle = \"Orange = Rome dominates, Purple = other mints more prevalent\",\n    caption = \"Star = Rome mint | Hexes with non-Rome coins only\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text = element_blank(),\n    axis.title = element_blank(),\n    legend.position = \"right\"\n  )"
  },
  {
    "objectID": "lrr_compositional.html#map-3-raw-rome-proportion",
    "href": "lrr_compositional.html#map-3-raw-rome-proportion",
    "title": "Compositional Log-Relative Risk Analysis",
    "section": "7.3 Map 3: Raw Rome Proportion",
    "text": "7.3 Map 3: Raw Rome Proportion\n\n\nCode\nggplot() +\n  geom_sf(data = land_wgs, fill = \"grey95\", color = \"grey80\") +\n  geom_sf(\n    data = hex_map,\n    aes(fill = p_rome_weighted),\n    color = \"grey50\",\n    linewidth = 0.2\n  ) +\n  geom_sf(data = rome_wgs, color = \"black\", shape = 8, size = 5, stroke = 1.5) +\n  scale_fill_viridis_c(\n    name = \"Rome %\",\n    labels = scales::percent_format(),\n    option = \"plasma\",\n    limits = c(0.5, 1),\n    oob = scales::squish\n  ) +\n  coord_sf(\n    xlim = c(hoard_bbox[\"xmin\"] - 1, hoard_bbox[\"xmax\"] + 1),\n    ylim = c(hoard_bbox[\"ymin\"] - 1, hoard_bbox[\"ymax\"] + 1)\n  ) +\n  labs(\n    title = \"Rome Mint Proportion by Hex\",\n    subtitle = \"Proportion of coin-type occurrences from Rome mint\",\n    caption = \"Star = Rome mint | 100 km hexagonal grid\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text = element_blank(),\n    axis.title = element_blank(),\n    legend.position = \"right\"\n  )"
  },
  {
    "objectID": "lrr_compositional.html#map-4-sample-size-denominator",
    "href": "lrr_compositional.html#map-4-sample-size-denominator",
    "title": "Compositional Log-Relative Risk Analysis",
    "section": "7.4 Map 4: Sample Size (Denominator)",
    "text": "7.4 Map 4: Sample Size (Denominator)\n\n\nCode\nggplot() +\n  geom_sf(data = land_wgs, fill = \"grey95\", color = \"grey80\") +\n  geom_sf(\n    data = hex_map,\n    aes(fill = total_types),\n    color = \"grey50\",\n    linewidth = 0.2\n  ) +\n  geom_sf(data = rome_wgs, color = \"white\", shape = 8, size = 5, stroke = 1.5) +\n  scale_fill_viridis_c(\n    name = \"Coin-types\",\n    trans = \"sqrt\",\n    option = \"viridis\"\n  ) +\n  coord_sf(\n    xlim = c(hoard_bbox[\"xmin\"] - 1, hoard_bbox[\"xmax\"] + 1),\n    ylim = c(hoard_bbox[\"ymin\"] - 1, hoard_bbox[\"ymax\"] + 1)\n  ) +\n  labs(\n    title = \"Sample Size per Hex (Total Coin-Type Occurrences)\",\n    subtitle = \"Denominator for compositional LRR | sqrt scale\",\n    caption = \"Star = Rome mint\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text = element_blank(),\n    axis.title = element_blank(),\n    legend.position = \"right\"\n  )"
  },
  {
    "objectID": "lrr_compositional.html#hex-level-binomial-model",
    "href": "lrr_compositional.html#hex-level-binomial-model",
    "title": "Compositional Log-Relative Risk Analysis",
    "section": "8.1 Hex-Level Binomial Model",
    "text": "8.1 Hex-Level Binomial Model\nThe compositional LRR can be formalized as a binomial regression:\n\\[N_{\\text{Rome},h} \\sim \\text{Binomial}(N_{\\text{total},h}, \\pi_h)\\] \\[\\text{logit}(\\pi_h) = \\beta_0 + \\text{spatial effects}\\]\n\n\nCode\n# Prepare data for modeling\nmodel_data &lt;- hex_lrr %&gt;%\n  filter(has_data, total_types &gt; 0) %&gt;%\n  st_drop_geometry()\n\n# Simple binomial model (intercept only)\nbinom_fit &lt;- glm(\n\n  cbind(rome_types, non_rome_types) ~ 1,\n  family = binomial(link = \"logit\"),\n  data = model_data\n)\n\n# Extract estimates\nbeta0 &lt;- coef(binom_fit)[1]\nse_beta0 &lt;- sqrt(vcov(binom_fit)[1,1])\np_fitted &lt;- plogis(beta0)\n\ncat(\"Binomial Model Results\\n\")\n\n\nBinomial Model Results\n\n\nCode\ncat(\"======================\\n\")\n\n\n======================\n\n\nCode\ncat(\"Intercept (logit scale):\", round(beta0, 4), \"\\n\")\n\n\nIntercept (logit scale): 2.0205 \n\n\nCode\ncat(\"Standard error:\", round(se_beta0, 4), \"\\n\")\n\n\nStandard error: 0.0194 \n\n\nCode\ncat(\"Fitted global probability:\", round(p_fitted, 4), \"(\", round(p_fitted*100, 1), \"%)\\n\")\n\n\nFitted global probability: 0.8829 ( 88.3 %)\n\n\nCode\ncat(\"95% CI:\", round(plogis(beta0 - 1.96*se_beta0), 4), \"-\", \n    round(plogis(beta0 + 1.96*se_beta0), 4), \"\\n\")\n\n\n95% CI: 0.879 - 0.8868"
  },
  {
    "objectID": "lrr_compositional.html#distance-from-rome-as-covariate",
    "href": "lrr_compositional.html#distance-from-rome-as-covariate",
    "title": "Compositional Log-Relative Risk Analysis",
    "section": "8.2 Distance from Rome as Covariate",
    "text": "8.2 Distance from Rome as Covariate\n\n\nCode\n# Calculate hex centroid distance from Rome\nhex_centroids_wgs &lt;- hex_lrr %&gt;%\n  filter(has_data) %&gt;%\n  st_centroid() %&gt;%\n  st_transform(4326)\n\nrome_coords &lt;- c(12.4964, 41.9028)\n\n# Add distance\nhex_lrr_dist &lt;- hex_lrr %&gt;%\n  filter(has_data) %&gt;%\n  mutate(\n    centroid = st_centroid(geometry)\n  )\n\n# Get centroids in WGS84 for distance calculation\ncentroids_wgs &lt;- st_transform(st_centroid(hex_lrr_dist), 4326)\ncoords &lt;- st_coordinates(centroids_wgs)\n\nhex_lrr_dist &lt;- hex_lrr_dist %&gt;%\n  st_drop_geometry() %&gt;%\n  mutate(\n    cent_lon = coords[, 1],\n    cent_lat = coords[, 2],\n    dist_rome_km = sqrt((cent_lon - rome_coords[1])^2 + (cent_lat - rome_coords[2])^2) * 111\n  )\n\n# Binomial with distance covariate\nbinom_dist &lt;- glm(\n  cbind(rome_types, non_rome_types) ~ dist_rome_km,\n  family = binomial(link = \"logit\"),\n  data = hex_lrr_dist\n)\n\nsummary(binom_dist)\n\n\n\nCall:\nglm(formula = cbind(rome_types, non_rome_types) ~ dist_rome_km, \n    family = binomial(link = \"logit\"), data = hex_lrr_dist)\n\nCoefficients:\n               Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)   2.060e+00  3.275e-02  62.896   &lt;2e-16 ***\ndist_rome_km -4.213e-05  2.796e-05  -1.507    0.132    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 1205.8  on 140  degrees of freedom\nResidual deviance: 1203.5  on 139  degrees of freedom\nAIC: 1711.8\n\nNumber of Fisher Scoring iterations: 4\n\n\n\n\nCode\n# Predicted probability vs distance\ndist_seq &lt;- seq(0, max(hex_lrr_dist$dist_rome_km, na.rm = TRUE), length.out = 100)\npred_df &lt;- data.frame(dist_rome_km = dist_seq)\npred_df$p_rome_pred &lt;- predict(binom_dist, newdata = pred_df, type = \"response\")\n\nggplot() +\n  geom_point(\n    data = hex_lrr_dist,\n    aes(x = dist_rome_km, y = p_rome_weighted, size = total_types),\n    alpha = 0.5,\n    color = \"steelblue\"\n  ) +\n  geom_line(\n    data = pred_df,\n    aes(x = dist_rome_km, y = p_rome_pred),\n    color = \"darkred\",\n    linewidth = 1.2\n  ) +\n  geom_hline(yintercept = p_global, linetype = \"dashed\", color = \"grey50\") +\n  scale_y_continuous(labels = scales::percent_format(), limits = c(0.5, 1)) +\n  scale_size_continuous(name = \"Sample size\", range = c(1, 10)) +\n  labs(\n    title = \"Rome Proportion vs. Distance from Rome (Hex-Level)\",\n    subtitle = \"Red line = binomial regression fit | Dashed = global average\",\n    x = \"Distance from Rome (km)\",\n    y = \"Rome proportion\"\n  )\n\n\n\n\n\n\n\n\n\n\n\nCode\n# Extract coefficients\ncoefs &lt;- coef(binom_dist)\ncat(\"\\nDistance Effect Interpretation\\n\")\n\n\n\nDistance Effect Interpretation\n\n\nCode\ncat(\"==============================\\n\")\n\n\n==============================\n\n\nCode\ncat(\"Intercept:\", round(coefs[1], 4), \"\\n\")\n\n\nIntercept: 2.06 \n\n\nCode\ncat(\"Distance coefficient:\", round(coefs[2], 6), \"per km\\n\")\n\n\nDistance coefficient: -4.2e-05 per km\n\n\nCode\ncat(\"\\nAt Rome (0 km): p =\", round(plogis(coefs[1]), 3), \"\\n\")\n\n\n\nAt Rome (0 km): p = 0.887 \n\n\nCode\ncat(\"At 1000 km: p =\", round(plogis(coefs[1] + coefs[2]*1000), 3), \"\\n\")\n\n\nAt 1000 km: p = 0.883 \n\n\nCode\ncat(\"At 2000 km: p =\", round(plogis(coefs[1] + coefs[2]*2000), 3), \"\\n\")\n\n\nAt 2000 km: p = 0.878 \n\n\nCode\ncat(\"At 3000 km: p =\", round(plogis(coefs[1] + coefs[2]*3000), 3), \"\\n\")\n\n\nAt 3000 km: p = 0.874 \n\n\nCode\n# Odds ratio per 100 km\nor_100km &lt;- exp(coefs[2] * 100)\ncat(\"\\nOdds ratio per 100 km increase:\", round(or_100km, 4), \"\\n\")\n\n\n\nOdds ratio per 100 km increase: 0.9958 \n\n\nCode\ncat(\"(Values &lt; 1 indicate Rome proportion decreases with distance)\\n\")\n\n\n(Values &lt; 1 indicate Rome proportion decreases with distance)"
  },
  {
    "objectID": "lrr_compositional.html#temporal-stratification",
    "href": "lrr_compositional.html#temporal-stratification",
    "title": "Compositional Log-Relative Risk Analysis",
    "section": "11.1 Temporal Stratification",
    "text": "11.1 Temporal Stratification\nThe hex framework is now ready for temporal stratification. Next steps:\n\nBy TPQ (deposition time): Stratify hoards by terminus post quem to see how Rome’s spatial reach changed over deposition periods\nBy mint date (production time): Stratify by when coins were minted to track production reach\nHMM Integration: The hex-level composition becomes the observation for each spatial unit, with temporal sequences enabling regime detection"
  },
  {
    "objectID": "lrr_compositional.html#resolution-refinement",
    "href": "lrr_compositional.html#resolution-refinement",
    "title": "Compositional Log-Relative Risk Analysis",
    "section": "11.2 Resolution Refinement",
    "text": "11.2 Resolution Refinement\nAfter validating patterns at 100 km:\n\n50 km → regional structure\n25 km → corridor detection\n\n5 km → fine-grained patterns (if sample size permits)"
  },
  {
    "objectID": "circulation_age.html",
    "href": "circulation_age.html",
    "title": "Coin-Type Age Profiles: Circulation Velocity Analysis",
    "section": "",
    "text": "The circulation age of a coin is the time between when it was minted and when it was deposited in a hoard:\n\\[\\text{Circulation Age} = \\text{TPQ (deposition)} - \\text{Mint Date (production)}\\]\nThis metric reveals:\n\n\n\nPattern\nInterpretation\n\n\n\n\nHigh mean age\nMonetary backwater; old coins accumulate\n\n\nLow mean age\nActive trade node; fresh coins arrive regularly\n\n\nHigh age variance\nMixed circulation; coins from many eras\n\n\nLow age variance\nUniform replacement; consistent turnover\n\n\n\n\n\n\n\nWhere did old coins accumulate? (periphery vs. core)\nDid circulation velocity vary by distance from Rome?\nHow did age profiles change across monetary regimes?\nAre there regional “pools” of old coinage?"
  },
  {
    "objectID": "circulation_age.html#what-circulation-age-tells-us",
    "href": "circulation_age.html#what-circulation-age-tells-us",
    "title": "Coin-Type Age Profiles: Circulation Velocity Analysis",
    "section": "",
    "text": "The circulation age of a coin is the time between when it was minted and when it was deposited in a hoard:\n\\[\\text{Circulation Age} = \\text{TPQ (deposition)} - \\text{Mint Date (production)}\\]\nThis metric reveals:\n\n\n\nPattern\nInterpretation\n\n\n\n\nHigh mean age\nMonetary backwater; old coins accumulate\n\n\nLow mean age\nActive trade node; fresh coins arrive regularly\n\n\nHigh age variance\nMixed circulation; coins from many eras\n\n\nLow age variance\nUniform replacement; consistent turnover"
  },
  {
    "objectID": "circulation_age.html#research-questions",
    "href": "circulation_age.html#research-questions",
    "title": "Coin-Type Age Profiles: Circulation Velocity Analysis",
    "section": "",
    "text": "Where did old coins accumulate? (periphery vs. core)\nDid circulation velocity vary by distance from Rome?\nHow did age profiles change across monetary regimes?\nAre there regional “pools” of old coinage?"
  },
  {
    "objectID": "circulation_age.html#compute-circulation-age",
    "href": "circulation_age.html#compute-circulation-age",
    "title": "Coin-Type Age Profiles: Circulation Velocity Analysis",
    "section": "3.1 Compute Circulation Age",
    "text": "3.1 Compute Circulation Age\n\n\nCode\nchrr_age &lt;- chrr_raw %&gt;%\n  mutate(\n    # Parse dates\n    mint_start = as.numeric(start_year),\n    mint_end = as.numeric(end_year),\n    mint_mid = (mint_start + mint_end) / 2,\n    tpq_year = readr::parse_number(as.character(hoard_tpq)),\n    \n    # Circulation age\n    circ_age = tpq_year - mint_mid,\n    \n    # Flag Rome mint\n    is_rome = mint_id == \"rome\" | str_detect(mint_uri, \"/id/rome$\"),\n    is_rome = replace_na(is_rome, FALSE)\n  ) %&gt;%\n  filter(\n    !is.na(circ_age),\n    !is.na(hoard_lat),\n    !is.na(hoard_long),\n    circ_age &gt;= 0  # Exclude anomalies where TPQ &lt; mint date\n  )\n\ncat(\"Coin-types with valid circulation age:\", nrow(chrr_age), \"\\n\")\n\n\nCoin-types with valid circulation age: 29819 \n\n\nCode\ncat(\"Unique hoards:\", n_distinct(chrr_age$hoard_id), \"\\n\")\n\n\nUnique hoards: 463"
  },
  {
    "objectID": "circulation_age.html#circulation-age-summary",
    "href": "circulation_age.html#circulation-age-summary",
    "title": "Coin-Type Age Profiles: Circulation Velocity Analysis",
    "section": "3.2 Circulation Age Summary",
    "text": "3.2 Circulation Age Summary\n\n\nCode\nage_summary &lt;- chrr_age %&gt;%\n  summarise(\n    n = n(),\n    mean_age = mean(circ_age),\n    median_age = median(circ_age),\n    sd_age = sd(circ_age),\n    q10 = quantile(circ_age, 0.10),\n    q25 = quantile(circ_age, 0.25),\n    q75 = quantile(circ_age, 0.75),\n    q90 = quantile(circ_age, 0.90),\n    max_age = max(circ_age)\n  )\n\nkable(age_summary, digits = 1, caption = \"Overall circulation age statistics (years)\")\n\n\n\nOverall circulation age statistics (years)\n\n\nn\nmean_age\nmedian_age\nsd_age\nq10\nq25\nq75\nq90\nmax_age\n\n\n\n\n29819\n44.2\n38\n33.4\n6\n17\n64\n91\n225"
  },
  {
    "objectID": "circulation_age.html#distribution-of-circulation-ages",
    "href": "circulation_age.html#distribution-of-circulation-ages",
    "title": "Coin-Type Age Profiles: Circulation Velocity Analysis",
    "section": "3.3 Distribution of Circulation Ages",
    "text": "3.3 Distribution of Circulation Ages\n\n\nCode\np1 &lt;- ggplot(chrr_age, aes(x = circ_age)) +\n geom_histogram(binwidth = 10, fill = \"steelblue\", color = \"white\", alpha = 0.8) +\n  geom_vline(xintercept = age_summary$median_age, color = \"darkred\", \n             linetype = \"dashed\", linewidth = 1) +\n  labs(\n    title = \"Distribution of Circulation Ages\",\n    subtitle = paste(\"Median =\", round(age_summary$median_age, 0), \"years\"),\n    x = \"Circulation age (years)\",\n    y = \"Count\"\n  )\n\np2 &lt;- ggplot(chrr_age, aes(x = circ_age)) +\n  geom_histogram(binwidth = 10, fill = \"steelblue\", color = \"white\", alpha = 0.8) +\n  scale_y_log10() +\n  labs(\n    title = \"Distribution (log scale)\",\n    subtitle = \"Reveals long tail of very old coins\",\n    x = \"Circulation age (years)\",\n    y = \"Count (log)\"\n  )\n\np1 + p2"
  },
  {
    "objectID": "circulation_age.html#create-hex-grid",
    "href": "circulation_age.html#create-hex-grid",
    "title": "Coin-Type Age Profiles: Circulation Velocity Analysis",
    "section": "5.1 Create Hex Grid",
    "text": "5.1 Create Hex Grid\n\n\nCode\nlibrary(rnaturalearth)\nlibrary(rnaturalearthdata)\n\n# Convert to sf\nhoard_sf &lt;- st_as_sf(\n  chrr_age,\n  coords = c(\"hoard_long\", \"hoard_lat\"),\n  crs = 4326,\n  remove = FALSE\n)\n\n# Study area\nland &lt;- ne_countries(scale = \"medium\", returnclass = \"sf\") %&gt;% st_union()\nhoard_bbox &lt;- st_bbox(hoard_sf)\npad &lt;- 2\n\nstudy_extent &lt;- st_polygon(list(rbind(\n  c(hoard_bbox[\"xmin\"] - pad, hoard_bbox[\"ymin\"] - pad),\n  c(hoard_bbox[\"xmax\"] + pad, hoard_bbox[\"ymin\"] - pad),\n  c(hoard_bbox[\"xmax\"] + pad, hoard_bbox[\"ymax\"] + pad),\n  c(hoard_bbox[\"xmin\"] - pad, hoard_bbox[\"ymax\"] + pad),\n  c(hoard_bbox[\"xmin\"] - pad, hoard_bbox[\"ymin\"] - pad)\n))) %&gt;% st_sfc(crs = 4326)\n\nstudy_land &lt;- st_intersection(land, study_extent)\n\n# Project\ntarget_crs &lt;- 3035\nhoard_sf_proj &lt;- st_transform(hoard_sf, target_crs)\nstudy_land_proj &lt;- st_transform(study_land, target_crs)\n\nrome_coords &lt;- c(12.4964, 41.9028)\nrome_sf &lt;- st_as_sf(tibble(lon = rome_coords[1], lat = rome_coords[2]),\n                     coords = c(\"lon\", \"lat\"), crs = 4326) %&gt;%\n  st_transform(target_crs)\n\n# Hex grid\nhex_size &lt;- 100000\nhex_grid &lt;- st_make_grid(study_land_proj, cellsize = hex_size, square = FALSE) %&gt;%\n  st_sf(hex_id = seq_along(.), geometry = .) %&gt;%\n  st_set_crs(target_crs)\n\nhex_land &lt;- hex_grid %&gt;%\n  filter(lengths(st_intersects(., study_land_proj)) &gt; 0)\n\nhex_centroids &lt;- st_centroid(hex_land)\non_land &lt;- lengths(st_intersects(hex_centroids, study_land_proj)) &gt; 0\nhex_land &lt;- hex_land[on_land, ]\n\ncat(\"Hexes on land:\", nrow(hex_land), \"\\n\")\n\n\nHexes on land: 859"
  },
  {
    "objectID": "circulation_age.html#aggregate-circulation-age-by-hex",
    "href": "circulation_age.html#aggregate-circulation-age-by-hex",
    "title": "Coin-Type Age Profiles: Circulation Velocity Analysis",
    "section": "5.2 Aggregate Circulation Age by Hex",
    "text": "5.2 Aggregate Circulation Age by Hex\n\n\nCode\n# Spatial join\nhoard_hex &lt;- st_join(hoard_sf_proj, hex_land, join = st_within) %&gt;%\n  filter(!is.na(hex_id))\n\n# Aggregate by hex\nhex_age &lt;- hoard_hex %&gt;%\n  st_drop_geometry() %&gt;%\n  group_by(hex_id) %&gt;%\n  summarise(\n    n_types = n(),\n    n_hoards = n_distinct(hoard_id),\n    mean_age = mean(circ_age),\n    median_age = median(circ_age),\n    sd_age = sd(circ_age),\n    q25_age = quantile(circ_age, 0.25),\n    q75_age = quantile(circ_age, 0.75),\n    age_iqr = q75_age - q25_age,\n    pct_old = mean(circ_age &gt; 50) * 100,  # % coins &gt; 50 years old\n    pct_fresh = mean(circ_age &lt; 20) * 100,  # % coins &lt; 20 years old\n    .groups = \"drop\"\n  )\n\ncat(\"Hexes with data:\", nrow(hex_age), \"\\n\")\n\n\nHexes with data: 141"
  },
  {
    "objectID": "circulation_age.html#add-distance-from-rome",
    "href": "circulation_age.html#add-distance-from-rome",
    "title": "Coin-Type Age Profiles: Circulation Velocity Analysis",
    "section": "5.3 Add Distance from Rome",
    "text": "5.3 Add Distance from Rome\n\n\nCode\n# Hex centroids in WGS84\nhex_centroids_wgs &lt;- hex_land %&gt;%\n  st_centroid() %&gt;%\n  st_transform(4326)\n\ncent_coords &lt;- st_coordinates(hex_centroids_wgs)\n\nhex_coords &lt;- tibble(\n  hex_id = hex_land$hex_id,\n  cent_lon = cent_coords[, 1],\n  cent_lat = cent_coords[, 2]\n) %&gt;%\n  mutate(\n    dist_rome_km = sqrt((cent_lon - rome_coords[1])^2 + \n                        (cent_lat - rome_coords[2])^2) * 111\n  )\n\nhex_age &lt;- hex_age %&gt;%\n  left_join(hex_coords, by = \"hex_id\")"
  },
  {
    "objectID": "circulation_age.html#regression-age-vs-distance",
    "href": "circulation_age.html#regression-age-vs-distance",
    "title": "Coin-Type Age Profiles: Circulation Velocity Analysis",
    "section": "9.1 Regression: Age vs Distance",
    "text": "9.1 Regression: Age vs Distance\n\n\nCode\n# Linear regression\nlm_age &lt;- lm(mean_age ~ dist_rome_km, data = hex_age, weights = n_types)\n\nsummary(lm_age)\n\n\n\nCall:\nlm(formula = mean_age ~ dist_rome_km, data = hex_age, weights = n_types)\n\nWeighted Residuals:\n    Min      1Q  Median      3Q     Max \n-337.08 -104.90  -51.50   59.81  548.01 \n\nCoefficients:\n              Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  41.313878   1.670319  24.734   &lt;2e-16 ***\ndist_rome_km  0.003103   0.001444   2.149   0.0334 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 158.3 on 139 degrees of freedom\nMultiple R-squared:  0.03215,   Adjusted R-squared:  0.02519 \nF-statistic: 4.618 on 1 and 139 DF,  p-value: 0.03337\n\n\nCode\n# Extract coefficients\ncoef_dist &lt;- coef(lm_age)[\"dist_rome_km\"]\ncat(\"\\nEffect: Each 100km from Rome adds\", round(coef_dist * 100, 2), \"years to mean circulation age\\n\")\n\n\n\nEffect: Each 100km from Rome adds 0.31 years to mean circulation age"
  },
  {
    "objectID": "circulation_age.html#scatterplot-age-vs-distance",
    "href": "circulation_age.html#scatterplot-age-vs-distance",
    "title": "Coin-Type Age Profiles: Circulation Velocity Analysis",
    "section": "9.2 Scatterplot: Age vs Distance",
    "text": "9.2 Scatterplot: Age vs Distance\n\n\nCode\nggplot(hex_age, aes(x = dist_rome_km, y = mean_age)) +\n  geom_point(aes(size = n_types), alpha = 0.6, color = \"steelblue\") +\n  geom_smooth(method = \"lm\", color = \"darkred\", se = TRUE) +\n  scale_size_continuous(name = \"Sample size\", range = c(1, 8)) +\n  labs(\n    title = \"Circulation Age vs Distance from Rome\",\n    subtitle = paste(\"Each 100km adds ~\", round(coef_dist * 100, 1), \"years to mean age\"),\n    x = \"Distance from Rome (km)\",\n    y = \"Mean circulation age (years)\"\n  )"
  },
  {
    "objectID": "circulation_age.html#define-regions",
    "href": "circulation_age.html#define-regions",
    "title": "Coin-Type Age Profiles: Circulation Velocity Analysis",
    "section": "12.1 Define Regions",
    "text": "12.1 Define Regions\n\n\nCode\nhex_age &lt;- hex_age %&gt;%\n  mutate(\n    # Bearing from Rome (degrees)\n    bearing = atan2(cent_lon - rome_coords[1], cent_lat - rome_coords[2]) * 180 / pi,\n    bearing = ifelse(bearing &lt; 0, bearing + 360, bearing),\n    \n    # Regional sectors\n    region = case_when(\n      bearing &gt;= 315 | bearing &lt; 45 ~ \"North (Gaul/Alps)\",\n      bearing &gt;= 45 & bearing &lt; 135 ~ \"East (Balkans/Greece)\",\n      bearing &gt;= 135 & bearing &lt; 225 ~ \"South (Africa/Sicily)\",\n      bearing &gt;= 225 & bearing &lt; 315 ~ \"West (Iberia/Sardinia)\"\n    )\n  )\n\nregion_summary &lt;- hex_age %&gt;%\n  group_by(region) %&gt;%\n  summarise(\n    n_hexes = n(),\n    mean_dist = mean(dist_rome_km),\n    mean_age = weighted.mean(mean_age, n_types),\n    mean_pct_fresh = weighted.mean(pct_fresh, n_types),\n    mean_pct_old = weighted.mean(pct_old, n_types),\n    .groups = \"drop\"\n  )\n\nkable(region_summary, digits = 1, caption = \"Circulation patterns by region\")\n\n\n\nCirculation patterns by region\n\n\n\n\n\n\n\n\n\n\nregion\nn_hexes\nmean_dist\nmean_age\nmean_pct_fresh\nmean_pct_old\n\n\n\n\nEast (Balkans/Greece)\n54\n1234.5\n48.5\n23.0\n41.6\n\n\nNorth (Gaul/Alps)\n26\n661.5\n42.3\n31.7\n34.2\n\n\nSouth (Africa/Sicily)\n3\n526.8\n25.7\n51.7\n12.8\n\n\nWest (Iberia/Sardinia)\n58\n1501.0\n40.7\n30.1\n30.6\n\n\n\n\n\n\n\nCode\nggplot(hex_age, aes(x = region, y = mean_age, fill = region)) +\n  geom_boxplot(alpha = 0.7) +\n  geom_jitter(aes(size = n_types), alpha = 0.3, width = 0.2) +\n  scale_fill_brewer(palette = \"Set2\") +\n  scale_size_continuous(name = \"Sample size\", range = c(1, 6)) +\n  labs(\n    title = \"Circulation Age by Region\",\n    subtitle = \"Which directions from Rome had older coins?\",\n    x = NULL,\n    y = \"Mean circulation age (years)\"\n  ) +\n  theme(legend.position = \"right\")"
  },
  {
    "objectID": "lrr_temporal.html",
    "href": "lrr_temporal.html",
    "title": "Temporal Stratification of Compositional LRR",
    "section": "",
    "text": "The compositional LRR analysis revealed meaningful spatial variation in Rome’s monetary penetration, but the aggregate view collapses ~500 years of Roman history into a single surface. Temporal stratification asks: How did the geography of Rome-mint penetration change over time?\nWe use Terminus Post Quem (TPQ) — the deposition date — rather than mint date because:\n\nHoards are discrete events — each deposition is a single observation in space-time\nDeposition reflects system states — hoarding behavior responds to crises, uncertainty, and monetary conditions\nAligns with HMM framework — we need sequential observations of “did hoards get deposited in region r during period t?”\n\n\n\n\nThe following periods are defined based on major transitions in Roman political economy:\n\n\n\n\n\n\n\n\n\nPeriod\nTPQ Range\nLabel\nHistorical Context\n\n\n\n\n1\nbefore 150 BCE\nEarly Republic\nPre-Gracchan era; limited monetization outside Italy; aftermath of Punic Wars\n\n\n2\n150–100 BCE\nLate Republic I\nGracchan reforms; provincial expansion; Italian allied coinage still circulating\n\n\n3\n100–50 BCE\nLate Republic II\nSocial War aftermath; Sullan era; rise of military dynasts; civil wars begin\n\n\n4\n50 BCE – 14 CE\nTriumviral/Augustan\nCaesar to Augustus; end of Republic; monetary consolidation under Principate\n\n\n5\nafter 14 CE\nEarly Imperial\nJulio-Claudian dynasty; if data permits\n\n\n\nThese bins balance historical coherence with sufficient sample size per period."
  },
  {
    "objectID": "lrr_temporal.html#why-stratify-by-tpq",
    "href": "lrr_temporal.html#why-stratify-by-tpq",
    "title": "Temporal Stratification of Compositional LRR",
    "section": "",
    "text": "The compositional LRR analysis revealed meaningful spatial variation in Rome’s monetary penetration, but the aggregate view collapses ~500 years of Roman history into a single surface. Temporal stratification asks: How did the geography of Rome-mint penetration change over time?\nWe use Terminus Post Quem (TPQ) — the deposition date — rather than mint date because:\n\nHoards are discrete events — each deposition is a single observation in space-time\nDeposition reflects system states — hoarding behavior responds to crises, uncertainty, and monetary conditions\nAligns with HMM framework — we need sequential observations of “did hoards get deposited in region r during period t?”"
  },
  {
    "objectID": "lrr_temporal.html#tpq-period-definitions",
    "href": "lrr_temporal.html#tpq-period-definitions",
    "title": "Temporal Stratification of Compositional LRR",
    "section": "",
    "text": "The following periods are defined based on major transitions in Roman political economy:\n\n\n\n\n\n\n\n\n\nPeriod\nTPQ Range\nLabel\nHistorical Context\n\n\n\n\n1\nbefore 150 BCE\nEarly Republic\nPre-Gracchan era; limited monetization outside Italy; aftermath of Punic Wars\n\n\n2\n150–100 BCE\nLate Republic I\nGracchan reforms; provincial expansion; Italian allied coinage still circulating\n\n\n3\n100–50 BCE\nLate Republic II\nSocial War aftermath; Sullan era; rise of military dynasts; civil wars begin\n\n\n4\n50 BCE – 14 CE\nTriumviral/Augustan\nCaesar to Augustus; end of Republic; monetary consolidation under Principate\n\n\n5\nafter 14 CE\nEarly Imperial\nJulio-Claudian dynasty; if data permits\n\n\n\nThese bins balance historical coherence with sufficient sample size per period."
  },
  {
    "objectID": "lrr_temporal.html#parse-tpq-and-create-period-bins",
    "href": "lrr_temporal.html#parse-tpq-and-create-period-bins",
    "title": "Temporal Stratification of Compositional LRR",
    "section": "4.1 Parse TPQ and Create Period Bins",
    "text": "4.1 Parse TPQ and Create Period Bins\n\n\nCode\n# Flag Rome vs non-Rome\nchrr_flagged &lt;- chrr_raw %&gt;%\n  mutate(\n    is_rome = mint_id == \"rome\" | str_detect(mint_uri, \"/id/rome$\"),\n    is_rome = replace_na(is_rome, FALSE)\n  )\n\n# Parse TPQ to numeric year\nchrr_temporal &lt;- chrr_flagged %&gt;%\n  mutate(\n    tpq_raw = as.character(hoard_tpq),\n    tpq_year = readr::parse_number(tpq_raw)\n  )\n\n# Check TPQ coverage\ntpq_coverage &lt;- chrr_temporal %&gt;%\n  summarise(\n    total_rows = n(),\n    rows_with_tpq = sum(!is.na(tpq_year)),\n    pct_with_tpq = round(100 * rows_with_tpq / total_rows, 1),\n    tpq_min = min(tpq_year, na.rm = TRUE),\n    tpq_max = max(tpq_year, na.rm = TRUE)\n  )\n\nkable(tpq_coverage, caption = \"TPQ coverage in dataset\")\n\n\n\nTPQ coverage in dataset\n\n\ntotal_rows\nrows_with_tpq\npct_with_tpq\ntpq_min\ntpq_max\n\n\n\n\n31951\n31836\n99.6\n-195\n14"
  },
  {
    "objectID": "lrr_temporal.html#define-period-bins",
    "href": "lrr_temporal.html#define-period-bins",
    "title": "Temporal Stratification of Compositional LRR",
    "section": "4.2 Define Period Bins",
    "text": "4.2 Define Period Bins\n\n\nCode\n# Period definitions\nperiod_breaks &lt;- c(-Inf, -150, -100, -50, 14, Inf)\nperiod_labels &lt;- c(\n  \"1: Early Republic (pre-150 BCE)\",\n  \"2: Late Republic I (150-100 BCE)\",\n  \"3: Late Republic II (100-50 BCE)\",\n  \"4: Triumviral/Augustan (50 BCE-14 CE)\",\n  \"5: Early Imperial (post-14 CE)\"\n)\n\n# Assign periods\nchrr_temporal &lt;- chrr_temporal %&gt;%\n  mutate(\n    tpq_period = cut(\n      tpq_year,\n      breaks = period_breaks,\n      labels = period_labels,\n      right = TRUE\n    ),\n    tpq_period_num = as.integer(tpq_period)\n  )\n\n# Period summary\nperiod_summary &lt;- chrr_temporal %&gt;%\n  filter(!is.na(tpq_period)) %&gt;%\n  group_by(tpq_period) %&gt;%\n  summarise(\n    n_rows = n(),\n    n_hoards = n_distinct(hoard_id),\n    n_rome = sum(is_rome),\n    n_non_rome = sum(!is_rome),\n    pct_rome = round(100 * n_rome / n_rows, 1),\n    .groups = \"drop\"\n  )\n\nkable(period_summary, \n      col.names = c(\"Period\", \"Rows\", \"Hoards\", \"Rome\", \"Non-Rome\", \"Rome %\"),\n      caption = \"Data distribution by TPQ period\")\n\n\n\nData distribution by TPQ period\n\n\n\n\n\n\n\n\n\n\nPeriod\nRows\nHoards\nRome\nNon-Rome\nRome %\n\n\n\n\n1: Early Republic (pre-150 BCE)\n185\n11\n106\n79\n57.3\n\n\n2: Late Republic I (150-100 BCE)\n4476\n91\n4229\n247\n94.5\n\n\n3: Late Republic II (100-50 BCE)\n10237\n173\n9670\n567\n94.5\n\n\n4: Triumviral/Augustan (50 BCE-14 CE)\n16938\n215\n14062\n2876\n83.0"
  },
  {
    "objectID": "lrr_temporal.html#visualize-tpq-distribution",
    "href": "lrr_temporal.html#visualize-tpq-distribution",
    "title": "Temporal Stratification of Compositional LRR",
    "section": "4.3 Visualize TPQ Distribution",
    "text": "4.3 Visualize TPQ Distribution\n\n\nCode\n# Hoard-level TPQ for cleaner visualization\nhoard_tpq &lt;- chrr_temporal %&gt;%\n  filter(!is.na(tpq_year)) %&gt;%\n  distinct(hoard_id, tpq_year, tpq_period)\n\nggplot(hoard_tpq, aes(x = tpq_year, fill = tpq_period)) +\n\ngeom_histogram(binwidth = 10, color = \"white\", alpha = 0.8) +\n  geom_vline(xintercept = c(-150, -100, -50, 14), \n             linetype = \"dashed\", color = \"grey30\") +\n  scale_fill_viridis_d(name = \"Period\", option = \"plasma\") +\n  labs(\n    title = \"Hoard Deposition Chronology (TPQ)\",\n    subtitle = \"Vertical lines mark period boundaries\",\n    x = \"TPQ (year)\",\n    y = \"Number of hoards\"\n  ) +\n  theme(legend.position = \"bottom\")"
  },
  {
    "objectID": "lrr_temporal.html#convert-to-spatial-object",
    "href": "lrr_temporal.html#convert-to-spatial-object",
    "title": "Temporal Stratification of Compositional LRR",
    "section": "5.1 Convert to Spatial Object",
    "text": "5.1 Convert to Spatial Object\n\n\nCode\nhoard_sf &lt;- st_as_sf(\n  hoard_comp,\n  coords = c(\"hoard_long\", \"hoard_lat\"),\n  crs = 4326,\n  remove = FALSE\n)"
  },
  {
    "objectID": "lrr_temporal.html#study-window-and-projection",
    "href": "lrr_temporal.html#study-window-and-projection",
    "title": "Temporal Stratification of Compositional LRR",
    "section": "6.1 Study Window and Projection",
    "text": "6.1 Study Window and Projection\n\n\nCode\nlibrary(rnaturalearth)\nlibrary(rnaturalearthdata)\n\n# Land polygons\nland &lt;- ne_countries(scale = \"medium\", returnclass = \"sf\") %&gt;%\n  st_union()\n\n# Valid geometries only\nhoard_sf_valid &lt;- hoard_sf %&gt;%\n  filter(!st_is_empty(geometry))\n\n# Bounding box\nhoard_bbox &lt;- st_bbox(hoard_sf_valid)\n\nif (any(is.na(hoard_bbox))) {\n  hoard_bbox &lt;- c(xmin = -10, ymin = 30, xmax = 45, ymax = 55)\n  names(hoard_bbox) &lt;- c(\"xmin\", \"ymin\", \"xmax\", \"ymax\")\n}\n\npad &lt;- 2\n\n# Study extent\nstudy_extent &lt;- st_polygon(list(rbind(\n  c(hoard_bbox[\"xmin\"] - pad, hoard_bbox[\"ymin\"] - pad),\n  c(hoard_bbox[\"xmax\"] + pad, hoard_bbox[\"ymin\"] - pad),\n  c(hoard_bbox[\"xmax\"] + pad, hoard_bbox[\"ymax\"] + pad),\n  c(hoard_bbox[\"xmin\"] - pad, hoard_bbox[\"ymax\"] + pad),\n  c(hoard_bbox[\"xmin\"] - pad, hoard_bbox[\"ymin\"] - pad)\n))) %&gt;%\n  st_sfc(crs = 4326)\n\nstudy_land &lt;- st_intersection(land, study_extent)\n\n# Project\ntarget_crs &lt;- 3035\nhoard_sf_proj &lt;- st_transform(hoard_sf_valid, target_crs)\nstudy_land_proj &lt;- st_transform(study_land, target_crs)\n\nrome_mint &lt;- st_as_sf(\n  tibble(name = \"Rome\", lon = 12.4964, lat = 41.9028),\n  coords = c(\"lon\", \"lat\"),\n  crs = 4326\n) %&gt;%\n  st_transform(target_crs)\n\nhoard_sf &lt;- hoard_sf_valid"
  },
  {
    "objectID": "lrr_temporal.html#hexagonal-grid-100-km",
    "href": "lrr_temporal.html#hexagonal-grid-100-km",
    "title": "Temporal Stratification of Compositional LRR",
    "section": "6.2 Hexagonal Grid (100 km)",
    "text": "6.2 Hexagonal Grid (100 km)\n\n\nCode\nhex_size &lt;- 100000  # 100 km\n\nhex_grid &lt;- st_make_grid(\n  study_land_proj,\n  cellsize = hex_size,\n  square = FALSE\n) %&gt;%\n  st_sf(hex_id = seq_along(.), geometry = .) %&gt;%\n  st_set_crs(target_crs)\n\n# Land filter\nhex_land &lt;- hex_grid %&gt;%\n  filter(lengths(st_intersects(., study_land_proj)) &gt; 0)\n\nhex_centroids &lt;- st_centroid(hex_land)\non_land &lt;- lengths(st_intersects(hex_centroids, study_land_proj)) &gt; 0\nhex_land &lt;- hex_land[on_land, ]\n\ncat(\"Hexes on land:\", nrow(hex_land), \"\\n\")\n\n\nHexes on land: 859"
  },
  {
    "objectID": "lrr_temporal.html#assign-hoards-to-hexes",
    "href": "lrr_temporal.html#assign-hoards-to-hexes",
    "title": "Temporal Stratification of Compositional LRR",
    "section": "7.1 Assign Hoards to Hexes",
    "text": "7.1 Assign Hoards to Hexes\n\n\nCode\nhoard_hex &lt;- st_join(hoard_sf_proj, hex_land, join = st_within) %&gt;%\n  filter(!is.na(hex_id))\n\ncat(\"Hoards assigned to hexes:\", nrow(hoard_hex), \"\\n\")\n\n\nHoards assigned to hexes: 401"
  },
  {
    "objectID": "lrr_temporal.html#compute-lrr-by-period-and-hex",
    "href": "lrr_temporal.html#compute-lrr-by-period-and-hex",
    "title": "Temporal Stratification of Compositional LRR",
    "section": "7.2 Compute LRR by Period and Hex",
    "text": "7.2 Compute LRR by Period and Hex\n\n\nCode\n# Global Rome proportion (all periods combined)\np_global &lt;- sum(hoard_hex$n_rome) / sum(hoard_hex$n_types)\ncat(\"Global Rome proportion:\", round(p_global * 100, 2), \"%\\n\\n\")\n\n\nGlobal Rome proportion: 88.26 %\n\n\nCode\n# Aggregate by hex AND period\nhex_period_comp &lt;- hoard_hex %&gt;%\n  st_drop_geometry() %&gt;%\n  group_by(hex_id, tpq_period, tpq_period_num) %&gt;%\n  summarise(\n    n_hoards = n(),\n    total_types = sum(n_types),\n    rome_types = sum(n_rome),\n    non_rome_types = sum(n_non_rome),\n    p_rome = rome_types / total_types,\n    .groups = \"drop\"\n  )\n\n# Period-specific global proportions\nperiod_globals &lt;- hex_period_comp %&gt;%\n  group_by(tpq_period, tpq_period_num) %&gt;%\n  summarise(\n    p_rome_period = sum(rome_types) / sum(total_types),\n    .groups = \"drop\"\n  )\n\nkable(period_globals, \n      col.names = c(\"Period\", \"Period Num\", \"Rome % (period)\"),\n      digits = 3,\n      caption = \"Global Rome proportion by period\")\n\n\n\nGlobal Rome proportion by period\n\n\nPeriod\nPeriod Num\nRome % (period)\n\n\n\n\n1: Early Republic (pre-150 BCE)\n1\n0.590\n\n\n2: Late Republic I (150-100 BCE)\n2\n0.942\n\n\n3: Late Republic II (100-50 BCE)\n3\n0.945\n\n\n4: Triumviral/Augustan (50 BCE-14 CE)\n4\n0.835\n\n\n\n\n\nCode\n# Join period globals and compute LRR\nepsilon &lt;- 0.5\n\nhex_period_lrr &lt;- hex_period_comp %&gt;%\n  left_join(period_globals, by = c(\"tpq_period\", \"tpq_period_num\")) %&gt;%\n  mutate(\n    # LRR relative to period-specific global\n    LRR_period = log((rome_types + epsilon) / (total_types + epsilon)) - log(p_rome_period),\n    \n    # LRR relative to overall global\n    LRR_global = log((rome_types + epsilon) / (total_types + epsilon)) - log(p_global),\n    \n    # Rome vs non-Rome contrast\n    LRR_contrast = ifelse(\n      non_rome_types &gt; 0,\n      log((rome_types + epsilon) / (non_rome_types + epsilon)),\n      NA_real_\n    )\n  )"
  },
  {
    "objectID": "lrr_temporal.html#summary-statistics-by-period",
    "href": "lrr_temporal.html#summary-statistics-by-period",
    "title": "Temporal Stratification of Compositional LRR",
    "section": "7.3 Summary Statistics by Period",
    "text": "7.3 Summary Statistics by Period\n\n\nCode\nlrr_period_stats &lt;- hex_period_lrr %&gt;%\n  group_by(tpq_period) %&gt;%\n  summarise(\n    n_hexes = n(),\n    total_hoards = sum(n_hoards),\n    lrr_mean = round(mean(LRR_period, na.rm = TRUE), 3),\n    lrr_sd = round(sd(LRR_period, na.rm = TRUE), 3),\n    p_rome_mean = round(mean(p_rome, na.rm = TRUE), 3),\n    .groups = \"drop\"\n  )\n\nkable(lrr_period_stats,\n      col.names = c(\"Period\", \"Hexes\", \"Hoards\", \"LRR Mean\", \"LRR SD\", \"Rome % Mean\"),\n      caption = \"LRR summary by period\")\n\n\n\nLRR summary by period\n\n\n\n\n\n\n\n\n\n\nPeriod\nHexes\nHoards\nLRR Mean\nLRR SD\nRome % Mean\n\n\n\n\n1: Early Republic (pre-150 BCE)\n10\n10\n0.121\n0.272\n0.681\n\n\n2: Late Republic I (150-100 BCE)\n42\n69\n0.008\n0.041\n0.950\n\n\n3: Late Republic II (100-50 BCE)\n74\n142\n0.006\n0.038\n0.951\n\n\n4: Triumviral/Augustan (50 BCE-14 CE)\n91\n180\n-0.045\n0.210\n0.807"
  },
  {
    "objectID": "lrr_temporal.html#prepare-map-data",
    "href": "lrr_temporal.html#prepare-map-data",
    "title": "Temporal Stratification of Compositional LRR",
    "section": "8.1 Prepare Map Data",
    "text": "8.1 Prepare Map Data\n\n\nCode\n# Join LRR back to hex geometry\nhex_period_sf &lt;- hex_land %&gt;%\n  inner_join(hex_period_lrr, by = \"hex_id\") %&gt;%\n  st_transform(4326)\n\n# Reference layers in WGS84\nland_wgs &lt;- st_transform(study_land_proj, 4326)\nrome_wgs &lt;- st_transform(rome_mint, 4326)\n\n# Get periods present in data\nperiods_present &lt;- sort(unique(hex_period_sf$tpq_period_num))\ncat(\"Periods with data:\", paste(periods_present, collapse = \", \"), \"\\n\")\n\n\nPeriods with data: 1, 2, 3, 4"
  },
  {
    "objectID": "lrr_temporal.html#faceted-lrr-map-all-periods",
    "href": "lrr_temporal.html#faceted-lrr-map-all-periods",
    "title": "Temporal Stratification of Compositional LRR",
    "section": "8.2 Faceted LRR Map (All Periods)",
    "text": "8.2 Faceted LRR Map (All Periods)\n\n\nCode\nggplot() +\n  geom_sf(data = land_wgs, fill = \"grey95\", color = \"grey80\") +\n  geom_sf(\n    data = hex_period_sf,\n    aes(fill = LRR_period),\n    color = \"grey50\",\n    linewidth = 0.15\n  ) +\n  geom_sf(data = rome_wgs, color = \"black\", shape = 8, size = 3, stroke = 1) +\n  scale_fill_gradient2(\n    low = \"steelblue\",\n    mid = \"white\",\n    high = \"darkred\",\n    midpoint = 0,\n    name = \"LRR\",\n    limits = c(-0.6, 0.6),\n    oob = scales::squish\n  ) +\n  coord_sf(\n    xlim = c(hoard_bbox[\"xmin\"] - 1, hoard_bbox[\"xmax\"] + 1),\n    ylim = c(hoard_bbox[\"ymin\"] - 1, hoard_bbox[\"ymax\"] + 1)\n  ) +\n  facet_wrap(~tpq_period, ncol = 3) +\n  labs(\n    title = \"Compositional LRR by Deposition Period\",\n    subtitle = \"Red = above period average | Blue = below period average | Star = Rome mint\",\n    caption = \"LRR computed relative to period-specific global proportion\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text = element_blank(),\n    axis.title = element_blank(),\n    strip.text = element_text(size = 9, face = \"bold\"),\n    legend.position = \"right\"\n  )"
  },
  {
    "objectID": "lrr_temporal.html#individual-period-maps",
    "href": "lrr_temporal.html#individual-period-maps",
    "title": "Temporal Stratification of Compositional LRR",
    "section": "8.3 Individual Period Maps",
    "text": "8.3 Individual Period Maps\n\n\nCode\n# Create individual maps for each period\nperiod_maps &lt;- map(sort(unique(hex_period_sf$tpq_period)), function(p) {\n  \n  period_data &lt;- hex_period_sf %&gt;% filter(tpq_period == p)\n  n_hoards &lt;- sum(period_data$n_hoards)\n  n_hexes &lt;- nrow(period_data)\n  \n  ggplot() +\n    geom_sf(data = land_wgs, fill = \"grey95\", color = \"grey80\") +\n    geom_sf(\n      data = period_data,\n      aes(fill = LRR_period),\n      color = \"grey50\",\n      linewidth = 0.2\n    ) +\n    geom_sf(data = rome_wgs, color = \"black\", shape = 8, size = 4, stroke = 1.2) +\n    scale_fill_gradient2(\n      low = \"steelblue\",\n      mid = \"white\", \n      high = \"darkred\",\n      midpoint = 0,\n      name = \"LRR\",\n      limits = c(-0.6, 0.6),\n      oob = scales::squish\n    ) +\n    coord_sf(\n      xlim = c(hoard_bbox[\"xmin\"] - 1, hoard_bbox[\"xmax\"] + 1),\n      ylim = c(hoard_bbox[\"ymin\"] - 1, hoard_bbox[\"ymax\"] + 1)\n    ) +\n    labs(\n      title = p,\n      subtitle = paste(n_hoards, \"hoards in\", n_hexes, \"hexes\")\n    ) +\n    theme_minimal() +\n    theme(\n      axis.text = element_blank(),\n      axis.title = element_blank(),\n      legend.position = \"none\",\n      plot.title = element_text(size = 11, face = \"bold\")\n    )\n})\n\n# Combine with shared legend\nwrap_plots(period_maps, ncol = 2) +\n  plot_annotation(\n    title = \"Rome Mint Penetration by Deposition Period\",\n    subtitle = \"LRR relative to period-specific global proportion\",\n    theme = theme(plot.title = element_text(size = 14, face = \"bold\"))\n  )"
  },
  {
    "objectID": "lrr_temporal.html#rome-proportion-maps-by-period",
    "href": "lrr_temporal.html#rome-proportion-maps-by-period",
    "title": "Temporal Stratification of Compositional LRR",
    "section": "8.4 Rome Proportion Maps by Period",
    "text": "8.4 Rome Proportion Maps by Period\n\n\nCode\nggplot() +\n  geom_sf(data = land_wgs, fill = \"grey95\", color = \"grey80\") +\n  geom_sf(\n    data = hex_period_sf,\n    aes(fill = p_rome),\n    color = \"grey50\",\n    linewidth = 0.15\n  ) +\n  geom_sf(data = rome_wgs, color = \"black\", shape = 8, size = 3, stroke = 1) +\n  scale_fill_viridis_c(\n    name = \"Rome %\",\n    labels = scales::percent_format(),\n    option = \"plasma\",\n    limits = c(0.5, 1),\n    oob = scales::squish\n  ) +\n  coord_sf(\n    xlim = c(hoard_bbox[\"xmin\"] - 1, hoard_bbox[\"xmax\"] + 1),\n    ylim = c(hoard_bbox[\"ymin\"] - 1, hoard_bbox[\"ymax\"] + 1)\n  ) +\n  facet_wrap(~tpq_period, ncol = 3) +\n  labs(\n    title = \"Rome Mint Proportion by Deposition Period\",\n    subtitle = \"Raw proportion of coin-types from Rome mint\",\n    caption = \"Star = Rome mint location\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text = element_blank(),\n    axis.title = element_blank(),\n    strip.text = element_text(size = 9, face = \"bold\"),\n    legend.position = \"right\"\n  )"
  },
  {
    "objectID": "lrr_temporal.html#rome-proportion-over-time",
    "href": "lrr_temporal.html#rome-proportion-over-time",
    "title": "Temporal Stratification of Compositional LRR",
    "section": "9.1 Rome Proportion Over Time",
    "text": "9.1 Rome Proportion Over Time\n\n\nCode\n# Period-level summary with confidence intervals\nperiod_trend &lt;- hex_period_lrr %&gt;%\n  group_by(tpq_period, tpq_period_num) %&gt;%\n  summarise(\n    n_hexes = n(),\n    total_types = sum(total_types),\n    rome_types = sum(rome_types),\n    p_rome = rome_types / total_types,\n    .groups = \"drop\"\n  ) %&gt;%\n  mutate(\n    # Binomial SE\n    se_p = sqrt(p_rome * (1 - p_rome) / total_types),\n    ci_lower = p_rome - 1.96 * se_p,\n    ci_upper = p_rome + 1.96 * se_p\n  )\n\nggplot(period_trend, aes(x = tpq_period_num, y = p_rome)) +\n  geom_ribbon(aes(ymin = ci_lower, ymax = ci_upper), alpha = 0.3, fill = \"steelblue\") +\n  geom_line(linewidth = 1.2, color = \"steelblue\") +\n  geom_point(size = 4, color = \"steelblue\") +\n  geom_hline(yintercept = p_global, linetype = \"dashed\", color = \"grey50\") +\n  scale_x_continuous(\n    breaks = period_trend$tpq_period_num,\n    labels = c(\"Early\\nRepublic\", \"Late Rep I\\n150-100\", \"Late Rep II\\n100-50\", \n               \"Triumviral/\\nAugustan\", \"Early\\nImperial\")[1:nrow(period_trend)]\n  ) +\n  scale_y_continuous(labels = scales::percent_format(), limits = c(0.7, 1)) +\n  labs(\n    title = \"Rome Mint Proportion Over Time\",\n    subtitle = \"Aggregate proportion across all hexes | Shaded = 95% CI\",\n    x = \"Period\",\n    y = \"Rome proportion\",\n    caption = \"Dashed line = overall global proportion\"\n  )"
  },
  {
    "objectID": "lrr_temporal.html#spatial-spread-over-time",
    "href": "lrr_temporal.html#spatial-spread-over-time",
    "title": "Temporal Stratification of Compositional LRR",
    "section": "9.2 Spatial Spread Over Time",
    "text": "9.2 Spatial Spread Over Time\n\n\nCode\n# Count hexes with data per period\nspatial_extent &lt;- hex_period_lrr %&gt;%\n  group_by(tpq_period, tpq_period_num) %&gt;%\n  summarise(\n    n_hexes = n_distinct(hex_id),\n    n_hoards = sum(n_hoards),\n    .groups = \"drop\"\n  )\n\nggplot(spatial_extent, aes(x = tpq_period_num)) +\n  geom_col(aes(y = n_hexes, fill = \"Hexes with data\"), alpha = 0.7, width = 0.6) +\n  geom_line(aes(y = n_hoards / 5, color = \"Hoards (scaled)\"), linewidth = 1.2) +\n  geom_point(aes(y = n_hoards / 5, color = \"Hoards (scaled)\"), size = 3) +\n  scale_x_continuous(\n    breaks = spatial_extent$tpq_period_num,\n    labels = c(\"Early\\nRepublic\", \"Late Rep I\", \"Late Rep II\", \n               \"Triumviral/\\nAugustan\", \"Early\\nImperial\")[1:nrow(spatial_extent)]\n  ) +\n  scale_y_continuous(\n    name = \"Number of hexes\",\n    sec.axis = sec_axis(~. * 5, name = \"Number of hoards\")\n  ) +\n  scale_fill_manual(values = c(\"Hexes with data\" = \"steelblue\"), name = NULL) +\n  scale_color_manual(values = c(\"Hoards (scaled)\" = \"darkred\"), name = NULL) +\n  labs(\n    title = \"Spatial Extent of Hoard Deposition Over Time\",\n    subtitle = \"Geographic spread of Rome-mint containing hoards\",\n    x = \"Period\"\n  ) +\n  theme(legend.position = \"bottom\")"
  },
  {
    "objectID": "lrr_temporal.html#binomial-regression-by-period",
    "href": "lrr_temporal.html#binomial-regression-by-period",
    "title": "Temporal Stratification of Compositional LRR",
    "section": "10.1 Binomial Regression by Period",
    "text": "10.1 Binomial Regression by Period\n\n\nCode\n# Add hex centroid coordinates\nhex_centroids_wgs &lt;- hex_land %&gt;%\n  st_centroid() %&gt;%\n  st_transform(4326)\n\ncent_coords &lt;- st_coordinates(hex_centroids_wgs)\n\nhex_coords &lt;- tibble(\n  hex_id = hex_land$hex_id,\n  cent_lon = cent_coords[, 1],\n  cent_lat = cent_coords[, 2]\n)\n\nrome_coords &lt;- c(12.4964, 41.9028)\n\nhex_coords &lt;- hex_coords %&gt;%\n  mutate(\n    dist_rome_km = sqrt((cent_lon - rome_coords[1])^2 + (cent_lat - rome_coords[2])^2) * 111\n  )\n\n# Join distance to period data\nhex_period_dist &lt;- hex_period_lrr %&gt;%\n  left_join(hex_coords, by = \"hex_id\")\n\n# Fit binomial model by period\ndistance_models &lt;- hex_period_dist %&gt;%\n  filter(!is.na(dist_rome_km)) %&gt;%\n  group_by(tpq_period, tpq_period_num) %&gt;%\n  nest() %&gt;%\n  mutate(\n    model = map(data, ~glm(\n      cbind(rome_types, non_rome_types) ~ dist_rome_km,\n      family = binomial(link = \"logit\"),\n      data = .x\n    )),\n    tidy = map(model, broom::tidy)\n  ) %&gt;%\n  unnest(tidy) %&gt;%\n  filter(term == \"dist_rome_km\") %&gt;%\n  select(tpq_period, tpq_period_num, estimate, std.error, p.value) %&gt;%\n  mutate(\n    or_100km = exp(estimate * 100),\n    sig = ifelse(p.value &lt; 0.05, \"*\", \"\")\n  )\n\nkable(distance_models,\n      col.names = c(\"Period\", \"Num\", \"Coefficient\", \"SE\", \"p-value\", \"OR per 100km\", \"Sig\"),\n      digits = c(0, 0, 6, 6, 4, 4, 0),\n      caption = \"Distance effect on Rome proportion by period (* = p &lt; 0.05)\")\n\n\n\nDistance effect on Rome proportion by period (* = p &lt; 0.05)\n\n\n\n\n\n\n\n\n\n\n\nPeriod\nNum\nCoefficient\nSE\np-value\nOR per 100km\nSig\n\n\n\n\n2: Late Republic I (150-100 BCE)\n2\n0.000425\n0.000091\n0.0000\n1.0435\n*\n\n\n3: Late Republic II (100-50 BCE)\n3\n0.000047\n0.000074\n0.5233\n1.0048\n\n\n\n4: Triumviral/Augustan (50 BCE-14 CE)\n4\n-0.000090\n0.000035\n0.0100\n0.9910\n*\n\n\n1: Early Republic (pre-150 BCE)\n1\n0.000072\n0.000272\n0.7910\n1.0072"
  },
  {
    "objectID": "lrr_temporal.html#distance-effect-visualization",
    "href": "lrr_temporal.html#distance-effect-visualization",
    "title": "Temporal Stratification of Compositional LRR",
    "section": "10.2 Distance Effect Visualization",
    "text": "10.2 Distance Effect Visualization\n\n\nCode\n# Create predicted curves for each period\npred_curves &lt;- hex_period_dist %&gt;%\n  filter(!is.na(dist_rome_km)) %&gt;%\n  group_by(tpq_period, tpq_period_num) %&gt;%\n  nest() %&gt;%\n  mutate(\n    model = map(data, ~glm(\n      cbind(rome_types, non_rome_types) ~ dist_rome_km,\n      family = binomial(link = \"logit\"),\n      data = .x\n    )),\n    pred_data = map(data, ~tibble(\n      dist_rome_km = seq(0, max(.x$dist_rome_km, na.rm = TRUE), length.out = 100)\n    )),\n    predictions = map2(model, pred_data, ~mutate(.y, \n      p_rome_pred = predict(.x, newdata = .y, type = \"response\")\n    ))\n  ) %&gt;%\n  select(tpq_period, tpq_period_num, predictions) %&gt;%\n  unnest(predictions)\n\n# Plot\nggplot() +\n  geom_point(\n    data = hex_period_dist,\n    aes(x = dist_rome_km, y = p_rome, size = total_types),\n    alpha = 0.4,\n    color = \"steelblue\"\n  ) +\n  geom_line(\n    data = pred_curves,\n    aes(x = dist_rome_km, y = p_rome_pred),\n    color = \"darkred\",\n    linewidth = 1\n  ) +\n  facet_wrap(~tpq_period, ncol = 3) +\n  scale_y_continuous(labels = scales::percent_format(), limits = c(0.4, 1)) +\n  scale_size_continuous(name = \"Sample size\", range = c(1, 8)) +\n  labs(\n    title = \"Rome Proportion vs. Distance by Period\",\n    subtitle = \"Red line = binomial regression fit\",\n    x = \"Distance from Rome (km)\",\n    y = \"Rome proportion\"\n  ) +\n  theme(\n    legend.position = \"bottom\",\n    strip.text = element_text(size = 9, face = \"bold\")\n  )"
  },
  {
    "objectID": "lrr_temporal.html#interpretation-notes",
    "href": "lrr_temporal.html#interpretation-notes",
    "title": "Temporal Stratification of Compositional LRR",
    "section": "12.1 Interpretation Notes",
    "text": "12.1 Interpretation Notes\nSpatial variation (LRR SD): Higher values indicate more geographic heterogeneity in Rome’s penetration during that period.\nDistance effect (OR per 100km): Values below 1 indicate Rome proportion decreases with distance; closer to 1 means distance matters less.\nChanges over time: Compare whether Rome’s monetary reach became more uniform (lower SD, OR→1) or more differentiated (higher SD, OR&lt;1) across periods."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "John Glendenning",
    "section": "",
    "text": "I am a masters student studying geographical information systems.\n\nContact\njmg220005@utdallas.edu"
  },
  {
    "objectID": "directional_flow.html",
    "href": "directional_flow.html",
    "title": "Directional Flow Analysis: Anisotropic Monetary Reach",
    "section": "",
    "text": "Previous analyses tested whether Rome’s monetary penetration declined with distance. But distance alone assumes isotropic diffusion—equal spread in all directions.\nReal monetary circulation likely followed:\n\nTrade routes (coastal, river valleys)\nMilitary roads (Via Appia, Via Egnatia)\nGeographic barriers (Alps, sea crossings)\n\n\n\n\n\nWas Rome’s reach isotropic? Or did coins flow preferentially in certain directions?\nWhich directions showed strongest Rome penetration?\nDid directional patterns change across monetary regimes?\nCan we identify likely circulation corridors?\n\n\n\n\n\nPolar decomposition: Convert hex positions to (distance, bearing) from Rome\nDirectional regression: Test Rome % ~ distance * direction interactions\nSector analysis: Compare Rome penetration across geographic sectors\nRegime comparison: Test whether anisotropy differs pre/post transition"
  },
  {
    "objectID": "directional_flow.html#beyond-radial-distance",
    "href": "directional_flow.html#beyond-radial-distance",
    "title": "Directional Flow Analysis: Anisotropic Monetary Reach",
    "section": "",
    "text": "Previous analyses tested whether Rome’s monetary penetration declined with distance. But distance alone assumes isotropic diffusion—equal spread in all directions.\nReal monetary circulation likely followed:\n\nTrade routes (coastal, river valleys)\nMilitary roads (Via Appia, Via Egnatia)\nGeographic barriers (Alps, sea crossings)"
  },
  {
    "objectID": "directional_flow.html#research-questions",
    "href": "directional_flow.html#research-questions",
    "title": "Directional Flow Analysis: Anisotropic Monetary Reach",
    "section": "",
    "text": "Was Rome’s reach isotropic? Or did coins flow preferentially in certain directions?\nWhich directions showed strongest Rome penetration?\nDid directional patterns change across monetary regimes?\nCan we identify likely circulation corridors?"
  },
  {
    "objectID": "directional_flow.html#analytical-approach",
    "href": "directional_flow.html#analytical-approach",
    "title": "Directional Flow Analysis: Anisotropic Monetary Reach",
    "section": "",
    "text": "Polar decomposition: Convert hex positions to (distance, bearing) from Rome\nDirectional regression: Test Rome % ~ distance * direction interactions\nSector analysis: Compare Rome penetration across geographic sectors\nRegime comparison: Test whether anisotropy differs pre/post transition"
  },
  {
    "objectID": "directional_flow.html#add-regime-assignment",
    "href": "directional_flow.html#add-regime-assignment",
    "title": "Directional Flow Analysis: Anisotropic Monetary Reach",
    "section": "4.1 Add Regime Assignment",
    "text": "4.1 Add Regime Assignment\n\n\nCode\nperiod_breaks &lt;- c(-Inf, -150, -100, -50, 14, Inf)\n\nhoard_polar &lt;- hoard_polar %&gt;%\n  mutate(\n    tpq_period = cut(tpq_year, breaks = period_breaks,\n                     labels = c(\"1: Early Republic\", \"2: Late Republic I\",\n                               \"3: Late Republic II\", \"4: Triumviral/Augustan\",\n                               \"5: Early Imperial\"),\n                     right = TRUE),\n    regime = case_when(\n      tpq_year &lt; -100 ~ \"Pre-transition\",\n      tpq_year &gt;= -100 & tpq_year &lt; -50 ~ \"Transition\",\n      tpq_year &gt;= -50 ~ \"Post-transition\"\n    )\n  ) %&gt;%\n  filter(!is.na(tpq_period))"
  },
  {
    "objectID": "directional_flow.html#polar-plot-hoards-by-bearing-and-distance",
    "href": "directional_flow.html#polar-plot-hoards-by-bearing-and-distance",
    "title": "Directional Flow Analysis: Anisotropic Monetary Reach",
    "section": "5.1 Polar Plot: Hoards by Bearing and Distance",
    "text": "5.1 Polar Plot: Hoards by Bearing and Distance\n\n\nCode\nggplot(hoard_polar, aes(x = bearing_deg, y = dist_km)) +\n  geom_point(aes(color = p_rome, size = n_types), alpha = 0.6) +\n  scale_color_viridis_c(name = \"Rome %\", labels = scales::percent_format(),\n                        option = \"plasma\") +\n  scale_size_continuous(name = \"N types\", range = c(1, 6)) +\n  coord_polar(theta = \"x\", start = -pi/2, direction = 1) +\n  scale_x_continuous(breaks = seq(0, 315, 45),\n                     labels = c(\"N\", \"NE\", \"E\", \"SE\", \"S\", \"SW\", \"W\", \"NW\")) +\n  labs(\n    title = \"Hoard Distribution: Polar View from Rome\",\n    subtitle = \"Distance (km) from center; bearing around circumference\",\n    x = \"Bearing from Rome\",\n    y = \"Distance (km)\"\n  ) +\n  theme(\n    axis.text.y = element_text(size = 8),\n    legend.position = \"right\"\n  )"
  },
  {
    "objectID": "directional_flow.html#sector-distribution",
    "href": "directional_flow.html#sector-distribution",
    "title": "Directional Flow Analysis: Anisotropic Monetary Reach",
    "section": "5.2 Sector Distribution",
    "text": "5.2 Sector Distribution\n\n\nCode\nsector_summary &lt;- hoard_polar %&gt;%\n  group_by(sector) %&gt;%\n  summarise(\n    n_hoards = n(),\n    mean_dist = mean(dist_km),\n    mean_rome_pct = weighted.mean(p_rome, n_types) * 100,\n    median_rome_pct = median(p_rome) * 100,\n    total_types = sum(n_types),\n    .groups = \"drop\"\n  ) %&gt;%\n  arrange(desc(mean_rome_pct))\n\nkable(sector_summary, digits = 1, \n      col.names = c(\"Sector\", \"N Hoards\", \"Mean Dist (km)\", \n                    \"Mean Rome %\", \"Median Rome %\", \"Total Types\"),\n      caption = \"Rome penetration by geographic sector\")\n\n\n\nRome penetration by geographic sector\n\n\n\n\n\n\n\n\n\n\nSector\nN Hoards\nMean Dist (km)\nMean Rome %\nMedian Rome %\nTotal Types\n\n\n\n\nE: Balkans/East\n222\n818.8\n89.4\n93.6\n12777\n\n\nS: Africa/Sicily\n25\n506.1\n89.1\n94.4\n1499\n\n\nW: Iberia/Sardinia\n110\n1223.5\n87.4\n93.6\n6653\n\n\nN: Gaul/Alps\n106\n414.7\n86.6\n91.6\n9503"
  },
  {
    "objectID": "directional_flow.html#model-1-isotropic-distance-only",
    "href": "directional_flow.html#model-1-isotropic-distance-only",
    "title": "Directional Flow Analysis: Anisotropic Monetary Reach",
    "section": "6.1 Model 1: Isotropic (Distance Only)",
    "text": "6.1 Model 1: Isotropic (Distance Only)\n\n\nCode\n# Baseline: distance only\nmodel_iso &lt;- glm(\n  cbind(n_rome, n_types - n_rome) ~ dist_km,\n  family = binomial(link = \"logit\"),\n  data = hoard_polar\n)\n\nsummary(model_iso)\n\n\n\nCall:\nglm(formula = cbind(n_rome, n_types - n_rome) ~ dist_km, family = binomial(link = \"logit\"), \n    data = hoard_polar)\n\nCoefficients:\n              Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  2.055e+00  3.072e-02  66.883   &lt;2e-16 ***\ndist_km     -8.031e-05  3.568e-05  -2.251   0.0244 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 3220.1  on 462  degrees of freedom\nResidual deviance: 3215.1  on 461  degrees of freedom\nAIC: 4455.4\n\nNumber of Fisher Scoring iterations: 5\n\n\nCode\ncat(\"\\nAIC (isotropic):\", AIC(model_iso), \"\\n\")\n\n\n\nAIC (isotropic): 4455.434"
  },
  {
    "objectID": "directional_flow.html#model-2-anisotropic-distance-direction",
    "href": "directional_flow.html#model-2-anisotropic-distance-direction",
    "title": "Directional Flow Analysis: Anisotropic Monetary Reach",
    "section": "6.2 Model 2: Anisotropic (Distance + Direction)",
    "text": "6.2 Model 2: Anisotropic (Distance + Direction)\n\n\nCode\n# Add directional components\nmodel_aniso &lt;- glm(\n  cbind(n_rome, n_types - n_rome) ~ dist_km + cos_bearing + sin_bearing,\n  family = binomial(link = \"logit\"),\n  data = hoard_polar\n)\n\nsummary(model_aniso)\n\n\n\nCall:\nglm(formula = cbind(n_rome, n_types - n_rome) ~ dist_km + cos_bearing + \n    sin_bearing, family = binomial(link = \"logit\"), data = hoard_polar)\n\nCoefficients:\n              Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  2.063e+00  3.610e-02  57.151  &lt; 2e-16 ***\ndist_km     -6.487e-05  3.853e-05  -1.684 0.092255 .  \ncos_bearing -1.158e-01  3.333e-02  -3.474 0.000513 ***\nsin_bearing  1.238e-01  2.417e-02   5.121 3.03e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 3220.1  on 462  degrees of freedom\nResidual deviance: 3164.7  on 459  degrees of freedom\nAIC: 4409\n\nNumber of Fisher Scoring iterations: 5\n\n\nCode\ncat(\"\\nAIC (anisotropic):\", AIC(model_aniso), \"\\n\")\n\n\n\nAIC (anisotropic): 4409.009"
  },
  {
    "objectID": "directional_flow.html#model-3-full-interaction-direction-dependent-distance-effect",
    "href": "directional_flow.html#model-3-full-interaction-direction-dependent-distance-effect",
    "title": "Directional Flow Analysis: Anisotropic Monetary Reach",
    "section": "6.3 Model 3: Full Interaction (Direction-Dependent Distance Effect)",
    "text": "6.3 Model 3: Full Interaction (Direction-Dependent Distance Effect)\n\n\nCode\n# Distance effect varies by direction\nmodel_interact &lt;- glm(\n  cbind(n_rome, n_types - n_rome) ~ dist_km * cos_bearing + dist_km * sin_bearing,\n  family = binomial(link = \"logit\"),\n  data = hoard_polar\n)\n\nsummary(model_interact)\n\n\n\nCall:\nglm(formula = cbind(n_rome, n_types - n_rome) ~ dist_km * cos_bearing + \n    dist_km * sin_bearing, family = binomial(link = \"logit\"), \n    data = hoard_polar)\n\nCoefficients:\n                      Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)          1.994e+00  3.713e-02  53.697  &lt; 2e-16 ***\ndist_km              2.913e-05  4.035e-05   0.722 0.470313    \ncos_bearing          3.010e-01  6.233e-02   4.829 1.37e-06 ***\nsin_bearing          1.883e-01  5.455e-02   3.452 0.000556 ***\ndist_km:cos_bearing -8.818e-04  1.081e-04  -8.154 3.52e-16 ***\ndist_km:sin_bearing  5.032e-05  5.501e-05   0.915 0.360355    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 3220.1  on 462  degrees of freedom\nResidual deviance: 3098.3  on 457  degrees of freedom\nAIC: 4346.7\n\nNumber of Fisher Scoring iterations: 5\n\n\nCode\ncat(\"\\nAIC (interaction):\", AIC(model_interact), \"\\n\")\n\n\n\nAIC (interaction): 4346.673"
  },
  {
    "objectID": "directional_flow.html#model-comparison",
    "href": "directional_flow.html#model-comparison",
    "title": "Directional Flow Analysis: Anisotropic Monetary Reach",
    "section": "6.4 Model Comparison",
    "text": "6.4 Model Comparison\n\n\nCode\n# Compare models\nmodel_comp &lt;- tibble(\n  Model = c(\"Isotropic (distance only)\", \n            \"Anisotropic (distance + direction)\",\n            \"Interaction (direction-dependent distance)\"),\n  AIC = c(AIC(model_iso), AIC(model_aniso), AIC(model_interact)),\n  df = c(df.residual(model_iso), df.residual(model_aniso), df.residual(model_interact))\n) %&gt;%\n  mutate(delta_AIC = AIC - min(AIC))\n\nkable(model_comp, digits = 1, caption = \"Model comparison (lower AIC = better fit)\")\n\n\n\nModel comparison (lower AIC = better fit)\n\n\nModel\nAIC\ndf\ndelta_AIC\n\n\n\n\nIsotropic (distance only)\n4455.4\n461\n108.8\n\n\nAnisotropic (distance + direction)\n4409.0\n459\n62.3\n\n\nInteraction (direction-dependent distance)\n4346.7\n457\n0.0\n\n\n\n\n\nCode\n# Likelihood ratio test\ncat(\"\\nLikelihood ratio test: Isotropic vs Anisotropic\\n\")\n\n\n\nLikelihood ratio test: Isotropic vs Anisotropic\n\n\nCode\nanova(model_iso, model_aniso, test = \"Chisq\")\n\n\nAnalysis of Deviance Table\n\nModel 1: cbind(n_rome, n_types - n_rome) ~ dist_km\nModel 2: cbind(n_rome, n_types - n_rome) ~ dist_km + cos_bearing + sin_bearing\n  Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    \n1       461     3215.1                          \n2       459     3164.7  2   50.425 1.123e-11 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nCode\ncat(\"\\nLikelihood ratio test: Anisotropic vs Interaction\\n\")\n\n\n\nLikelihood ratio test: Anisotropic vs Interaction\n\n\nCode\nanova(model_aniso, model_interact, test = \"Chisq\")\n\n\nAnalysis of Deviance Table\n\nModel 1: cbind(n_rome, n_types - n_rome) ~ dist_km + cos_bearing + sin_bearing\nModel 2: cbind(n_rome, n_types - n_rome) ~ dist_km * cos_bearing + dist_km * \n    sin_bearing\n  Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    \n1       459     3164.7                          \n2       457     3098.3  2   66.336 3.938e-15 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "directional_flow.html#fit-separate-models-per-sector",
    "href": "directional_flow.html#fit-separate-models-per-sector",
    "title": "Directional Flow Analysis: Anisotropic Monetary Reach",
    "section": "7.1 Fit Separate Models per Sector",
    "text": "7.1 Fit Separate Models per Sector\n\n\nCode\nsector_models &lt;- hoard_polar %&gt;%\n  filter(!is.na(sector)) %&gt;%\n  group_by(sector) %&gt;%\n  nest() %&gt;%\n  mutate(\n    model = map(data, ~glm(\n      cbind(n_rome, n_types - n_rome) ~ dist_km,\n      family = binomial(link = \"logit\"),\n      data = .x\n    )),\n    tidy = map(model, tidy)\n  ) %&gt;%\n  unnest(tidy) %&gt;%\n  filter(term == \"dist_km\") %&gt;%\n  dplyr::select(sector, estimate, std.error, p.value) %&gt;%\n  mutate(\n    or_100km = exp(estimate * 100),\n    sig = ifelse(p.value &lt; 0.05, \"*\", \"\")\n  )\n\nkable(sector_models, digits = c(0, 5, 5, 4, 4, 0),\n      col.names = c(\"Sector\", \"Coefficient\", \"SE\", \"p-value\", \"OR/100km\", \"Sig\"),\n      caption = \"Distance effect by sector (* = p &lt; 0.05)\")\n\n\n\nDistance effect by sector (* = p &lt; 0.05)\n\n\nSector\nCoefficient\nSE\np-value\nOR/100km\nSig\n\n\n\n\nE: Balkans/East\n-0.00008\n0.00007\n0.2204\n0.9918\n\n\n\nW: Iberia/Sardinia\n-0.00009\n0.00007\n0.2264\n0.9912\n\n\n\nN: Gaul/Alps\n-0.00127\n0.00015\n0.0000\n0.8807\n*\n\n\nS: Africa/Sicily\n-0.00014\n0.00045\n0.7616\n0.9864"
  },
  {
    "objectID": "directional_flow.html#visualize-sector-specific-distance-effects",
    "href": "directional_flow.html#visualize-sector-specific-distance-effects",
    "title": "Directional Flow Analysis: Anisotropic Monetary Reach",
    "section": "7.2 Visualize Sector-Specific Distance Effects",
    "text": "7.2 Visualize Sector-Specific Distance Effects\n\n\nCode\nggplot(hoard_polar, aes(x = dist_km, y = p_rome)) +\n  geom_point(aes(size = n_types), alpha = 0.4, color = \"steelblue\") +\n  geom_smooth(method = \"glm\", method.args = list(family = \"binomial\"),\n              color = \"darkred\", se = TRUE) +\n  facet_wrap(~sector, ncol = 2) +\n  scale_y_continuous(labels = scales::percent_format()) +\n  scale_size_continuous(name = \"N types\", range = c(1, 6)) +\n  labs(\n    title = \"Distance-Decay by Sector\",\n    subtitle = \"Does Rome's reach decline equally in all directions?\",\n    x = \"Distance from Rome (km)\",\n    y = \"Rome proportion\"\n  ) +\n  theme(legend.position = \"bottom\")"
  },
  {
    "objectID": "directional_flow.html#does-anisotropy-differ-by-regime",
    "href": "directional_flow.html#does-anisotropy-differ-by-regime",
    "title": "Directional Flow Analysis: Anisotropic Monetary Reach",
    "section": "9.1 Does Anisotropy Differ by Regime?",
    "text": "9.1 Does Anisotropy Differ by Regime?\n\n\nCode\nregime_direction &lt;- hoard_polar %&gt;%\n  filter(!is.na(regime)) %&gt;%\n  group_by(regime) %&gt;%\n  nest() %&gt;%\n  mutate(\n    # Isotropic model\n    model_iso = map(data, ~glm(\n      cbind(n_rome, n_types - n_rome) ~ dist_km,\n      family = binomial, data = .x\n    )),\n    # Anisotropic model\n    model_aniso = map(data, ~glm(\n      cbind(n_rome, n_types - n_rome) ~ dist_km + cos_bearing + sin_bearing,\n      family = binomial, data = .x\n    )),\n    # Compare\n    aic_iso = map_dbl(model_iso, AIC),\n    aic_aniso = map_dbl(model_aniso, AIC),\n    aic_diff = aic_iso - aic_aniso,  # Positive = anisotropic better\n    # LRT p-value\n    lrt_p = map2_dbl(model_iso, model_aniso, ~{\n      test &lt;- anova(.x, .y, test = \"Chisq\")\n      test$`Pr(&gt;Chi)`[2]\n    })\n  ) %&gt;%\n  dplyr::select(regime, aic_iso, aic_aniso, aic_diff, lrt_p) %&gt;%\n  mutate(\n    aniso_sig = ifelse(lrt_p &lt; 0.05, \"Yes*\", \"No\")\n  )\n\nkable(regime_direction, digits = c(0, 1, 1, 1, 4, 0),\n      col.names = c(\"Regime\", \"AIC (iso)\", \"AIC (aniso)\", \"ΔAIC\", \"LRT p\", \"Aniso Sig?\"),\n      caption = \"Does adding direction improve model fit? (by regime)\")\n\n\n\nDoes adding direction improve model fit? (by regime)\n\n\nRegime\nAIC (iso)\nAIC (aniso)\nΔAIC\nLRT p\nAniso Sig?\n\n\n\n\nPost-transition\n2363.2\n2249.7\n113.4\n0.0000\nYes*\n\n\nTransition\n588.3\n588.3\n-0.1\n0.1420\nNo\n\n\nPre-transition\n507.1\n495.1\n11.9\n0.0003\nYes*"
  },
  {
    "objectID": "directional_flow.html#sector-effects-by-regime",
    "href": "directional_flow.html#sector-effects-by-regime",
    "title": "Directional Flow Analysis: Anisotropic Monetary Reach",
    "section": "9.2 Sector Effects by Regime",
    "text": "9.2 Sector Effects by Regime\n\n\nCode\nsector_regime &lt;- hoard_polar %&gt;%\n  filter(!is.na(regime), !is.na(sector)) %&gt;%\n  group_by(regime, sector) %&gt;%\n  summarise(\n    n_hoards = n(),\n    mean_rome = weighted.mean(p_rome, n_types) * 100,\n    total_types = sum(n_types),\n    .groups = \"drop\"\n  )\n\nggplot(sector_regime, aes(x = sector, y = mean_rome, fill = regime)) +\n  geom_col(position = \"dodge\", alpha = 0.8) +\n  scale_fill_manual(values = c(\"Pre-transition\" = \"steelblue\",\n                                \"Transition\" = \"gold\",\n                                \"Post-transition\" = \"darkred\")) +\n  labs(\n    title = \"Rome Proportion by Sector and Regime\",\n    subtitle = \"How did directional patterns change across the transition?\",\n    x = NULL,\n    y = \"Mean Rome %\",\n    fill = \"Regime\"\n  ) +\n  theme(axis.text.x = element_text(angle = 30, hjust = 1))"
  },
  {
    "objectID": "directional_flow.html#distance-decay-by-sector-and-regime",
    "href": "directional_flow.html#distance-decay-by-sector-and-regime",
    "title": "Directional Flow Analysis: Anisotropic Monetary Reach",
    "section": "9.3 Distance-Decay by Sector AND Regime",
    "text": "9.3 Distance-Decay by Sector AND Regime\n\n\nCode\nsector_regime_models &lt;- hoard_polar %&gt;%\n  filter(!is.na(regime), !is.na(sector)) %&gt;%\n  group_by(regime, sector) %&gt;%\n  filter(n() &gt;= 10) %&gt;%  # Need minimum sample\n  nest() %&gt;%\n  mutate(\n    model = map(data, ~tryCatch(\n      glm(cbind(n_rome, n_types - n_rome) ~ dist_km,\n          family = binomial, data = .x),\n      error = function(e) NULL\n    )),\n    tidy = map(model, ~if(!is.null(.x)) tidy(.x) else NULL)\n  ) %&gt;%\n  filter(!map_lgl(tidy, is.null)) %&gt;%\n  unnest(tidy) %&gt;%\n  filter(term == \"dist_km\") %&gt;%\n  dplyr::select(regime, sector, estimate, std.error, p.value) %&gt;%\n  mutate(\n    or_100km = exp(estimate * 100),\n    sig = ifelse(p.value &lt; 0.05, \"*\", \"\")\n  )\n\nkable(sector_regime_models, digits = c(0, 0, 5, 5, 4, 4, 0),\n      col.names = c(\"Regime\", \"Sector\", \"Coef\", \"SE\", \"p\", \"OR/100km\", \"\"),\n      caption = \"Distance effect by sector and regime\")\n\n\n\nDistance effect by sector and regime\n\n\n\n\n\n\n\n\n\n\n\nRegime\nSector\nCoef\nSE\np\nOR/100km\n\n\n\n\n\nPost-transition\nE: Balkans/East\n0.00028\n0.00009\n0.0012\n1.0282\n*\n\n\nPost-transition\nW: Iberia/Sardinia\n-0.00027\n0.00009\n0.0042\n0.9732\n*\n\n\nTransition\nE: Balkans/East\n0.00022\n0.00015\n0.1269\n1.0225\n\n\n\nPre-transition\nW: Iberia/Sardinia\n0.00075\n0.00037\n0.0422\n1.0781\n*\n\n\nPost-transition\nN: Gaul/Alps\n-0.00067\n0.00017\n0.0001\n0.9350\n*\n\n\nTransition\nW: Iberia/Sardinia\n0.00028\n0.00014\n0.0482\n1.0286\n*\n\n\nPre-transition\nS: Africa/Sicily\n-0.00195\n0.00254\n0.4413\n0.8225\n\n\n\nTransition\nN: Gaul/Alps\n-0.00001\n0.00063\n0.9847\n0.9988\n\n\n\nPre-transition\nE: Balkans/East\n0.00035\n0.00055\n0.5287\n1.0354\n\n\n\nPre-transition\nN: Gaul/Alps\n-0.00126\n0.00059\n0.0337\n0.8819\n*"
  },
  {
    "objectID": "directional_flow.html#map-sectors-with-rome-proportion",
    "href": "directional_flow.html#map-sectors-with-rome-proportion",
    "title": "Directional Flow Analysis: Anisotropic Monetary Reach",
    "section": "10.1 Map: Sectors with Rome Proportion",
    "text": "10.1 Map: Sectors with Rome Proportion\n\n\nCode\nlibrary(rnaturalearth)\nlibrary(rnaturalearthdata)\n\n# Get land\nland &lt;- ne_countries(scale = \"medium\", returnclass = \"sf\") %&gt;% st_union()\n\n# Create sf from hoards\nhoard_sf &lt;- st_as_sf(hoard_polar, coords = c(\"hoard_long\", \"hoard_lat\"), \n                      crs = 4326, remove = FALSE)\n\nhoard_bbox &lt;- st_bbox(hoard_sf)\n\n# Rome point\nrome_sf &lt;- st_as_sf(tibble(lon = rome_lon, lat = rome_lat),\n                     coords = c(\"lon\", \"lat\"), crs = 4326)\n\nggplot() +\n  geom_sf(data = land, fill = \"grey95\", color = \"grey80\") +\n  geom_sf(data = hoard_sf, aes(color = p_rome, shape = sector), \n          size = 2, alpha = 0.7) +\n  geom_sf(data = rome_sf, color = \"black\", shape = 8, size = 5, stroke = 2) +\n  scale_color_viridis_c(name = \"Rome %\", labels = scales::percent_format(),\n                        option = \"plasma\") +\n  scale_shape_manual(values = c(\"N: Gaul/Alps\" = 16, \"E: Balkans/East\" = 17,\n                                 \"S: Africa/Sicily\" = 15, \"W: Iberia/Sardinia\" = 18)) +\n  coord_sf(xlim = c(hoard_bbox[\"xmin\"] - 2, hoard_bbox[\"xmax\"] + 2),\n           ylim = c(hoard_bbox[\"ymin\"] - 2, hoard_bbox[\"ymax\"] + 2)) +\n  labs(\n    title = \"Hoard Locations by Sector and Rome Proportion\",\n    subtitle = \"Star = Rome mint\",\n    shape = \"Sector\"\n  ) +\n  theme_minimal() +\n  theme(axis.text = element_blank(), axis.title = element_blank())"
  },
  {
    "objectID": "directional_flow.html#polar-heatmap-rome-by-distance-and-bearing",
    "href": "directional_flow.html#polar-heatmap-rome-by-distance-and-bearing",
    "title": "Directional Flow Analysis: Anisotropic Monetary Reach",
    "section": "10.2 Polar Heatmap: Rome % by Distance and Bearing",
    "text": "10.2 Polar Heatmap: Rome % by Distance and Bearing\n\n\nCode\n# Bin by distance and bearing\npolar_bins &lt;- hoard_polar %&gt;%\n  mutate(\n    dist_bin = cut(dist_km, breaks = seq(0, 3000, 300), include.lowest = TRUE),\n    bearing_bin = cut(bearing_deg, breaks = seq(0, 360, 45), include.lowest = TRUE)\n  ) %&gt;%\n  group_by(dist_bin, bearing_bin) %&gt;%\n  summarise(\n    n = n(),\n    mean_rome = weighted.mean(p_rome, n_types),\n    .groups = \"drop\"\n  ) %&gt;%\n  filter(n &gt;= 3)  # Minimum sample\n\n# Extract bin midpoints\npolar_bins &lt;- polar_bins %&gt;%\n  mutate(\n    dist_mid = as.numeric(str_extract(as.character(dist_bin), \"\\\\d+\")) + 150,\n    bearing_mid = as.numeric(str_extract(as.character(bearing_bin), \"\\\\d+\")) + 22.5\n  )\n\nggplot(polar_bins, aes(x = bearing_mid, y = dist_mid, fill = mean_rome)) +\n  geom_tile(width = 45, height = 300, alpha = 0.9) +\n  geom_text(aes(label = round(mean_rome * 100)), size = 3, color = \"white\") +\n  coord_polar(theta = \"x\", start = -pi/2) +\n  scale_fill_viridis_c(name = \"Rome %\", labels = scales::percent_format(),\n                       option = \"plasma\") +\n  scale_x_continuous(breaks = seq(22.5, 337.5, 45),\n                     labels = c(\"N\", \"NE\", \"E\", \"SE\", \"S\", \"SW\", \"W\", \"NW\")) +\n  labs(\n    title = \"Polar Heatmap: Rome Proportion\",\n    subtitle = \"By distance (rings) and bearing (sectors) from Rome\",\n    x = NULL, y = \"Distance (km)\"\n  ) +\n  theme(axis.text.y = element_text(size = 8))"
  },
  {
    "objectID": "lrr_mint_date.html",
    "href": "lrr_mint_date.html",
    "title": "Mint-Date Stratification of Compositional LRR",
    "section": "",
    "text": "The TPQ (deposition) analysis revealed striking patterns:\n\n\n\nFinding\nTPQ Result\n\n\n\n\nRome proportion over time\nDeclined from 95% to 83%\n\n\nDistance effect\nReversed sign across periods\n\n\nSpatial extent\nExpanded dramatically\n\n\n\nMint-date stratification asks a different question: When coins were minted, where did they eventually end up?\nThis provides a validation check and additional insight:\n\nIf TPQ patterns reflect production changes, mint-date stratification should show similar trends\nIf TPQ patterns reflect circulation/hoarding behavior, mint-date may show different patterns\nCoins minted early but deposited late reveal circulation longevity\n\n\n\n\n\n\n\n\n\n\n\n\nDimension\nTPQ (Deposition)\nMint Date (Production)\n\n\n\n\nQuestion\nWhen were coins buried?\nWhen were coins made?\n\n\nUnit\nHoard event\nCoin-type occurrence\n\n\nReflects\nCrisis, hoarding behavior\nMint output, initial distribution\n\n\nCaveat\nHoards contain mixed-age coins\nCoins travel after minting\n\n\n\n\n\n\nWe use the same period boundaries for comparability:\n\n\n\n\n\n\n\n\n\nPeriod\nMint Date Range\nLabel\nHistorical Context\n\n\n\n\n1\nbefore 150 BCE\nEarly Republic\nPre-denarius standardization; limited output\n\n\n2\n150–100 BCE\nLate Republic I\nPost-Gracchi; expanding provincial reach\n\n\n3\n100–50 BCE\nLate Republic II\nCivil war coinages; military mints\n\n\n4\n50 BCE – 14 CE\nTriumviral/Augustan\nMassive output; Augustan reform\n\n\n5\nafter 14 CE\nEarly Imperial\nJulio-Claudian (if present)"
  },
  {
    "objectID": "lrr_mint_date.html#comparison-with-tpq-stratification",
    "href": "lrr_mint_date.html#comparison-with-tpq-stratification",
    "title": "Mint-Date Stratification of Compositional LRR",
    "section": "",
    "text": "The TPQ (deposition) analysis revealed striking patterns:\n\n\n\nFinding\nTPQ Result\n\n\n\n\nRome proportion over time\nDeclined from 95% to 83%\n\n\nDistance effect\nReversed sign across periods\n\n\nSpatial extent\nExpanded dramatically\n\n\n\nMint-date stratification asks a different question: When coins were minted, where did they eventually end up?\nThis provides a validation check and additional insight:\n\nIf TPQ patterns reflect production changes, mint-date stratification should show similar trends\nIf TPQ patterns reflect circulation/hoarding behavior, mint-date may show different patterns\nCoins minted early but deposited late reveal circulation longevity"
  },
  {
    "objectID": "lrr_mint_date.html#key-interpretive-difference",
    "href": "lrr_mint_date.html#key-interpretive-difference",
    "title": "Mint-Date Stratification of Compositional LRR",
    "section": "",
    "text": "Dimension\nTPQ (Deposition)\nMint Date (Production)\n\n\n\n\nQuestion\nWhen were coins buried?\nWhen were coins made?\n\n\nUnit\nHoard event\nCoin-type occurrence\n\n\nReflects\nCrisis, hoarding behavior\nMint output, initial distribution\n\n\nCaveat\nHoards contain mixed-age coins\nCoins travel after minting"
  },
  {
    "objectID": "lrr_mint_date.html#mint-date-period-definitions",
    "href": "lrr_mint_date.html#mint-date-period-definitions",
    "title": "Mint-Date Stratification of Compositional LRR",
    "section": "",
    "text": "We use the same period boundaries for comparability:\n\n\n\n\n\n\n\n\n\nPeriod\nMint Date Range\nLabel\nHistorical Context\n\n\n\n\n1\nbefore 150 BCE\nEarly Republic\nPre-denarius standardization; limited output\n\n\n2\n150–100 BCE\nLate Republic I\nPost-Gracchi; expanding provincial reach\n\n\n3\n100–50 BCE\nLate Republic II\nCivil war coinages; military mints\n\n\n4\n50 BCE – 14 CE\nTriumviral/Augustan\nMassive output; Augustan reform\n\n\n5\nafter 14 CE\nEarly Imperial\nJulio-Claudian (if present)"
  },
  {
    "objectID": "lrr_mint_date.html#parse-mint-dates-and-flag-rome",
    "href": "lrr_mint_date.html#parse-mint-dates-and-flag-rome",
    "title": "Mint-Date Stratification of Compositional LRR",
    "section": "4.1 Parse Mint Dates and Flag Rome",
    "text": "4.1 Parse Mint Dates and Flag Rome\n\n\nCode\nchrr_flagged &lt;- chrr_raw %&gt;%\n  mutate(\n    is_rome = mint_id == \"rome\" | str_detect(mint_uri, \"/id/rome$\"),\n    is_rome = replace_na(is_rome, FALSE),\n    \n    # Parse mint date range\n    mint_start = as.numeric(start_year),\n    mint_end = as.numeric(end_year),\n    mint_mid = (mint_start + mint_end) / 2\n  )\n\n# Check mint-date coverage\nmint_coverage &lt;- chrr_flagged %&gt;%\n  summarise(\n    total_rows = n(),\n    rows_with_mint_date = sum(!is.na(mint_mid)),\n    pct_with_mint_date = round(100 * rows_with_mint_date / total_rows, 1),\n    mint_min = min(mint_mid, na.rm = TRUE),\n    mint_max = max(mint_mid, na.rm = TRUE)\n  )\n\nkable(mint_coverage, caption = \"Mint-date coverage in dataset\")\n\n\n\nMint-date coverage in dataset\n\n\n\n\n\n\n\n\n\ntotal_rows\nrows_with_mint_date\npct_with_mint_date\nmint_min\nmint_max\n\n\n\n\n31951\n31372\n98.2\n-238\n-31"
  },
  {
    "objectID": "lrr_mint_date.html#define-mint-date-period-bins",
    "href": "lrr_mint_date.html#define-mint-date-period-bins",
    "title": "Mint-Date Stratification of Compositional LRR",
    "section": "4.2 Define Mint-Date Period Bins",
    "text": "4.2 Define Mint-Date Period Bins\n\n\nCode\nperiod_breaks &lt;- c(-Inf, -150, -100, -50, 14, Inf)\nperiod_labels &lt;- c(\n \"1: Early Republic (pre-150 BCE)\",\n  \"2: Late Republic I (150-100 BCE)\",\n  \"3: Late Republic II (100-50 BCE)\",\n  \"4: Triumviral/Augustan (50 BCE-14 CE)\",\n  \"5: Early Imperial (post-14 CE)\"\n)\n\nchrr_mint &lt;- chrr_flagged %&gt;%\n  filter(!is.na(mint_mid)) %&gt;%\n  mutate(\n    mint_period = cut(\n      mint_mid,\n      breaks = period_breaks,\n      labels = period_labels,\n      right = TRUE\n    ),\n    mint_period_num = as.integer(mint_period)\n  )\n\n# Period summary\nmint_period_summary &lt;- chrr_mint %&gt;%\n  group_by(mint_period) %&gt;%\n  summarise(\n    n_rows = n(),\n    n_hoards = n_distinct(hoard_id),\n    n_rome = sum(is_rome),\n    n_non_rome = sum(!is_rome),\n    pct_rome = round(100 * n_rome / n_rows, 1),\n    .groups = \"drop\"\n  )\n\nkable(mint_period_summary,\n      col.names = c(\"Mint Period\", \"Rows\", \"Hoards\", \"Rome\", \"Non-Rome\", \"Rome %\"),\n      caption = \"Data distribution by mint-date period\")\n\n\n\nData distribution by mint-date period\n\n\n\n\n\n\n\n\n\n\nMint Period\nRows\nHoards\nRome\nNon-Rome\nRome %\n\n\n\n\n1: Early Republic (pre-150 BCE)\n2632\n330\n2247\n385\n85.4\n\n\n2: Late Republic I (150-100 BCE)\n13565\n451\n13186\n379\n97.2\n\n\n3: Late Republic II (100-50 BCE)\n11368\n385\n10575\n793\n93.0\n\n\n4: Triumviral/Augustan (50 BCE-14 CE)\n3807\n221\n2169\n1638\n57.0"
  },
  {
    "objectID": "lrr_mint_date.html#visualize-mint-date-distribution",
    "href": "lrr_mint_date.html#visualize-mint-date-distribution",
    "title": "Mint-Date Stratification of Compositional LRR",
    "section": "4.3 Visualize Mint-Date Distribution",
    "text": "4.3 Visualize Mint-Date Distribution\n\n\nCode\nggplot(chrr_mint, aes(x = mint_mid, fill = mint_period)) +\n  geom_histogram(binwidth = 10, color = \"white\", alpha = 0.8) +\n  geom_vline(xintercept = c(-150, -100, -50, 14),\n             linetype = \"dashed\", color = \"grey30\") +\n  scale_fill_viridis_d(name = \"Period\", option = \"plasma\") +\n  labs(\n    title = \"Coin-Type Minting Chronology\",\n    subtitle = \"Distribution of mint_mid (midpoint of mint date range)\",\n    x = \"Mint date (midpoint)\",\n    y = \"Number of coin-type occurrences\"\n  ) +\n  theme(legend.position = \"bottom\")"
  },
  {
    "objectID": "lrr_mint_date.html#compare-tpq-vs-mint-date-distributions",
    "href": "lrr_mint_date.html#compare-tpq-vs-mint-date-distributions",
    "title": "Mint-Date Stratification of Compositional LRR",
    "section": "4.4 Compare TPQ vs Mint-Date Distributions",
    "text": "4.4 Compare TPQ vs Mint-Date Distributions\n\n\nCode\n# Add TPQ for comparison\nchrr_both &lt;- chrr_mint %&gt;%\n  mutate(\n    tpq_year = readr::parse_number(as.character(hoard_tpq))\n  ) %&gt;%\n  filter(!is.na(tpq_year))\n\n# Long format for faceting\nchrr_long &lt;- chrr_both %&gt;%\n  select(hoard_id, type_id, mint_mid, tpq_year) %&gt;%\n  pivot_longer(\n    cols = c(mint_mid, tpq_year),\n    names_to = \"date_type\",\n    values_to = \"year\"\n  ) %&gt;%\n  mutate(\n    date_type = recode(date_type,\n      \"mint_mid\" = \"Mint Date (production)\",\n      \"tpq_year\" = \"TPQ (deposition)\"\n    )\n  )\n\nggplot(chrr_long, aes(x = year, fill = date_type)) +\n  geom_histogram(binwidth = 10, alpha = 0.7, position = \"identity\") +\n  facet_wrap(~date_type, ncol = 2) +\n  scale_fill_manual(values = c(\"Mint Date (production)\" = \"steelblue\", \n                                \"TPQ (deposition)\" = \"darkred\")) +\n  labs(\n    title = \"Production vs. Deposition Chronology\",\n    subtitle = \"Mint dates skew earlier; TPQ dates cluster in late Republic\",\n    x = \"Year\",\n    y = \"Count\"\n  ) +\n  theme(legend.position = \"none\")"
  },
  {
    "objectID": "lrr_mint_date.html#distribution-of-deposition-lag",
    "href": "lrr_mint_date.html#distribution-of-deposition-lag",
    "title": "Mint-Date Stratification of Compositional LRR",
    "section": "5.1 Distribution of Deposition Lag",
    "text": "5.1 Distribution of Deposition Lag\n\n\nCode\nchrr_lag &lt;- chrr_both %&gt;%\n  mutate(\n    deposition_lag = tpq_year - mint_mid\n  ) %&gt;%\n  filter(!is.na(deposition_lag))\n\nlag_summary &lt;- chrr_lag %&gt;%\n  summarise(\n    n = n(),\n    mean_lag = mean(deposition_lag),\n    median_lag = median(deposition_lag),\n    sd_lag = sd(deposition_lag),\n    q25 = quantile(deposition_lag, 0.25),\n    q75 = quantile(deposition_lag, 0.75)\n  )\n\nkable(lag_summary, digits = 1, caption = \"Deposition lag (TPQ - mint_mid) statistics\")\n\n\n\nDeposition lag (TPQ - mint_mid) statistics\n\n\nn\nmean_lag\nmedian_lag\nsd_lag\nq25\nq75\n\n\n\n\n31257\n43.9\n38\n33.5\n16.5\n64\n\n\n\n\n\nCode\nggplot(chrr_lag, aes(x = deposition_lag)) +\n  geom_histogram(binwidth = 10, fill = \"steelblue\", color = \"white\", alpha = 0.8) +\n  geom_vline(xintercept = lag_summary$median_lag, color = \"darkred\", \n             linetype = \"dashed\", linewidth = 1) +\n  labs(\n    title = \"Circulation Lag: Time Between Minting and Deposition\",\n    subtitle = paste(\"Median lag =\", round(lag_summary$median_lag, 0), \"years\"),\n    x = \"Deposition lag (years)\",\n    y = \"Count\"\n  )"
  },
  {
    "objectID": "lrr_mint_date.html#lag-by-mint-period",
    "href": "lrr_mint_date.html#lag-by-mint-period",
    "title": "Mint-Date Stratification of Compositional LRR",
    "section": "5.2 Lag by Mint Period",
    "text": "5.2 Lag by Mint Period\n\n\nCode\nlag_by_period &lt;- chrr_lag %&gt;%\n  group_by(mint_period) %&gt;%\n  summarise(\n    n = n(),\n    mean_lag = mean(deposition_lag),\n    median_lag = median(deposition_lag),\n    sd_lag = sd(deposition_lag),\n    .groups = \"drop\"\n  )\n\nkable(lag_by_period, digits = 1, \n      col.names = c(\"Mint Period\", \"N\", \"Mean Lag\", \"Median Lag\", \"SD\"),\n      caption = \"Circulation lag by mint period\")\n\n\n\nCirculation lag by mint period\n\n\n\n\n\n\n\n\n\nMint Period\nN\nMean Lag\nMedian Lag\nSD\n\n\n\n\n1: Early Republic (pre-150 BCE)\n2627\n86.8\n84.5\n41.7\n\n\n2: Late Republic I (150-100 BCE)\n13493\n53.4\n52.0\n31.3\n\n\n3: Late Republic II (100-50 BCE)\n11330\n31.9\n31.0\n22.2\n\n\n4: Triumviral/Augustan (50 BCE-14 CE)\n3807\n16.0\n9.0\n16.4\n\n\n\n\n\nCode\nggplot(chrr_lag, aes(x = mint_period, y = deposition_lag, fill = mint_period)) +\n  geom_boxplot(alpha = 0.7, outlier.alpha = 0.3) +\n  scale_fill_viridis_d(option = \"plasma\") +\n  labs(\n    title = \"Circulation Lag by Mint Period\",\n    subtitle = \"Earlier coins had longer circulation before deposition\",\n    x = NULL,\n    y = \"Deposition lag (years)\"\n  ) +\n  theme(\n    axis.text.x = element_text(angle = 30, hjust = 1),\n    legend.position = \"none\"\n  )"
  },
  {
    "objectID": "lrr_mint_date.html#prepare-spatial-data",
    "href": "lrr_mint_date.html#prepare-spatial-data",
    "title": "Mint-Date Stratification of Compositional LRR",
    "section": "6.1 Prepare Spatial Data",
    "text": "6.1 Prepare Spatial Data\n\n\nCode\nlibrary(rnaturalearth)\nlibrary(rnaturalearthdata)\n\n# Filter to valid coordinates\nchrr_spatial &lt;- chrr_mint %&gt;%\n  filter(!is.na(hoard_lat), !is.na(hoard_long))\n\n# Convert to sf\nhoard_sf &lt;- st_as_sf(\nchrr_spatial,\n  coords = c(\"hoard_long\", \"hoard_lat\"),\n  crs = 4326,\n  remove = FALSE\n)\n\n# Land and projection\nland &lt;- ne_countries(scale = \"medium\", returnclass = \"sf\") %&gt;%\n  st_union()\n\nhoard_sf_valid &lt;- hoard_sf %&gt;%\n  filter(!st_is_empty(geometry))\n\nhoard_bbox &lt;- st_bbox(hoard_sf_valid)\n\nif (any(is.na(hoard_bbox))) {\n  hoard_bbox &lt;- c(xmin = -10, ymin = 30, xmax = 45, ymax = 55)\n  names(hoard_bbox) &lt;- c(\"xmin\", \"ymin\", \"xmax\", \"ymax\")\n}\n\npad &lt;- 2\n\nstudy_extent &lt;- st_polygon(list(rbind(\n  c(hoard_bbox[\"xmin\"] - pad, hoard_bbox[\"ymin\"] - pad),\n  c(hoard_bbox[\"xmax\"] + pad, hoard_bbox[\"ymin\"] - pad),\n  c(hoard_bbox[\"xmax\"] + pad, hoard_bbox[\"ymax\"] + pad),\n  c(hoard_bbox[\"xmin\"] - pad, hoard_bbox[\"ymax\"] + pad),\n  c(hoard_bbox[\"xmin\"] - pad, hoard_bbox[\"ymin\"] - pad)\n))) %&gt;%\n  st_sfc(crs = 4326)\n\nstudy_land &lt;- st_intersection(land, study_extent)\n\ntarget_crs &lt;- 3035\nhoard_sf_proj &lt;- st_transform(hoard_sf_valid, target_crs)\nstudy_land_proj &lt;- st_transform(study_land, target_crs)\n\nrome_mint &lt;- st_as_sf(\n  tibble(name = \"Rome\", lon = 12.4964, lat = 41.9028),\n  coords = c(\"lon\", \"lat\"),\n  crs = 4326\n) %&gt;%\n  st_transform(target_crs)"
  },
  {
    "objectID": "lrr_mint_date.html#hexagonal-grid",
    "href": "lrr_mint_date.html#hexagonal-grid",
    "title": "Mint-Date Stratification of Compositional LRR",
    "section": "6.2 Hexagonal Grid",
    "text": "6.2 Hexagonal Grid\n\n\nCode\nhex_size &lt;- 100000\n\nhex_grid &lt;- st_make_grid(\n  study_land_proj,\n  cellsize = hex_size,\n  square = FALSE\n) %&gt;%\n  st_sf(hex_id = seq_along(.), geometry = .) %&gt;%\n  st_set_crs(target_crs)\n\nhex_land &lt;- hex_grid %&gt;%\n  filter(lengths(st_intersects(., study_land_proj)) &gt; 0)\n\nhex_centroids &lt;- st_centroid(hex_land)\non_land &lt;- lengths(st_intersects(hex_centroids, study_land_proj)) &gt; 0\nhex_land &lt;- hex_land[on_land, ]\n\ncat(\"Hexes on land:\", nrow(hex_land), \"\\n\")\n\n\nHexes on land: 859"
  },
  {
    "objectID": "lrr_mint_date.html#assign-coin-types-to-hexes-by-mint-period",
    "href": "lrr_mint_date.html#assign-coin-types-to-hexes-by-mint-period",
    "title": "Mint-Date Stratification of Compositional LRR",
    "section": "6.3 Assign Coin-Types to Hexes by Mint Period",
    "text": "6.3 Assign Coin-Types to Hexes by Mint Period\nNote: Unlike TPQ analysis where each hoard is one observation, here each coin-type occurrence is an observation with its own mint date.\n\n\nCode\nhoard_hex &lt;- st_join(hoard_sf_proj, hex_land, join = st_within) %&gt;%\n  filter(!is.na(hex_id))\n\ncat(\"Coin-type occurrences assigned to hexes:\", nrow(hoard_hex), \"\\n\")\n\n\nCoin-type occurrences assigned to hexes: 25306"
  },
  {
    "objectID": "lrr_mint_date.html#compute-lrr-by-mint-period-and-hex",
    "href": "lrr_mint_date.html#compute-lrr-by-mint-period-and-hex",
    "title": "Mint-Date Stratification of Compositional LRR",
    "section": "6.4 Compute LRR by Mint Period and Hex",
    "text": "6.4 Compute LRR by Mint Period and Hex\n\n\nCode\n# Global Rome proportion\np_global &lt;- mean(hoard_hex$is_rome)\ncat(\"Global Rome proportion:\", round(p_global * 100, 2), \"%\\n\\n\")\n\n\nGlobal Rome proportion: 89.8 %\n\n\nCode\n# Aggregate by hex AND mint period\nhex_mint_comp &lt;- hoard_hex %&gt;%\n  st_drop_geometry() %&gt;%\n  group_by(hex_id, mint_period, mint_period_num) %&gt;%\n  summarise(\n    n_hoards = n_distinct(hoard_id),\n    total_types = n(),\n    rome_types = sum(is_rome),\n    non_rome_types = sum(!is_rome),\n    p_rome = rome_types / total_types,\n    .groups = \"drop\"\n  )\n\n# Period-specific globals\nmint_period_globals &lt;- hex_mint_comp %&gt;%\n  group_by(mint_period, mint_period_num) %&gt;%\n  summarise(\n    p_rome_period = sum(rome_types) / sum(total_types),\n    total_in_period = sum(total_types),\n    .groups = \"drop\"\n  )\n\nkable(mint_period_globals,\n      col.names = c(\"Mint Period\", \"Num\", \"Rome %\", \"Total Types\"),\n      digits = c(0, 0, 3, 0),\n      caption = \"Global Rome proportion by mint period\")\n\n\n\nGlobal Rome proportion by mint period\n\n\nMint Period\nNum\nRome %\nTotal Types\n\n\n\n\n1: Early Republic (pre-150 BCE)\n1\n0.843\n2046\n\n\n2: Late Republic I (150-100 BCE)\n2\n0.972\n11050\n\n\n3: Late Republic II (100-50 BCE)\n3\n0.931\n9090\n\n\n4: Triumviral/Augustan (50 BCE-14 CE)\n4\n0.574\n3120\n\n\n\n\n\nCode\n# Compute LRR\nepsilon &lt;- 0.5\n\nhex_mint_lrr &lt;- hex_mint_comp %&gt;%\n  left_join(mint_period_globals, by = c(\"mint_period\", \"mint_period_num\")) %&gt;%\n  mutate(\n    LRR_period = log((rome_types + epsilon) / (total_types + epsilon)) - log(p_rome_period),\n    LRR_global = log((rome_types + epsilon) / (total_types + epsilon)) - log(p_global),\n    LRR_contrast = ifelse(\n      non_rome_types &gt; 0,\n      log((rome_types + epsilon) / (non_rome_types + epsilon)),\n      NA_real_\n    )\n  )"
  },
  {
    "objectID": "lrr_mint_date.html#compare-tpq-vs-mint-period-rome-proportions",
    "href": "lrr_mint_date.html#compare-tpq-vs-mint-period-rome-proportions",
    "title": "Mint-Date Stratification of Compositional LRR",
    "section": "6.5 Compare TPQ vs Mint Period Rome Proportions",
    "text": "6.5 Compare TPQ vs Mint Period Rome Proportions\n\n\nCode\n# TPQ globals (from previous analysis logic)\nchrr_tpq &lt;- chrr_flagged %&gt;%\n  mutate(\n    tpq_year = readr::parse_number(as.character(hoard_tpq)),\n    tpq_period = cut(\n      tpq_year,\n      breaks = period_breaks,\n      labels = period_labels,\n      right = TRUE\n    )\n  ) %&gt;%\n  filter(!is.na(tpq_period), !is.na(hoard_lat), !is.na(hoard_long))\n\ntpq_globals &lt;- chrr_tpq %&gt;%\n  group_by(tpq_period) %&gt;%\n  summarise(\n    p_rome = sum(is_rome) / n(),\n    .groups = \"drop\"\n  ) %&gt;%\n  mutate(date_type = \"TPQ (deposition)\")\n\nmint_globals_compare &lt;- mint_period_globals %&gt;%\n  select(mint_period, p_rome_period) %&gt;%\n  rename(period = mint_period, p_rome = p_rome_period) %&gt;%\n  mutate(date_type = \"Mint Date (production)\")\n\ntpq_globals_compare &lt;- tpq_globals %&gt;%\n  rename(period = tpq_period)\n\ncompare_df &lt;- bind_rows(mint_globals_compare, tpq_globals_compare) %&gt;%\n  mutate(\n    period_num = as.integer(factor(period))\n  )\n\nggplot(compare_df, aes(x = period_num, y = p_rome, color = date_type, group = date_type)) +\n  geom_line(linewidth = 1.2) +\n  geom_point(size = 4) +\n  scale_color_manual(values = c(\"Mint Date (production)\" = \"steelblue\",\n                                 \"TPQ (deposition)\" = \"darkred\")) +\n  scale_y_continuous(labels = scales::percent_format(), limits = c(0.7, 1)) +\n  scale_x_continuous(\n    breaks = 1:5,\n    labels = c(\"Early\\nRepublic\", \"Late Rep I\\n150-100\", \"Late Rep II\\n100-50\",\n               \"Triumviral/\\nAugustan\", \"Early\\nImperial\")\n  ) +\n  labs(\n    title = \"Rome Proportion: Production vs. Deposition\",\n    subtitle = \"Mint-date shows earlier decline; TPQ shows later decline\",\n    x = \"Period\",\n    y = \"Rome proportion\",\n    color = NULL\n  ) +\n  theme(legend.position = \"bottom\")"
  },
  {
    "objectID": "lrr_mint_date.html#faceted-lrr-by-mint-period",
    "href": "lrr_mint_date.html#faceted-lrr-by-mint-period",
    "title": "Mint-Date Stratification of Compositional LRR",
    "section": "7.1 Faceted LRR by Mint Period",
    "text": "7.1 Faceted LRR by Mint Period\n\n\nCode\nhex_mint_sf &lt;- hex_land %&gt;%\n  inner_join(hex_mint_lrr, by = \"hex_id\") %&gt;%\n  st_transform(4326)\n\nland_wgs &lt;- st_transform(study_land_proj, 4326)\nrome_wgs &lt;- st_transform(rome_mint, 4326)\n\nggplot() +\n  geom_sf(data = land_wgs, fill = \"grey95\", color = \"grey80\") +\n  geom_sf(\n    data = hex_mint_sf,\n    aes(fill = LRR_period),\n    color = \"grey50\",\n    linewidth = 0.15\n  ) +\n  geom_sf(data = rome_wgs, color = \"black\", shape = 8, size = 3, stroke = 1) +\n  scale_fill_gradient2(\n    low = \"steelblue\",\n    mid = \"white\",\n    high = \"darkred\",\n    midpoint = 0,\n    name = \"LRR\",\n    limits = c(-0.6, 0.6),\n    oob = scales::squish\n  ) +\n  coord_sf(\n    xlim = c(hoard_bbox[\"xmin\"] - 1, hoard_bbox[\"xmax\"] + 1),\n    ylim = c(hoard_bbox[\"ymin\"] - 1, hoard_bbox[\"ymax\"] + 1)\n  ) +\n  facet_wrap(~mint_period, ncol = 3) +\n  labs(\n    title = \"Compositional LRR by Mint Period\",\n    subtitle = \"Where did coins minted in each period end up? | Red = above average, Blue = below\",\n    caption = \"LRR relative to period-specific global proportion\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text = element_blank(),\n    axis.title = element_blank(),\n    strip.text = element_text(size = 9, face = \"bold\"),\n    legend.position = \"right\"\n  )"
  },
  {
    "objectID": "lrr_mint_date.html#rome-proportion-by-mint-period",
    "href": "lrr_mint_date.html#rome-proportion-by-mint-period",
    "title": "Mint-Date Stratification of Compositional LRR",
    "section": "7.2 Rome Proportion by Mint Period",
    "text": "7.2 Rome Proportion by Mint Period\n\n\nCode\nggplot() +\n  geom_sf(data = land_wgs, fill = \"grey95\", color = \"grey80\") +\n  geom_sf(\n    data = hex_mint_sf,\n    aes(fill = p_rome),\n    color = \"grey50\",\n    linewidth = 0.15\n  ) +\n  geom_sf(data = rome_wgs, color = \"black\", shape = 8, size = 3, stroke = 1) +\n  scale_fill_viridis_c(\n    name = \"Rome %\",\n    labels = scales::percent_format(),\n    option = \"plasma\",\n    limits = c(0.5, 1),\n    oob = scales::squish\n  ) +\n  coord_sf(\n    xlim = c(hoard_bbox[\"xmin\"] - 1, hoard_bbox[\"xmax\"] + 1),\n    ylim = c(hoard_bbox[\"ymin\"] - 1, hoard_bbox[\"ymax\"] + 1)\n  ) +\n  facet_wrap(~mint_period, ncol = 3) +\n  labs(\n    title = \"Rome Mint Proportion by Mint Period\",\n    subtitle = \"Raw proportion of coin-types from Rome mint\",\n    caption = \"Star = Rome mint location\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text = element_blank(),\n    axis.title = element_blank(),\n    strip.text = element_text(size = 9, face = \"bold\"),\n    legend.position = \"right\"\n  )"
  },
  {
    "objectID": "lrr_mint_date.html#add-distance-and-fit-models",
    "href": "lrr_mint_date.html#add-distance-and-fit-models",
    "title": "Mint-Date Stratification of Compositional LRR",
    "section": "8.1 Add Distance and Fit Models",
    "text": "8.1 Add Distance and Fit Models\n\n\nCode\n# Hex centroid coordinates\nhex_centroids_wgs &lt;- hex_land %&gt;%\n  st_centroid() %&gt;%\n  st_transform(4326)\n\ncent_coords &lt;- st_coordinates(hex_centroids_wgs)\n\nhex_coords &lt;- tibble(\n  hex_id = hex_land$hex_id,\n  cent_lon = cent_coords[, 1],\n  cent_lat = cent_coords[, 2]\n)\n\nrome_coords &lt;- c(12.4964, 41.9028)\n\nhex_coords &lt;- hex_coords %&gt;%\n  mutate(\n    dist_rome_km = sqrt((cent_lon - rome_coords[1])^2 + (cent_lat - rome_coords[2])^2) * 111\n  )\n\nhex_mint_dist &lt;- hex_mint_lrr %&gt;%\n  left_join(hex_coords, by = \"hex_id\")\n\n# Fit binomial by mint period\nmint_distance_models &lt;- hex_mint_dist %&gt;%\n  filter(!is.na(dist_rome_km), !is.na(mint_period)) %&gt;%\n  group_by(mint_period, mint_period_num) %&gt;%\n  nest() %&gt;%\n  mutate(\n    model = map(data, ~tryCatch(\n      glm(\n        cbind(rome_types, non_rome_types) ~ dist_rome_km,\n        family = binomial(link = \"logit\"),\n        data = .x\n      ),\n      error = function(e) NULL\n    )),\n    tidy = map(model, ~if(!is.null(.x)) broom::tidy(.x) else NULL)\n  ) %&gt;%\n  filter(!map_lgl(tidy, is.null)) %&gt;%\n  unnest(tidy) %&gt;%\n  filter(term == \"dist_rome_km\") %&gt;%\n  select(mint_period, mint_period_num, estimate, std.error, p.value) %&gt;%\n  mutate(\n    or_100km = exp(estimate * 100),\n    sig = ifelse(p.value &lt; 0.05, \"*\", \"\")\n  )\n\nkable(mint_distance_models,\n      col.names = c(\"Mint Period\", \"Num\", \"Coefficient\", \"SE\", \"p-value\", \"OR/100km\", \"Sig\"),\n      digits = c(0, 0, 6, 6, 4, 4, 0),\n      caption = \"Distance effect by mint period (* = p &lt; 0.05)\")\n\n\n\nDistance effect by mint period (* = p &lt; 0.05)\n\n\n\n\n\n\n\n\n\n\n\nMint Period\nNum\nCoefficient\nSE\np-value\nOR/100km\nSig\n\n\n\n\n1: Early Republic (pre-150 BCE)\n1\n0.000203\n9.0e-05\n0.0235\n1.0205\n*\n\n\n2: Late Republic I (150-100 BCE)\n2\n0.000067\n8.2e-05\n0.4101\n1.0067\n\n\n\n3: Late Republic II (100-50 BCE)\n3\n-0.000031\n6.2e-05\n0.6219\n0.9969\n\n\n\n4: Triumviral/Augustan (50 BCE-14 CE)\n4\n-0.000217\n5.5e-05\n0.0001\n0.9785\n*"
  },
  {
    "objectID": "lrr_mint_date.html#compare-distance-effects-tpq-vs-mint-date",
    "href": "lrr_mint_date.html#compare-distance-effects-tpq-vs-mint-date",
    "title": "Mint-Date Stratification of Compositional LRR",
    "section": "8.2 Compare Distance Effects: TPQ vs Mint Date",
    "text": "8.2 Compare Distance Effects: TPQ vs Mint Date\n\n\nCode\n# Manually add TPQ results from previous analysis\ntpq_distance &lt;- tibble(\n  period_num = c(1, 2, 3, 4),\n  or_100km = c(1.0072, 1.0435, 1.0048, 0.9910),\n  date_type = \"TPQ (deposition)\",\n  sig = c(\"\", \"*\", \"\", \"*\")\n)\n\nmint_distance_compare &lt;- mint_distance_models %&gt;%\n  ungroup() %&gt;%\n  select(mint_period_num, or_100km, sig) %&gt;%\n  rename(period_num = mint_period_num) %&gt;%\n  mutate(date_type = \"Mint Date (production)\")\n\ncompare_distance &lt;- bind_rows(tpq_distance, mint_distance_compare)\n\nggplot(compare_distance, aes(x = period_num, y = or_100km, color = date_type, group = date_type)) +\n  geom_hline(yintercept = 1, linetype = \"dashed\", color = \"grey50\") +\n  geom_line(linewidth = 1.2) +\n  geom_point(aes(shape = sig != \"\"), size = 4) +\n  scale_color_manual(values = c(\"Mint Date (production)\" = \"steelblue\",\n                                 \"TPQ (deposition)\" = \"darkred\")) +\n  scale_shape_manual(values = c(\"FALSE\" = 1, \"TRUE\" = 16), guide = \"none\") +\n  scale_x_continuous(\n    breaks = 1:5,\n    labels = c(\"Early\\nRepublic\", \"Late Rep I\\n150-100\", \"Late Rep II\\n100-50\",\n               \"Triumviral/\\nAugustan\", \"Early\\nImperial\")\n  ) +\n  labs(\n    title = \"Distance Effect: Production vs. Deposition\",\n    subtitle = \"OR &gt; 1 = Rome increases with distance | OR &lt; 1 = Rome decreases with distance\\nFilled points = significant (p &lt; 0.05)\",\n    x = \"Period\",\n    y = \"Odds Ratio per 100 km\",\n    color = NULL\n  ) +\n  theme(legend.position = \"bottom\")"
  },
  {
    "objectID": "lrr_mint_date.html#distance-decay-plots-by-mint-period",
    "href": "lrr_mint_date.html#distance-decay-plots-by-mint-period",
    "title": "Mint-Date Stratification of Compositional LRR",
    "section": "8.3 Distance-Decay Plots by Mint Period",
    "text": "8.3 Distance-Decay Plots by Mint Period\n\n\nCode\n# Predicted curves\npred_curves_mint &lt;- hex_mint_dist %&gt;%\n  filter(!is.na(dist_rome_km), !is.na(mint_period)) %&gt;%\n  group_by(mint_period, mint_period_num) %&gt;%\n  nest() %&gt;%\n  mutate(\n    model = map(data, ~tryCatch(\n      glm(\n        cbind(rome_types, non_rome_types) ~ dist_rome_km,\n        family = binomial(link = \"logit\"),\n        data = .x\n      ),\n      error = function(e) NULL\n    )),\n    pred_data = map(data, ~tibble(\n      dist_rome_km = seq(0, max(.x$dist_rome_km, na.rm = TRUE), length.out = 100)\n    )),\n    predictions = map2(model, pred_data, ~{\n      if(!is.null(.x)) {\n        mutate(.y, p_rome_pred = predict(.x, newdata = .y, type = \"response\"))\n      } else {\n        mutate(.y, p_rome_pred = NA_real_)\n      }\n    })\n  ) %&gt;%\n  select(mint_period, mint_period_num, predictions) %&gt;%\n  unnest(predictions) %&gt;%\n  filter(!is.na(p_rome_pred))\n\nggplot() +\n  geom_point(\n    data = hex_mint_dist,\n    aes(x = dist_rome_km, y = p_rome, size = total_types),\n    alpha = 0.4,\n    color = \"steelblue\"\n  ) +\n  geom_line(\n    data = pred_curves_mint,\n    aes(x = dist_rome_km, y = p_rome_pred),\n    color = \"darkred\",\n    linewidth = 1\n  ) +\n  facet_wrap(~mint_period, ncol = 3) +\n  scale_y_continuous(labels = scales::percent_format(), limits = c(0.3, 1)) +\n  scale_size_continuous(name = \"Sample size\", range = c(1, 8)) +\n  labs(\n    title = \"Rome Proportion vs. Distance by Mint Period\",\n    subtitle = \"Red line = binomial regression fit\",\n    x = \"Distance from Rome (km)\",\n    y = \"Rome proportion\"\n  ) +\n  theme(\n    legend.position = \"bottom\",\n    strip.text = element_text(size = 9, face = \"bold\")\n  )"
  },
  {
    "objectID": "lrr_mint_date.html#side-by-side-comparison-table",
    "href": "lrr_mint_date.html#side-by-side-comparison-table",
    "title": "Mint-Date Stratification of Compositional LRR",
    "section": "9.1 Side-by-Side Comparison Table",
    "text": "9.1 Side-by-Side Comparison Table\n\n\nCode\n# Create comprehensive comparison\nsummary_mint &lt;- mint_period_globals %&gt;%\n  select(mint_period, mint_period_num, p_rome_period, total_in_period) %&gt;%\n  rename(\n    period = mint_period,\n    period_num = mint_period_num,\n    p_rome = p_rome_period,\n    n_obs = total_in_period\n  ) %&gt;%\n  left_join(\n    mint_distance_models %&gt;% \n      ungroup() %&gt;% \n      select(mint_period_num, or_100km, sig) %&gt;%\n      rename(period_num = mint_period_num),\n    by = \"period_num\"\n  ) %&gt;%\n  mutate(date_type = \"Mint Date\")\n\n# Note: TPQ comparison would require running that analysis\n# For now, show mint-date summary\n\nkable(summary_mint %&gt;% select(-date_type),\n      col.names = c(\"Period\", \"Num\", \"Rome %\", \"N\", \"OR/100km\", \"Sig\"),\n      digits = c(0, 0, 3, 0, 4, 0),\n      caption = \"Summary: Rome penetration by mint period\")\n\n\n\nSummary: Rome penetration by mint period\n\n\n\n\n\n\n\n\n\n\nPeriod\nNum\nRome %\nN\nOR/100km\nSig\n\n\n\n\n1: Early Republic (pre-150 BCE)\n1\n0.843\n2046\n1.0205\n*\n\n\n2: Late Republic I (150-100 BCE)\n2\n0.972\n11050\n1.0067\n\n\n\n3: Late Republic II (100-50 BCE)\n3\n0.931\n9090\n0.9969\n\n\n\n4: Triumviral/Augustan (50 BCE-14 CE)\n4\n0.574\n3120\n0.9785\n*"
  },
  {
    "objectID": "lrr_mint_date.html#key-insights-for-hmm",
    "href": "lrr_mint_date.html#key-insights-for-hmm",
    "title": "Mint-Date Stratification of Compositional LRR",
    "section": "9.2 Key Insights for HMM",
    "text": "9.2 Key Insights for HMM\n\n\nCode\ncat(\"\n=======================================================\nKEY INSIGHTS FROM MINT-DATE STRATIFICATION\n=======================================================\n\n1. PRODUCTION vs DEPOSITION TIMING\n   - Mint-date distribution peaks earlier than TPQ\n   - Median circulation lag suggests coins traveled ~50+ years before burial\n   - Early Republic coins have longest circulation times\n\n2. ROME PROPORTION TRENDS\n   - Mint-date: Decline begins in Late Republic II (100-50 BCE)\n   - TPQ: Decline appears in Triumviral/Augustan period\n   - The lag suggests ~50-year delay between production and deposition patterns\n\n3. DISTANCE EFFECTS\n   - Early periods: Variable, often non-significant\n   - Later periods: More consistent distance-decay emerges\n   - Sign reversals less pronounced than in TPQ analysis\n\n4. IMPLICATIONS FOR HMM\n   - Regimes detected via TPQ reflect HOARDING BEHAVIOR\n   - Regimes detected via mint-date reflect PRODUCTION/DISTRIBUTION\n   - These may represent different aspects of monetary system state\n   - Consider: HMM on TPQ for crisis detection, mint-date for validation\n\n5. SPATIAL PATTERNS\n   - Early coins found broadly (long circulation = wide distribution)\n   - Later coins show tighter geographic clustering\n   - Consistent with monetary system maturation\n=======================================================\n\")\n\n\n\n=======================================================\nKEY INSIGHTS FROM MINT-DATE STRATIFICATION\n=======================================================\n\n1. PRODUCTION vs DEPOSITION TIMING\n   - Mint-date distribution peaks earlier than TPQ\n   - Median circulation lag suggests coins traveled ~50+ years before burial\n   - Early Republic coins have longest circulation times\n\n2. ROME PROPORTION TRENDS\n   - Mint-date: Decline begins in Late Republic II (100-50 BCE)\n   - TPQ: Decline appears in Triumviral/Augustan period\n   - The lag suggests ~50-year delay between production and deposition patterns\n\n3. DISTANCE EFFECTS\n   - Early periods: Variable, often non-significant\n   - Later periods: More consistent distance-decay emerges\n   - Sign reversals less pronounced than in TPQ analysis\n\n4. IMPLICATIONS FOR HMM\n   - Regimes detected via TPQ reflect HOARDING BEHAVIOR\n   - Regimes detected via mint-date reflect PRODUCTION/DISTRIBUTION\n   - These may represent different aspects of monetary system state\n   - Consider: HMM on TPQ for crisis detection, mint-date for validation\n\n5. SPATIAL PATTERNS\n   - Early coins found broadly (long circulation = wide distribution)\n   - Later coins show tighter geographic clustering\n   - Consistent with monetary system maturation\n======================================================="
  }
]